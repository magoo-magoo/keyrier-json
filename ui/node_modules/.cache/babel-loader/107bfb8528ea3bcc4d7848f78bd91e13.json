{"ast":null,"code":"ace.define(\"ace/mode/xml_highlight_rules\", [\"require\", \"exports\", \"module\", \"ace/lib/oop\", \"ace/mode/text_highlight_rules\"], function (require, exports, module) {\n  \"use strict\";\n\n  var oop = require(\"../lib/oop\");\n\n  var TextHighlightRules = require(\"./text_highlight_rules\").TextHighlightRules;\n\n  var XmlHighlightRules = function (normalize) {\n    var tagRegex = \"[_:a-zA-Z\\xc0-\\uffff][-_:.a-zA-Z0-9\\xc0-\\uffff]*\";\n    this.$rules = {\n      start: [{\n        token: \"string.cdata.xml\",\n        regex: \"<\\\\!\\\\[CDATA\\\\[\",\n        next: \"cdata\"\n      }, {\n        token: [\"punctuation.instruction.xml\", \"keyword.instruction.xml\"],\n        regex: \"(<\\\\?)(\" + tagRegex + \")\",\n        next: \"processing_instruction\"\n      }, {\n        token: \"comment.start.xml\",\n        regex: \"<\\\\!--\",\n        next: \"comment\"\n      }, {\n        token: [\"xml-pe.doctype.xml\", \"xml-pe.doctype.xml\"],\n        regex: \"(<\\\\!)(DOCTYPE)(?=[\\\\s])\",\n        next: \"doctype\",\n        caseInsensitive: true\n      }, {\n        include: \"tag\"\n      }, {\n        token: \"text.end-tag-open.xml\",\n        regex: \"</\"\n      }, {\n        token: \"text.tag-open.xml\",\n        regex: \"<\"\n      }, {\n        include: \"reference\"\n      }, {\n        defaultToken: \"text.xml\"\n      }],\n      processing_instruction: [{\n        token: \"entity.other.attribute-name.decl-attribute-name.xml\",\n        regex: tagRegex\n      }, {\n        token: \"keyword.operator.decl-attribute-equals.xml\",\n        regex: \"=\"\n      }, {\n        include: \"whitespace\"\n      }, {\n        include: \"string\"\n      }, {\n        token: \"punctuation.xml-decl.xml\",\n        regex: \"\\\\?>\",\n        next: \"start\"\n      }],\n      doctype: [{\n        include: \"whitespace\"\n      }, {\n        include: \"string\"\n      }, {\n        token: \"xml-pe.doctype.xml\",\n        regex: \">\",\n        next: \"start\"\n      }, {\n        token: \"xml-pe.xml\",\n        regex: \"[-_a-zA-Z0-9:]+\"\n      }, {\n        token: \"punctuation.int-subset\",\n        regex: \"\\\\[\",\n        push: \"int_subset\"\n      }],\n      int_subset: [{\n        token: \"text.xml\",\n        regex: \"\\\\s+\"\n      }, {\n        token: \"punctuation.int-subset.xml\",\n        regex: \"]\",\n        next: \"pop\"\n      }, {\n        token: [\"punctuation.markup-decl.xml\", \"keyword.markup-decl.xml\"],\n        regex: \"(<\\\\!)(\" + tagRegex + \")\",\n        push: [{\n          token: \"text\",\n          regex: \"\\\\s+\"\n        }, {\n          token: \"punctuation.markup-decl.xml\",\n          regex: \">\",\n          next: \"pop\"\n        }, {\n          include: \"string\"\n        }]\n      }],\n      cdata: [{\n        token: \"string.cdata.xml\",\n        regex: \"\\\\]\\\\]>\",\n        next: \"start\"\n      }, {\n        token: \"text.xml\",\n        regex: \"\\\\s+\"\n      }, {\n        token: \"text.xml\",\n        regex: \"(?:[^\\\\]]|\\\\](?!\\\\]>))+\"\n      }],\n      comment: [{\n        token: \"comment.end.xml\",\n        regex: \"-->\",\n        next: \"start\"\n      }, {\n        defaultToken: \"comment.xml\"\n      }],\n      reference: [{\n        token: \"constant.language.escape.reference.xml\",\n        regex: \"(?:&#[0-9]+;)|(?:&#x[0-9a-fA-F]+;)|(?:&[a-zA-Z0-9_:\\\\.-]+;)\"\n      }],\n      attr_reference: [{\n        token: \"constant.language.escape.reference.attribute-value.xml\",\n        regex: \"(?:&#[0-9]+;)|(?:&#x[0-9a-fA-F]+;)|(?:&[a-zA-Z0-9_:\\\\.-]+;)\"\n      }],\n      tag: [{\n        token: [\"meta.tag.punctuation.tag-open.xml\", \"meta.tag.punctuation.end-tag-open.xml\", \"meta.tag.tag-name.xml\"],\n        regex: \"(?:(<)|(</))((?:\" + tagRegex + \":)?\" + tagRegex + \")\",\n        next: [{\n          include: \"attributes\"\n        }, {\n          token: \"meta.tag.punctuation.tag-close.xml\",\n          regex: \"/?>\",\n          next: \"start\"\n        }]\n      }],\n      tag_whitespace: [{\n        token: \"text.tag-whitespace.xml\",\n        regex: \"\\\\s+\"\n      }],\n      whitespace: [{\n        token: \"text.whitespace.xml\",\n        regex: \"\\\\s+\"\n      }],\n      string: [{\n        token: \"string.xml\",\n        regex: \"'\",\n        push: [{\n          token: \"string.xml\",\n          regex: \"'\",\n          next: \"pop\"\n        }, {\n          defaultToken: \"string.xml\"\n        }]\n      }, {\n        token: \"string.xml\",\n        regex: '\"',\n        push: [{\n          token: \"string.xml\",\n          regex: '\"',\n          next: \"pop\"\n        }, {\n          defaultToken: \"string.xml\"\n        }]\n      }],\n      attributes: [{\n        token: \"entity.other.attribute-name.xml\",\n        regex: tagRegex\n      }, {\n        token: \"keyword.operator.attribute-equals.xml\",\n        regex: \"=\"\n      }, {\n        include: \"tag_whitespace\"\n      }, {\n        include: \"attribute_value\"\n      }],\n      attribute_value: [{\n        token: \"string.attribute-value.xml\",\n        regex: \"'\",\n        push: [{\n          token: \"string.attribute-value.xml\",\n          regex: \"'\",\n          next: \"pop\"\n        }, {\n          include: \"attr_reference\"\n        }, {\n          defaultToken: \"string.attribute-value.xml\"\n        }]\n      }, {\n        token: \"string.attribute-value.xml\",\n        regex: '\"',\n        push: [{\n          token: \"string.attribute-value.xml\",\n          regex: '\"',\n          next: \"pop\"\n        }, {\n          include: \"attr_reference\"\n        }, {\n          defaultToken: \"string.attribute-value.xml\"\n        }]\n      }]\n    };\n    if (this.constructor === XmlHighlightRules) this.normalizeRules();\n  };\n\n  (function () {\n    this.embedTagRules = function (HighlightRules, prefix, tag) {\n      this.$rules.tag.unshift({\n        token: [\"meta.tag.punctuation.tag-open.xml\", \"meta.tag.\" + tag + \".tag-name.xml\"],\n        regex: \"(<)(\" + tag + \"(?=\\\\s|>|$))\",\n        next: [{\n          include: \"attributes\"\n        }, {\n          token: \"meta.tag.punctuation.tag-close.xml\",\n          regex: \"/?>\",\n          next: prefix + \"start\"\n        }]\n      });\n      this.$rules[tag + \"-end\"] = [{\n        include: \"attributes\"\n      }, {\n        token: \"meta.tag.punctuation.tag-close.xml\",\n        regex: \"/?>\",\n        next: \"start\",\n        onMatch: function (value, currentState, stack) {\n          stack.splice(0);\n          return this.token;\n        }\n      }];\n      this.embedRules(HighlightRules, prefix, [{\n        token: [\"meta.tag.punctuation.end-tag-open.xml\", \"meta.tag.\" + tag + \".tag-name.xml\"],\n        regex: \"(</)(\" + tag + \"(?=\\\\s|>|$))\",\n        next: tag + \"-end\"\n      }, {\n        token: \"string.cdata.xml\",\n        regex: \"<\\\\!\\\\[CDATA\\\\[\"\n      }, {\n        token: \"string.cdata.xml\",\n        regex: \"\\\\]\\\\]>\"\n      }]);\n    };\n  }).call(TextHighlightRules.prototype);\n  oop.inherits(XmlHighlightRules, TextHighlightRules);\n  exports.XmlHighlightRules = XmlHighlightRules;\n});\nace.define(\"ace/mode/behaviour/xml\", [\"require\", \"exports\", \"module\", \"ace/lib/oop\", \"ace/mode/behaviour\", \"ace/token_iterator\", \"ace/lib/lang\"], function (require, exports, module) {\n  \"use strict\";\n\n  var oop = require(\"../../lib/oop\");\n\n  var Behaviour = require(\"../behaviour\").Behaviour;\n\n  var TokenIterator = require(\"../../token_iterator\").TokenIterator;\n\n  var lang = require(\"../../lib/lang\");\n\n  function is(token, type) {\n    return token && token.type.lastIndexOf(type + \".xml\") > -1;\n  }\n\n  var XmlBehaviour = function () {\n    this.add(\"string_dquotes\", \"insertion\", function (state, action, editor, session, text) {\n      if (text == '\"' || text == \"'\") {\n        var quote = text;\n        var selected = session.doc.getTextRange(editor.getSelectionRange());\n\n        if (selected !== \"\" && selected !== \"'\" && selected != '\"' && editor.getWrapBehavioursEnabled()) {\n          return {\n            text: quote + selected + quote,\n            selection: false\n          };\n        }\n\n        var cursor = editor.getCursorPosition();\n        var line = session.doc.getLine(cursor.row);\n        var rightChar = line.substring(cursor.column, cursor.column + 1);\n        var iterator = new TokenIterator(session, cursor.row, cursor.column);\n        var token = iterator.getCurrentToken();\n\n        if (rightChar == quote && (is(token, \"attribute-value\") || is(token, \"string\"))) {\n          return {\n            text: \"\",\n            selection: [1, 1]\n          };\n        }\n\n        if (!token) token = iterator.stepBackward();\n        if (!token) return;\n\n        while (is(token, \"tag-whitespace\") || is(token, \"whitespace\")) {\n          token = iterator.stepBackward();\n        }\n\n        var rightSpace = !rightChar || rightChar.match(/\\s/);\n\n        if (is(token, \"attribute-equals\") && (rightSpace || rightChar == '>') || is(token, \"decl-attribute-equals\") && (rightSpace || rightChar == '?')) {\n          return {\n            text: quote + quote,\n            selection: [1, 1]\n          };\n        }\n      }\n    });\n    this.add(\"string_dquotes\", \"deletion\", function (state, action, editor, session, range) {\n      var selected = session.doc.getTextRange(range);\n\n      if (!range.isMultiLine() && (selected == '\"' || selected == \"'\")) {\n        var line = session.doc.getLine(range.start.row);\n        var rightChar = line.substring(range.start.column + 1, range.start.column + 2);\n\n        if (rightChar == selected) {\n          range.end.column++;\n          return range;\n        }\n      }\n    });\n    this.add(\"autoclosing\", \"insertion\", function (state, action, editor, session, text) {\n      if (text == '>') {\n        var position = editor.getSelectionRange().start;\n        var iterator = new TokenIterator(session, position.row, position.column);\n        var token = iterator.getCurrentToken() || iterator.stepBackward();\n        if (!token || !(is(token, \"tag-name\") || is(token, \"tag-whitespace\") || is(token, \"attribute-name\") || is(token, \"attribute-equals\") || is(token, \"attribute-value\"))) return;\n        if (is(token, \"reference.attribute-value\")) return;\n\n        if (is(token, \"attribute-value\")) {\n          var tokenEndColumn = iterator.getCurrentTokenColumn() + token.value.length;\n          if (position.column < tokenEndColumn) return;\n\n          if (position.column == tokenEndColumn) {\n            var nextToken = iterator.stepForward();\n            if (nextToken && is(nextToken, \"attribute-value\")) return;\n            iterator.stepBackward();\n          }\n        }\n\n        if (/^\\s*>/.test(session.getLine(position.row).slice(position.column))) return;\n\n        while (!is(token, \"tag-name\")) {\n          token = iterator.stepBackward();\n\n          if (token.value == \"<\") {\n            token = iterator.stepForward();\n            break;\n          }\n        }\n\n        var tokenRow = iterator.getCurrentTokenRow();\n        var tokenColumn = iterator.getCurrentTokenColumn();\n        if (is(iterator.stepBackward(), \"end-tag-open\")) return;\n        var element = token.value;\n        if (tokenRow == position.row) element = element.substring(0, position.column - tokenColumn);\n        if (this.voidElements.hasOwnProperty(element.toLowerCase())) return;\n        return {\n          text: \">\" + \"</\" + element + \">\",\n          selection: [1, 1]\n        };\n      }\n    });\n    this.add(\"autoindent\", \"insertion\", function (state, action, editor, session, text) {\n      if (text == \"\\n\") {\n        var cursor = editor.getCursorPosition();\n        var line = session.getLine(cursor.row);\n        var iterator = new TokenIterator(session, cursor.row, cursor.column);\n        var token = iterator.getCurrentToken();\n\n        if (token && token.type.indexOf(\"tag-close\") !== -1) {\n          if (token.value == \"/>\") return;\n\n          while (token && token.type.indexOf(\"tag-name\") === -1) {\n            token = iterator.stepBackward();\n          }\n\n          if (!token) {\n            return;\n          }\n\n          var tag = token.value;\n          var row = iterator.getCurrentTokenRow();\n          token = iterator.stepBackward();\n\n          if (!token || token.type.indexOf(\"end-tag\") !== -1) {\n            return;\n          }\n\n          if (this.voidElements && !this.voidElements[tag]) {\n            var nextToken = session.getTokenAt(cursor.row, cursor.column + 1);\n            var line = session.getLine(row);\n            var nextIndent = this.$getIndent(line);\n            var indent = nextIndent + session.getTabString();\n\n            if (nextToken && nextToken.value === \"</\") {\n              return {\n                text: \"\\n\" + indent + \"\\n\" + nextIndent,\n                selection: [1, indent.length, 1, indent.length]\n              };\n            } else {\n              return {\n                text: \"\\n\" + indent\n              };\n            }\n          }\n        }\n      }\n    });\n  };\n\n  oop.inherits(XmlBehaviour, Behaviour);\n  exports.XmlBehaviour = XmlBehaviour;\n});\nace.define(\"ace/mode/folding/xml\", [\"require\", \"exports\", \"module\", \"ace/lib/oop\", \"ace/lib/lang\", \"ace/range\", \"ace/mode/folding/fold_mode\", \"ace/token_iterator\"], function (require, exports, module) {\n  \"use strict\";\n\n  var oop = require(\"../../lib/oop\");\n\n  var lang = require(\"../../lib/lang\");\n\n  var Range = require(\"../../range\").Range;\n\n  var BaseFoldMode = require(\"./fold_mode\").FoldMode;\n\n  var TokenIterator = require(\"../../token_iterator\").TokenIterator;\n\n  var FoldMode = exports.FoldMode = function (voidElements, optionalEndTags) {\n    BaseFoldMode.call(this);\n    this.voidElements = voidElements || {};\n    this.optionalEndTags = oop.mixin({}, this.voidElements);\n    if (optionalEndTags) oop.mixin(this.optionalEndTags, optionalEndTags);\n  };\n\n  oop.inherits(FoldMode, BaseFoldMode);\n\n  var Tag = function () {\n    this.tagName = \"\";\n    this.closing = false;\n    this.selfClosing = false;\n    this.start = {\n      row: 0,\n      column: 0\n    };\n    this.end = {\n      row: 0,\n      column: 0\n    };\n  };\n\n  function is(token, type) {\n    return token.type.lastIndexOf(type + \".xml\") > -1;\n  }\n\n  (function () {\n    this.getFoldWidget = function (session, foldStyle, row) {\n      var tag = this._getFirstTagInLine(session, row);\n\n      if (!tag) return this.getCommentFoldWidget(session, row);\n      if (tag.closing || !tag.tagName && tag.selfClosing) return foldStyle == \"markbeginend\" ? \"end\" : \"\";\n      if (!tag.tagName || tag.selfClosing || this.voidElements.hasOwnProperty(tag.tagName.toLowerCase())) return \"\";\n      if (this._findEndTagInLine(session, row, tag.tagName, tag.end.column)) return \"\";\n      return \"start\";\n    };\n\n    this.getCommentFoldWidget = function (session, row) {\n      if (/comment/.test(session.getState(row)) && /<!-/.test(session.getLine(row))) return \"start\";\n      return \"\";\n    };\n\n    this._getFirstTagInLine = function (session, row) {\n      var tokens = session.getTokens(row);\n      var tag = new Tag();\n\n      for (var i = 0; i < tokens.length; i++) {\n        var token = tokens[i];\n\n        if (is(token, \"tag-open\")) {\n          tag.end.column = tag.start.column + token.value.length;\n          tag.closing = is(token, \"end-tag-open\");\n          token = tokens[++i];\n          if (!token) return null;\n          tag.tagName = token.value;\n          tag.end.column += token.value.length;\n\n          for (i++; i < tokens.length; i++) {\n            token = tokens[i];\n            tag.end.column += token.value.length;\n\n            if (is(token, \"tag-close\")) {\n              tag.selfClosing = token.value == '/>';\n              break;\n            }\n          }\n\n          return tag;\n        } else if (is(token, \"tag-close\")) {\n          tag.selfClosing = token.value == '/>';\n          return tag;\n        }\n\n        tag.start.column += token.value.length;\n      }\n\n      return null;\n    };\n\n    this._findEndTagInLine = function (session, row, tagName, startColumn) {\n      var tokens = session.getTokens(row);\n      var column = 0;\n\n      for (var i = 0; i < tokens.length; i++) {\n        var token = tokens[i];\n        column += token.value.length;\n        if (column < startColumn) continue;\n\n        if (is(token, \"end-tag-open\")) {\n          token = tokens[i + 1];\n          if (token && token.value == tagName) return true;\n        }\n      }\n\n      return false;\n    };\n\n    this._readTagForward = function (iterator) {\n      var token = iterator.getCurrentToken();\n      if (!token) return null;\n      var tag = new Tag();\n\n      do {\n        if (is(token, \"tag-open\")) {\n          tag.closing = is(token, \"end-tag-open\");\n          tag.start.row = iterator.getCurrentTokenRow();\n          tag.start.column = iterator.getCurrentTokenColumn();\n        } else if (is(token, \"tag-name\")) {\n          tag.tagName = token.value;\n        } else if (is(token, \"tag-close\")) {\n          tag.selfClosing = token.value == \"/>\";\n          tag.end.row = iterator.getCurrentTokenRow();\n          tag.end.column = iterator.getCurrentTokenColumn() + token.value.length;\n          iterator.stepForward();\n          return tag;\n        }\n      } while (token = iterator.stepForward());\n\n      return null;\n    };\n\n    this._readTagBackward = function (iterator) {\n      var token = iterator.getCurrentToken();\n      if (!token) return null;\n      var tag = new Tag();\n\n      do {\n        if (is(token, \"tag-open\")) {\n          tag.closing = is(token, \"end-tag-open\");\n          tag.start.row = iterator.getCurrentTokenRow();\n          tag.start.column = iterator.getCurrentTokenColumn();\n          iterator.stepBackward();\n          return tag;\n        } else if (is(token, \"tag-name\")) {\n          tag.tagName = token.value;\n        } else if (is(token, \"tag-close\")) {\n          tag.selfClosing = token.value == \"/>\";\n          tag.end.row = iterator.getCurrentTokenRow();\n          tag.end.column = iterator.getCurrentTokenColumn() + token.value.length;\n        }\n      } while (token = iterator.stepBackward());\n\n      return null;\n    };\n\n    this._pop = function (stack, tag) {\n      while (stack.length) {\n        var top = stack[stack.length - 1];\n\n        if (!tag || top.tagName == tag.tagName) {\n          return stack.pop();\n        } else if (this.optionalEndTags.hasOwnProperty(top.tagName)) {\n          stack.pop();\n          continue;\n        } else {\n          return null;\n        }\n      }\n    };\n\n    this.getFoldWidgetRange = function (session, foldStyle, row) {\n      var firstTag = this._getFirstTagInLine(session, row);\n\n      if (!firstTag) {\n        return this.getCommentFoldWidget(session, row) && session.getCommentFoldRange(row, session.getLine(row).length);\n      }\n\n      var isBackward = firstTag.closing || firstTag.selfClosing;\n      var stack = [];\n      var tag;\n\n      if (!isBackward) {\n        var iterator = new TokenIterator(session, row, firstTag.start.column);\n        var start = {\n          row: row,\n          column: firstTag.start.column + firstTag.tagName.length + 2\n        };\n        if (firstTag.start.row == firstTag.end.row) start.column = firstTag.end.column;\n\n        while (tag = this._readTagForward(iterator)) {\n          if (tag.selfClosing) {\n            if (!stack.length) {\n              tag.start.column += tag.tagName.length + 2;\n              tag.end.column -= 2;\n              return Range.fromPoints(tag.start, tag.end);\n            } else continue;\n          }\n\n          if (tag.closing) {\n            this._pop(stack, tag);\n\n            if (stack.length == 0) return Range.fromPoints(start, tag.start);\n          } else {\n            stack.push(tag);\n          }\n        }\n      } else {\n        var iterator = new TokenIterator(session, row, firstTag.end.column);\n        var end = {\n          row: row,\n          column: firstTag.start.column\n        };\n\n        while (tag = this._readTagBackward(iterator)) {\n          if (tag.selfClosing) {\n            if (!stack.length) {\n              tag.start.column += tag.tagName.length + 2;\n              tag.end.column -= 2;\n              return Range.fromPoints(tag.start, tag.end);\n            } else continue;\n          }\n\n          if (!tag.closing) {\n            this._pop(stack, tag);\n\n            if (stack.length == 0) {\n              tag.start.column += tag.tagName.length + 2;\n              if (tag.start.row == tag.end.row && tag.start.column < tag.end.column) tag.start.column = tag.end.column;\n              return Range.fromPoints(tag.start, end);\n            }\n          } else {\n            stack.push(tag);\n          }\n        }\n      }\n    };\n  }).call(FoldMode.prototype);\n});\nace.define(\"ace/mode/xml\", [\"require\", \"exports\", \"module\", \"ace/lib/oop\", \"ace/lib/lang\", \"ace/mode/text\", \"ace/mode/xml_highlight_rules\", \"ace/mode/behaviour/xml\", \"ace/mode/folding/xml\", \"ace/worker/worker_client\"], function (require, exports, module) {\n  \"use strict\";\n\n  var oop = require(\"../lib/oop\");\n\n  var lang = require(\"../lib/lang\");\n\n  var TextMode = require(\"./text\").Mode;\n\n  var XmlHighlightRules = require(\"./xml_highlight_rules\").XmlHighlightRules;\n\n  var XmlBehaviour = require(\"./behaviour/xml\").XmlBehaviour;\n\n  var XmlFoldMode = require(\"./folding/xml\").FoldMode;\n\n  var WorkerClient = require(\"../worker/worker_client\").WorkerClient;\n\n  var Mode = function () {\n    this.HighlightRules = XmlHighlightRules;\n    this.$behaviour = new XmlBehaviour();\n    this.foldingRules = new XmlFoldMode();\n  };\n\n  oop.inherits(Mode, TextMode);\n  (function () {\n    this.voidElements = lang.arrayToMap([]);\n    this.blockComment = {\n      start: \"<!--\",\n      end: \"-->\"\n    };\n\n    this.createWorker = function (session) {\n      var worker = new WorkerClient([\"ace\"], \"ace/mode/xml_worker\", \"Worker\");\n      worker.attachToDocument(session.getDocument());\n      worker.on(\"error\", function (e) {\n        session.setAnnotations(e.data);\n      });\n      worker.on(\"terminate\", function () {\n        session.clearAnnotations();\n      });\n      return worker;\n    };\n\n    this.$id = \"ace/mode/xml\";\n  }).call(Mode.prototype);\n  exports.Mode = Mode;\n});\n\n(function () {\n  ace.require([\"ace/mode/xml\"], function (m) {\n    if (typeof module == \"object\" && typeof exports == \"object\" && module) {\n      module.exports = m;\n    }\n  });\n})();","map":{"version":3,"sources":["/home/magoo/projects/keyrier-json/node_modules/ace-builds/src-noconflict/mode-xml.js"],"names":["ace","define","require","exports","module","oop","TextHighlightRules","XmlHighlightRules","normalize","tagRegex","$rules","start","token","regex","next","caseInsensitive","include","defaultToken","processing_instruction","doctype","push","int_subset","cdata","comment","reference","attr_reference","tag","tag_whitespace","whitespace","string","attributes","attribute_value","constructor","normalizeRules","embedTagRules","HighlightRules","prefix","unshift","onMatch","value","currentState","stack","splice","embedRules","call","prototype","inherits","Behaviour","TokenIterator","lang","is","type","lastIndexOf","XmlBehaviour","add","state","action","editor","session","text","quote","selected","doc","getTextRange","getSelectionRange","getWrapBehavioursEnabled","selection","cursor","getCursorPosition","line","getLine","row","rightChar","substring","column","iterator","getCurrentToken","stepBackward","rightSpace","match","range","isMultiLine","end","position","tokenEndColumn","getCurrentTokenColumn","length","nextToken","stepForward","test","slice","tokenRow","getCurrentTokenRow","tokenColumn","element","voidElements","hasOwnProperty","toLowerCase","indexOf","getTokenAt","nextIndent","$getIndent","indent","getTabString","Range","BaseFoldMode","FoldMode","optionalEndTags","mixin","Tag","tagName","closing","selfClosing","getFoldWidget","foldStyle","_getFirstTagInLine","getCommentFoldWidget","_findEndTagInLine","getState","tokens","getTokens","i","startColumn","_readTagForward","_readTagBackward","_pop","top","pop","getFoldWidgetRange","firstTag","getCommentFoldRange","isBackward","fromPoints","TextMode","Mode","XmlFoldMode","WorkerClient","$behaviour","foldingRules","arrayToMap","blockComment","createWorker","worker","attachToDocument","getDocument","on","e","setAnnotations","data","clearAnnotations","$id","m"],"mappings":"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","sourcesContent":["ace.define(\"ace/mode/xml_highlight_rules\",[\"require\",\"exports\",\"module\",\"ace/lib/oop\",\"ace/mode/text_highlight_rules\"], function(require, exports, module) {\n\"use strict\";\n\nvar oop = require(\"../lib/oop\");\nvar TextHighlightRules = require(\"./text_highlight_rules\").TextHighlightRules;\n\nvar XmlHighlightRules = function(normalize) {\n    var tagRegex = \"[_:a-zA-Z\\xc0-\\uffff][-_:.a-zA-Z0-9\\xc0-\\uffff]*\";\n\n    this.$rules = {\n        start : [\n            {token : \"string.cdata.xml\", regex : \"<\\\\!\\\\[CDATA\\\\[\", next : \"cdata\"},\n            {\n                token : [\"punctuation.instruction.xml\", \"keyword.instruction.xml\"],\n                regex : \"(<\\\\?)(\" + tagRegex + \")\", next : \"processing_instruction\"\n            },\n            {token : \"comment.start.xml\", regex : \"<\\\\!--\", next : \"comment\"},\n            {\n                token : [\"xml-pe.doctype.xml\", \"xml-pe.doctype.xml\"],\n                regex : \"(<\\\\!)(DOCTYPE)(?=[\\\\s])\", next : \"doctype\", caseInsensitive: true\n            },\n            {include : \"tag\"},\n            {token : \"text.end-tag-open.xml\", regex: \"</\"},\n            {token : \"text.tag-open.xml\", regex: \"<\"},\n            {include : \"reference\"},\n            {defaultToken : \"text.xml\"}\n        ],\n\n        processing_instruction : [{\n            token : \"entity.other.attribute-name.decl-attribute-name.xml\",\n            regex : tagRegex\n        }, {\n            token : \"keyword.operator.decl-attribute-equals.xml\",\n            regex : \"=\"\n        }, {\n            include: \"whitespace\"\n        }, {\n            include: \"string\"\n        }, {\n            token : \"punctuation.xml-decl.xml\",\n            regex : \"\\\\?>\",\n            next : \"start\"\n        }],\n\n        doctype : [\n            {include : \"whitespace\"},\n            {include : \"string\"},\n            {token : \"xml-pe.doctype.xml\", regex : \">\", next : \"start\"},\n            {token : \"xml-pe.xml\", regex : \"[-_a-zA-Z0-9:]+\"},\n            {token : \"punctuation.int-subset\", regex : \"\\\\[\", push : \"int_subset\"}\n        ],\n\n        int_subset : [{\n            token : \"text.xml\",\n            regex : \"\\\\s+\"\n        }, {\n            token: \"punctuation.int-subset.xml\",\n            regex: \"]\",\n            next: \"pop\"\n        }, {\n            token : [\"punctuation.markup-decl.xml\", \"keyword.markup-decl.xml\"],\n            regex : \"(<\\\\!)(\" + tagRegex + \")\",\n            push : [{\n                token : \"text\",\n                regex : \"\\\\s+\"\n            },\n            {\n                token : \"punctuation.markup-decl.xml\",\n                regex : \">\",\n                next : \"pop\"\n            },\n            {include : \"string\"}]\n        }],\n\n        cdata : [\n            {token : \"string.cdata.xml\", regex : \"\\\\]\\\\]>\", next : \"start\"},\n            {token : \"text.xml\", regex : \"\\\\s+\"},\n            {token : \"text.xml\", regex : \"(?:[^\\\\]]|\\\\](?!\\\\]>))+\"}\n        ],\n\n        comment : [\n            {token : \"comment.end.xml\", regex : \"-->\", next : \"start\"},\n            {defaultToken : \"comment.xml\"}\n        ],\n\n        reference : [{\n            token : \"constant.language.escape.reference.xml\",\n            regex : \"(?:&#[0-9]+;)|(?:&#x[0-9a-fA-F]+;)|(?:&[a-zA-Z0-9_:\\\\.-]+;)\"\n        }],\n\n        attr_reference : [{\n            token : \"constant.language.escape.reference.attribute-value.xml\",\n            regex : \"(?:&#[0-9]+;)|(?:&#x[0-9a-fA-F]+;)|(?:&[a-zA-Z0-9_:\\\\.-]+;)\"\n        }],\n\n        tag : [{\n            token : [\"meta.tag.punctuation.tag-open.xml\", \"meta.tag.punctuation.end-tag-open.xml\", \"meta.tag.tag-name.xml\"],\n            regex : \"(?:(<)|(</))((?:\" + tagRegex + \":)?\" + tagRegex + \")\",\n            next: [\n                {include : \"attributes\"},\n                {token : \"meta.tag.punctuation.tag-close.xml\", regex : \"/?>\", next : \"start\"}\n            ]\n        }],\n\n        tag_whitespace : [\n            {token : \"text.tag-whitespace.xml\", regex : \"\\\\s+\"}\n        ],\n        whitespace : [\n            {token : \"text.whitespace.xml\", regex : \"\\\\s+\"}\n        ],\n        string: [{\n            token : \"string.xml\",\n            regex : \"'\",\n            push : [\n                {token : \"string.xml\", regex: \"'\", next: \"pop\"},\n                {defaultToken : \"string.xml\"}\n            ]\n        }, {\n            token : \"string.xml\",\n            regex : '\"',\n            push : [\n                {token : \"string.xml\", regex: '\"', next: \"pop\"},\n                {defaultToken : \"string.xml\"}\n            ]\n        }],\n\n        attributes: [{\n            token : \"entity.other.attribute-name.xml\",\n            regex : tagRegex\n        }, {\n            token : \"keyword.operator.attribute-equals.xml\",\n            regex : \"=\"\n        }, {\n            include: \"tag_whitespace\"\n        }, {\n            include: \"attribute_value\"\n        }],\n\n        attribute_value: [{\n            token : \"string.attribute-value.xml\",\n            regex : \"'\",\n            push : [\n                {token : \"string.attribute-value.xml\", regex: \"'\", next: \"pop\"},\n                {include : \"attr_reference\"},\n                {defaultToken : \"string.attribute-value.xml\"}\n            ]\n        }, {\n            token : \"string.attribute-value.xml\",\n            regex : '\"',\n            push : [\n                {token : \"string.attribute-value.xml\", regex: '\"', next: \"pop\"},\n                {include : \"attr_reference\"},\n                {defaultToken : \"string.attribute-value.xml\"}\n            ]\n        }]\n    };\n\n    if (this.constructor === XmlHighlightRules)\n        this.normalizeRules();\n};\n\n\n(function() {\n\n    this.embedTagRules = function(HighlightRules, prefix, tag){\n        this.$rules.tag.unshift({\n            token : [\"meta.tag.punctuation.tag-open.xml\", \"meta.tag.\" + tag + \".tag-name.xml\"],\n            regex : \"(<)(\" + tag + \"(?=\\\\s|>|$))\",\n            next: [\n                {include : \"attributes\"},\n                {token : \"meta.tag.punctuation.tag-close.xml\", regex : \"/?>\", next : prefix + \"start\"}\n            ]\n        });\n\n        this.$rules[tag + \"-end\"] = [\n            {include : \"attributes\"},\n            {token : \"meta.tag.punctuation.tag-close.xml\", regex : \"/?>\",  next: \"start\",\n                onMatch : function(value, currentState, stack) {\n                    stack.splice(0);\n                    return this.token;\n            }}\n        ];\n\n        this.embedRules(HighlightRules, prefix, [{\n            token: [\"meta.tag.punctuation.end-tag-open.xml\", \"meta.tag.\" + tag + \".tag-name.xml\"],\n            regex : \"(</)(\" + tag + \"(?=\\\\s|>|$))\",\n            next: tag + \"-end\"\n        }, {\n            token: \"string.cdata.xml\",\n            regex : \"<\\\\!\\\\[CDATA\\\\[\"\n        }, {\n            token: \"string.cdata.xml\",\n            regex : \"\\\\]\\\\]>\"\n        }]);\n    };\n\n}).call(TextHighlightRules.prototype);\n\noop.inherits(XmlHighlightRules, TextHighlightRules);\n\nexports.XmlHighlightRules = XmlHighlightRules;\n});\n\nace.define(\"ace/mode/behaviour/xml\",[\"require\",\"exports\",\"module\",\"ace/lib/oop\",\"ace/mode/behaviour\",\"ace/token_iterator\",\"ace/lib/lang\"], function(require, exports, module) {\n\"use strict\";\n\nvar oop = require(\"../../lib/oop\");\nvar Behaviour = require(\"../behaviour\").Behaviour;\nvar TokenIterator = require(\"../../token_iterator\").TokenIterator;\nvar lang = require(\"../../lib/lang\");\n\nfunction is(token, type) {\n    return token && token.type.lastIndexOf(type + \".xml\") > -1;\n}\n\nvar XmlBehaviour = function () {\n\n    this.add(\"string_dquotes\", \"insertion\", function (state, action, editor, session, text) {\n        if (text == '\"' || text == \"'\") {\n            var quote = text;\n            var selected = session.doc.getTextRange(editor.getSelectionRange());\n            if (selected !== \"\" && selected !== \"'\" && selected != '\"' && editor.getWrapBehavioursEnabled()) {\n                return {\n                    text: quote + selected + quote,\n                    selection: false\n                };\n            }\n\n            var cursor = editor.getCursorPosition();\n            var line = session.doc.getLine(cursor.row);\n            var rightChar = line.substring(cursor.column, cursor.column + 1);\n            var iterator = new TokenIterator(session, cursor.row, cursor.column);\n            var token = iterator.getCurrentToken();\n\n            if (rightChar == quote && (is(token, \"attribute-value\") || is(token, \"string\"))) {\n                return {\n                    text: \"\",\n                    selection: [1, 1]\n                };\n            }\n\n            if (!token)\n                token = iterator.stepBackward();\n\n            if (!token)\n                return;\n\n            while (is(token, \"tag-whitespace\") || is(token, \"whitespace\")) {\n                token = iterator.stepBackward();\n            }\n            var rightSpace = !rightChar || rightChar.match(/\\s/);\n            if (is(token, \"attribute-equals\") && (rightSpace || rightChar == '>') || (is(token, \"decl-attribute-equals\") && (rightSpace || rightChar == '?'))) {\n                return {\n                    text: quote + quote,\n                    selection: [1, 1]\n                };\n            }\n        }\n    });\n\n    this.add(\"string_dquotes\", \"deletion\", function(state, action, editor, session, range) {\n        var selected = session.doc.getTextRange(range);\n        if (!range.isMultiLine() && (selected == '\"' || selected == \"'\")) {\n            var line = session.doc.getLine(range.start.row);\n            var rightChar = line.substring(range.start.column + 1, range.start.column + 2);\n            if (rightChar == selected) {\n                range.end.column++;\n                return range;\n            }\n        }\n    });\n\n    this.add(\"autoclosing\", \"insertion\", function (state, action, editor, session, text) {\n        if (text == '>') {\n            var position = editor.getSelectionRange().start;\n            var iterator = new TokenIterator(session, position.row, position.column);\n            var token = iterator.getCurrentToken() || iterator.stepBackward();\n            if (!token || !(is(token, \"tag-name\") || is(token, \"tag-whitespace\") || is(token, \"attribute-name\") || is(token, \"attribute-equals\") || is(token, \"attribute-value\")))\n                return;\n            if (is(token, \"reference.attribute-value\"))\n                return;\n            if (is(token, \"attribute-value\")) {\n                var tokenEndColumn = iterator.getCurrentTokenColumn() + token.value.length;\n                if (position.column < tokenEndColumn)\n                    return;\n                if (position.column == tokenEndColumn) {\n                    var nextToken = iterator.stepForward();\n                    if (nextToken && is(nextToken, \"attribute-value\"))\n                        return;\n                    iterator.stepBackward();\n                }\n            }\n            \n            if (/^\\s*>/.test(session.getLine(position.row).slice(position.column)))\n                return;\n            while (!is(token, \"tag-name\")) {\n                token = iterator.stepBackward();\n                if (token.value == \"<\") {\n                    token = iterator.stepForward();\n                    break;\n                }\n            }\n\n            var tokenRow = iterator.getCurrentTokenRow();\n            var tokenColumn = iterator.getCurrentTokenColumn();\n            if (is(iterator.stepBackward(), \"end-tag-open\"))\n                return;\n\n            var element = token.value;\n            if (tokenRow == position.row)\n                element = element.substring(0, position.column - tokenColumn);\n\n            if (this.voidElements.hasOwnProperty(element.toLowerCase()))\n                 return;\n\n            return {\n               text: \">\" + \"</\" + element + \">\",\n               selection: [1, 1]\n            };\n        }\n    });\n\n    this.add(\"autoindent\", \"insertion\", function (state, action, editor, session, text) {\n        if (text == \"\\n\") {\n            var cursor = editor.getCursorPosition();\n            var line = session.getLine(cursor.row);\n            var iterator = new TokenIterator(session, cursor.row, cursor.column);\n            var token = iterator.getCurrentToken();\n\n            if (token && token.type.indexOf(\"tag-close\") !== -1) {\n                if (token.value == \"/>\")\n                    return;\n                while (token && token.type.indexOf(\"tag-name\") === -1) {\n                    token = iterator.stepBackward();\n                }\n\n                if (!token) {\n                    return;\n                }\n\n                var tag = token.value;\n                var row = iterator.getCurrentTokenRow();\n                token = iterator.stepBackward();\n                if (!token || token.type.indexOf(\"end-tag\") !== -1) {\n                    return;\n                }\n\n                if (this.voidElements && !this.voidElements[tag]) {\n                    var nextToken = session.getTokenAt(cursor.row, cursor.column+1);\n                    var line = session.getLine(row);\n                    var nextIndent = this.$getIndent(line);\n                    var indent = nextIndent + session.getTabString();\n\n                    if (nextToken && nextToken.value === \"</\") {\n                        return {\n                            text: \"\\n\" + indent + \"\\n\" + nextIndent,\n                            selection: [1, indent.length, 1, indent.length]\n                        };\n                    } else {\n                        return {\n                            text: \"\\n\" + indent\n                        };\n                    }\n                }\n            }\n        }\n    });\n\n};\n\noop.inherits(XmlBehaviour, Behaviour);\n\nexports.XmlBehaviour = XmlBehaviour;\n});\n\nace.define(\"ace/mode/folding/xml\",[\"require\",\"exports\",\"module\",\"ace/lib/oop\",\"ace/lib/lang\",\"ace/range\",\"ace/mode/folding/fold_mode\",\"ace/token_iterator\"], function(require, exports, module) {\n\"use strict\";\n\nvar oop = require(\"../../lib/oop\");\nvar lang = require(\"../../lib/lang\");\nvar Range = require(\"../../range\").Range;\nvar BaseFoldMode = require(\"./fold_mode\").FoldMode;\nvar TokenIterator = require(\"../../token_iterator\").TokenIterator;\n\nvar FoldMode = exports.FoldMode = function(voidElements, optionalEndTags) {\n    BaseFoldMode.call(this);\n    this.voidElements = voidElements || {};\n    this.optionalEndTags = oop.mixin({}, this.voidElements);\n    if (optionalEndTags)\n        oop.mixin(this.optionalEndTags, optionalEndTags);\n    \n};\noop.inherits(FoldMode, BaseFoldMode);\n\nvar Tag = function() {\n    this.tagName = \"\";\n    this.closing = false;\n    this.selfClosing = false;\n    this.start = {row: 0, column: 0};\n    this.end = {row: 0, column: 0};\n};\n\nfunction is(token, type) {\n    return token.type.lastIndexOf(type + \".xml\") > -1;\n}\n\n(function() {\n\n    this.getFoldWidget = function(session, foldStyle, row) {\n        var tag = this._getFirstTagInLine(session, row);\n\n        if (!tag)\n            return this.getCommentFoldWidget(session, row);\n\n        if (tag.closing || (!tag.tagName && tag.selfClosing))\n            return foldStyle == \"markbeginend\" ? \"end\" : \"\";\n\n        if (!tag.tagName || tag.selfClosing || this.voidElements.hasOwnProperty(tag.tagName.toLowerCase()))\n            return \"\";\n\n        if (this._findEndTagInLine(session, row, tag.tagName, tag.end.column))\n            return \"\";\n\n        return \"start\";\n    };\n    \n    this.getCommentFoldWidget = function(session, row) {\n        if (/comment/.test(session.getState(row)) && /<!-/.test(session.getLine(row)))\n            return \"start\";\n        return \"\";\n    };\n    this._getFirstTagInLine = function(session, row) {\n        var tokens = session.getTokens(row);\n        var tag = new Tag();\n\n        for (var i = 0; i < tokens.length; i++) {\n            var token = tokens[i];\n            if (is(token, \"tag-open\")) {\n                tag.end.column = tag.start.column + token.value.length;\n                tag.closing = is(token, \"end-tag-open\");\n                token = tokens[++i];\n                if (!token)\n                    return null;\n                tag.tagName = token.value;\n                tag.end.column += token.value.length;\n                for (i++; i < tokens.length; i++) {\n                    token = tokens[i];\n                    tag.end.column += token.value.length;\n                    if (is(token, \"tag-close\")) {\n                        tag.selfClosing = token.value == '/>';\n                        break;\n                    }\n                }\n                return tag;\n            } else if (is(token, \"tag-close\")) {\n                tag.selfClosing = token.value == '/>';\n                return tag;\n            }\n            tag.start.column += token.value.length;\n        }\n\n        return null;\n    };\n\n    this._findEndTagInLine = function(session, row, tagName, startColumn) {\n        var tokens = session.getTokens(row);\n        var column = 0;\n        for (var i = 0; i < tokens.length; i++) {\n            var token = tokens[i];\n            column += token.value.length;\n            if (column < startColumn)\n                continue;\n            if (is(token, \"end-tag-open\")) {\n                token = tokens[i + 1];\n                if (token && token.value == tagName)\n                    return true;\n            }\n        }\n        return false;\n    };\n    this._readTagForward = function(iterator) {\n        var token = iterator.getCurrentToken();\n        if (!token)\n            return null;\n\n        var tag = new Tag();\n        do {\n            if (is(token, \"tag-open\")) {\n                tag.closing = is(token, \"end-tag-open\");\n                tag.start.row = iterator.getCurrentTokenRow();\n                tag.start.column = iterator.getCurrentTokenColumn();\n            } else if (is(token, \"tag-name\")) {\n                tag.tagName = token.value;\n            } else if (is(token, \"tag-close\")) {\n                tag.selfClosing = token.value == \"/>\";\n                tag.end.row = iterator.getCurrentTokenRow();\n                tag.end.column = iterator.getCurrentTokenColumn() + token.value.length;\n                iterator.stepForward();\n                return tag;\n            }\n        } while(token = iterator.stepForward());\n\n        return null;\n    };\n    \n    this._readTagBackward = function(iterator) {\n        var token = iterator.getCurrentToken();\n        if (!token)\n            return null;\n\n        var tag = new Tag();\n        do {\n            if (is(token, \"tag-open\")) {\n                tag.closing = is(token, \"end-tag-open\");\n                tag.start.row = iterator.getCurrentTokenRow();\n                tag.start.column = iterator.getCurrentTokenColumn();\n                iterator.stepBackward();\n                return tag;\n            } else if (is(token, \"tag-name\")) {\n                tag.tagName = token.value;\n            } else if (is(token, \"tag-close\")) {\n                tag.selfClosing = token.value == \"/>\";\n                tag.end.row = iterator.getCurrentTokenRow();\n                tag.end.column = iterator.getCurrentTokenColumn() + token.value.length;\n            }\n        } while(token = iterator.stepBackward());\n\n        return null;\n    };\n    \n    this._pop = function(stack, tag) {\n        while (stack.length) {\n            \n            var top = stack[stack.length-1];\n            if (!tag || top.tagName == tag.tagName) {\n                return stack.pop();\n            }\n            else if (this.optionalEndTags.hasOwnProperty(top.tagName)) {\n                stack.pop();\n                continue;\n            } else {\n                return null;\n            }\n        }\n    };\n    \n    this.getFoldWidgetRange = function(session, foldStyle, row) {\n        var firstTag = this._getFirstTagInLine(session, row);\n        \n        if (!firstTag) {\n            return this.getCommentFoldWidget(session, row)\n                && session.getCommentFoldRange(row, session.getLine(row).length);\n        }\n        \n        var isBackward = firstTag.closing || firstTag.selfClosing;\n        var stack = [];\n        var tag;\n        \n        if (!isBackward) {\n            var iterator = new TokenIterator(session, row, firstTag.start.column);\n            var start = {\n                row: row,\n                column: firstTag.start.column + firstTag.tagName.length + 2\n            };\n            if (firstTag.start.row == firstTag.end.row)\n                start.column = firstTag.end.column;\n            while (tag = this._readTagForward(iterator)) {\n                if (tag.selfClosing) {\n                    if (!stack.length) {\n                        tag.start.column += tag.tagName.length + 2;\n                        tag.end.column -= 2;\n                        return Range.fromPoints(tag.start, tag.end);\n                    } else\n                        continue;\n                }\n                \n                if (tag.closing) {\n                    this._pop(stack, tag);\n                    if (stack.length == 0)\n                        return Range.fromPoints(start, tag.start);\n                }\n                else {\n                    stack.push(tag);\n                }\n            }\n        }\n        else {\n            var iterator = new TokenIterator(session, row, firstTag.end.column);\n            var end = {\n                row: row,\n                column: firstTag.start.column\n            };\n            \n            while (tag = this._readTagBackward(iterator)) {\n                if (tag.selfClosing) {\n                    if (!stack.length) {\n                        tag.start.column += tag.tagName.length + 2;\n                        tag.end.column -= 2;\n                        return Range.fromPoints(tag.start, tag.end);\n                    } else\n                        continue;\n                }\n                \n                if (!tag.closing) {\n                    this._pop(stack, tag);\n                    if (stack.length == 0) {\n                        tag.start.column += tag.tagName.length + 2;\n                        if (tag.start.row == tag.end.row && tag.start.column < tag.end.column)\n                            tag.start.column = tag.end.column;\n                        return Range.fromPoints(tag.start, end);\n                    }\n                }\n                else {\n                    stack.push(tag);\n                }\n            }\n        }\n        \n    };\n\n}).call(FoldMode.prototype);\n\n});\n\nace.define(\"ace/mode/xml\",[\"require\",\"exports\",\"module\",\"ace/lib/oop\",\"ace/lib/lang\",\"ace/mode/text\",\"ace/mode/xml_highlight_rules\",\"ace/mode/behaviour/xml\",\"ace/mode/folding/xml\",\"ace/worker/worker_client\"], function(require, exports, module) {\n\"use strict\";\n\nvar oop = require(\"../lib/oop\");\nvar lang = require(\"../lib/lang\");\nvar TextMode = require(\"./text\").Mode;\nvar XmlHighlightRules = require(\"./xml_highlight_rules\").XmlHighlightRules;\nvar XmlBehaviour = require(\"./behaviour/xml\").XmlBehaviour;\nvar XmlFoldMode = require(\"./folding/xml\").FoldMode;\nvar WorkerClient = require(\"../worker/worker_client\").WorkerClient;\n\nvar Mode = function() {\n   this.HighlightRules = XmlHighlightRules;\n   this.$behaviour = new XmlBehaviour();\n   this.foldingRules = new XmlFoldMode();\n};\n\noop.inherits(Mode, TextMode);\n\n(function() {\n\n    this.voidElements = lang.arrayToMap([]);\n\n    this.blockComment = {start: \"<!--\", end: \"-->\"};\n\n    this.createWorker = function(session) {\n        var worker = new WorkerClient([\"ace\"], \"ace/mode/xml_worker\", \"Worker\");\n        worker.attachToDocument(session.getDocument());\n\n        worker.on(\"error\", function(e) {\n            session.setAnnotations(e.data);\n        });\n\n        worker.on(\"terminate\", function() {\n            session.clearAnnotations();\n        });\n\n        return worker;\n    };\n    \n    this.$id = \"ace/mode/xml\";\n}).call(Mode.prototype);\n\nexports.Mode = Mode;\n});                (function() {\n                    ace.require([\"ace/mode/xml\"], function(m) {\n                        if (typeof module == \"object\" && typeof exports == \"object\" && module) {\n                            module.exports = m;\n                        }\n                    });\n                })();\n            "]},"metadata":{},"sourceType":"script"}