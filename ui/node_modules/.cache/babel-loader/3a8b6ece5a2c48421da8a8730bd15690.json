{"ast":null,"code":"ace.define(\"ace/ext/menu_tools/get_editor_keyboard_shortcuts\", [\"require\", \"exports\", \"module\", \"ace/lib/keys\"], function (require, exports, module) {\n  \"use strict\";\n\n  var keys = require(\"../../lib/keys\");\n\n  module.exports.getEditorKeybordShortcuts = function (editor) {\n    var KEY_MODS = keys.KEY_MODS;\n    var keybindings = [];\n    var commandMap = {};\n    editor.keyBinding.$handlers.forEach(function (handler) {\n      var ckb = handler.commandKeyBinding;\n\n      for (var i in ckb) {\n        var key = i.replace(/(^|-)\\w/g, function (x) {\n          return x.toUpperCase();\n        });\n        var commands = ckb[i];\n        if (!Array.isArray(commands)) commands = [commands];\n        commands.forEach(function (command) {\n          if (typeof command != \"string\") command = command.name;\n\n          if (commandMap[command]) {\n            commandMap[command].key += \"|\" + key;\n          } else {\n            commandMap[command] = {\n              key: key,\n              command: command\n            };\n            keybindings.push(commandMap[command]);\n          }\n        });\n      }\n    });\n    return keybindings;\n  };\n});\nace.define(\"ace/autocomplete/popup\", [\"require\", \"exports\", \"module\", \"ace/virtual_renderer\", \"ace/editor\", \"ace/range\", \"ace/lib/event\", \"ace/lib/lang\", \"ace/lib/dom\"], function (require, exports, module) {\n  \"use strict\";\n\n  var Renderer = require(\"../virtual_renderer\").VirtualRenderer;\n\n  var Editor = require(\"../editor\").Editor;\n\n  var Range = require(\"../range\").Range;\n\n  var event = require(\"../lib/event\");\n\n  var lang = require(\"../lib/lang\");\n\n  var dom = require(\"../lib/dom\");\n\n  var $singleLineEditor = function (el) {\n    var renderer = new Renderer(el);\n    renderer.$maxLines = 4;\n    var editor = new Editor(renderer);\n    editor.setHighlightActiveLine(false);\n    editor.setShowPrintMargin(false);\n    editor.renderer.setShowGutter(false);\n    editor.renderer.setHighlightGutterLine(false);\n    editor.$mouseHandler.$focusTimeout = 0;\n    editor.$highlightTagPending = true;\n    return editor;\n  };\n\n  var AcePopup = function (parentNode) {\n    var el = dom.createElement(\"div\");\n    var popup = new $singleLineEditor(el);\n    if (parentNode) parentNode.appendChild(el);\n    el.style.display = \"none\";\n    popup.renderer.content.style.cursor = \"default\";\n    popup.renderer.setStyle(\"ace_autocomplete\");\n    popup.setOption(\"displayIndentGuides\", false);\n    popup.setOption(\"dragDelay\", 150);\n\n    var noop = function () {};\n\n    popup.focus = noop;\n    popup.$isFocused = true;\n    popup.renderer.$cursorLayer.restartTimer = noop;\n    popup.renderer.$cursorLayer.element.style.opacity = 0;\n    popup.renderer.$maxLines = 8;\n    popup.renderer.$keepTextAreaAtCursor = false;\n    popup.setHighlightActiveLine(false);\n    popup.session.highlight(\"\");\n    popup.session.$searchHighlight.clazz = \"ace_highlight-marker\";\n    popup.on(\"mousedown\", function (e) {\n      var pos = e.getDocumentPosition();\n      popup.selection.moveToPosition(pos);\n      selectionMarker.start.row = selectionMarker.end.row = pos.row;\n      e.stop();\n    });\n    var lastMouseEvent;\n    var hoverMarker = new Range(-1, 0, -1, Infinity);\n    var selectionMarker = new Range(-1, 0, -1, Infinity);\n    selectionMarker.id = popup.session.addMarker(selectionMarker, \"ace_active-line\", \"fullLine\");\n\n    popup.setSelectOnHover = function (val) {\n      if (!val) {\n        hoverMarker.id = popup.session.addMarker(hoverMarker, \"ace_line-hover\", \"fullLine\");\n      } else if (hoverMarker.id) {\n        popup.session.removeMarker(hoverMarker.id);\n        hoverMarker.id = null;\n      }\n    };\n\n    popup.setSelectOnHover(false);\n    popup.on(\"mousemove\", function (e) {\n      if (!lastMouseEvent) {\n        lastMouseEvent = e;\n        return;\n      }\n\n      if (lastMouseEvent.x == e.x && lastMouseEvent.y == e.y) {\n        return;\n      }\n\n      lastMouseEvent = e;\n      lastMouseEvent.scrollTop = popup.renderer.scrollTop;\n      var row = lastMouseEvent.getDocumentPosition().row;\n\n      if (hoverMarker.start.row != row) {\n        if (!hoverMarker.id) popup.setRow(row);\n        setHoverMarker(row);\n      }\n    });\n    popup.renderer.on(\"beforeRender\", function () {\n      if (lastMouseEvent && hoverMarker.start.row != -1) {\n        lastMouseEvent.$pos = null;\n        var row = lastMouseEvent.getDocumentPosition().row;\n        if (!hoverMarker.id) popup.setRow(row);\n        setHoverMarker(row, true);\n      }\n    });\n    popup.renderer.on(\"afterRender\", function () {\n      var row = popup.getRow();\n      var t = popup.renderer.$textLayer;\n      var selected = t.element.childNodes[row - t.config.firstRow];\n      if (selected !== t.selectedNode && t.selectedNode) dom.removeCssClass(t.selectedNode, \"ace_selected\");\n      t.selectedNode = selected;\n      if (selected) dom.addCssClass(selected, \"ace_selected\");\n    });\n\n    var hideHoverMarker = function () {\n      setHoverMarker(-1);\n    };\n\n    var setHoverMarker = function (row, suppressRedraw) {\n      if (row !== hoverMarker.start.row) {\n        hoverMarker.start.row = hoverMarker.end.row = row;\n        if (!suppressRedraw) popup.session._emit(\"changeBackMarker\");\n\n        popup._emit(\"changeHoverMarker\");\n      }\n    };\n\n    popup.getHoveredRow = function () {\n      return hoverMarker.start.row;\n    };\n\n    event.addListener(popup.container, \"mouseout\", hideHoverMarker);\n    popup.on(\"hide\", hideHoverMarker);\n    popup.on(\"changeSelection\", hideHoverMarker);\n\n    popup.session.doc.getLength = function () {\n      return popup.data.length;\n    };\n\n    popup.session.doc.getLine = function (i) {\n      var data = popup.data[i];\n      if (typeof data == \"string\") return data;\n      return data && data.value || \"\";\n    };\n\n    var bgTokenizer = popup.session.bgTokenizer;\n\n    bgTokenizer.$tokenizeRow = function (row) {\n      var data = popup.data[row];\n      var tokens = [];\n      if (!data) return tokens;\n      if (typeof data == \"string\") data = {\n        value: data\n      };\n      var caption = data.caption || data.value || data.name;\n\n      function addToken(value, className) {\n        value && tokens.push({\n          type: (data.className || \"\") + (className || \"\"),\n          value: value\n        });\n      }\n\n      var lower = caption.toLowerCase();\n      var filterText = (popup.filterText || \"\").toLowerCase();\n      var lastIndex = 0;\n      var lastI = 0;\n\n      for (var i = 0; i <= filterText.length; i++) {\n        if (i != lastI && (data.matchMask & 1 << i || i == filterText.length)) {\n          var sub = filterText.slice(lastI, i);\n          lastI = i;\n          var index = lower.indexOf(sub, lastIndex);\n          if (index == -1) continue;\n          addToken(caption.slice(lastIndex, index), \"\");\n          lastIndex = index + sub.length;\n          addToken(caption.slice(index, lastIndex), \"completion-highlight\");\n        }\n      }\n\n      addToken(caption.slice(lastIndex, caption.length), \"\");\n      if (data.meta) tokens.push({\n        type: \"completion-meta\",\n        value: data.meta\n      });\n      if (data.message) tokens.push({\n        type: \"completion-message\",\n        value: data.message\n      });\n      return tokens;\n    };\n\n    bgTokenizer.$updateOnChange = noop;\n    bgTokenizer.start = noop;\n\n    popup.session.$computeWidth = function () {\n      return this.screenWidth = 0;\n    };\n\n    popup.isOpen = false;\n    popup.isTopdown = false;\n    popup.autoSelect = true;\n    popup.filterText = \"\";\n    popup.data = [];\n\n    popup.setData = function (list, filterText) {\n      popup.filterText = filterText || \"\";\n      popup.setValue(lang.stringRepeat(\"\\n\", list.length), -1);\n      popup.data = list || [];\n      popup.setRow(0);\n    };\n\n    popup.getData = function (row) {\n      return popup.data[row];\n    };\n\n    popup.getRow = function () {\n      return selectionMarker.start.row;\n    };\n\n    popup.setRow = function (line) {\n      line = Math.max(this.autoSelect ? 0 : -1, Math.min(this.data.length, line));\n\n      if (selectionMarker.start.row != line) {\n        popup.selection.clearSelection();\n        selectionMarker.start.row = selectionMarker.end.row = line || 0;\n\n        popup.session._emit(\"changeBackMarker\");\n\n        popup.moveCursorTo(line || 0, 0);\n        if (popup.isOpen) popup._signal(\"select\");\n      }\n    };\n\n    popup.on(\"changeSelection\", function () {\n      if (popup.isOpen) popup.setRow(popup.selection.lead.row);\n      popup.renderer.scrollCursorIntoView();\n    });\n\n    popup.hide = function () {\n      this.container.style.display = \"none\";\n\n      this._signal(\"hide\");\n\n      popup.isOpen = false;\n    };\n\n    popup.show = function (pos, lineHeight, topdownOnly) {\n      var el = this.container;\n      var screenHeight = window.innerHeight;\n      var screenWidth = window.innerWidth;\n      var renderer = this.renderer;\n      var maxH = renderer.$maxLines * lineHeight * 1.4;\n      var top = pos.top + this.$borderSize;\n      var allowTopdown = top > screenHeight / 2 && !topdownOnly;\n\n      if (allowTopdown && top + lineHeight + maxH > screenHeight) {\n        renderer.$maxPixelHeight = top - 2 * this.$borderSize;\n        el.style.top = \"\";\n        el.style.bottom = screenHeight - top + \"px\";\n        popup.isTopdown = false;\n      } else {\n        top += lineHeight;\n        renderer.$maxPixelHeight = screenHeight - top - 0.2 * lineHeight;\n        el.style.top = top + \"px\";\n        el.style.bottom = \"\";\n        popup.isTopdown = true;\n      }\n\n      el.style.display = \"\";\n      var left = pos.left;\n      if (left + el.offsetWidth > screenWidth) left = screenWidth - el.offsetWidth;\n      el.style.left = left + \"px\";\n\n      this._signal(\"show\");\n\n      lastMouseEvent = null;\n      popup.isOpen = true;\n    };\n\n    popup.goTo = function (where) {\n      var row = this.getRow();\n      var max = this.session.getLength() - 1;\n\n      switch (where) {\n        case \"up\":\n          row = row <= 0 ? max : row - 1;\n          break;\n\n        case \"down\":\n          row = row >= max ? -1 : row + 1;\n          break;\n\n        case \"start\":\n          row = 0;\n          break;\n\n        case \"end\":\n          row = max;\n          break;\n      }\n\n      this.setRow(row);\n    };\n\n    popup.getTextLeftOffset = function () {\n      return this.$borderSize + this.renderer.$padding + this.$imageSize;\n    };\n\n    popup.$imageSize = 0;\n    popup.$borderSize = 1;\n    return popup;\n  };\n\n  dom.importCssString(\"\\\n.ace_editor.ace_autocomplete .ace_marker-layer .ace_active-line {\\\n    background-color: #CAD6FA;\\\n    z-index: 1;\\\n}\\\n.ace_dark.ace_editor.ace_autocomplete .ace_marker-layer .ace_active-line {\\\n    background-color: #3a674e;\\\n}\\\n.ace_editor.ace_autocomplete .ace_line-hover {\\\n    border: 1px solid #abbffe;\\\n    margin-top: -1px;\\\n    background: rgba(233,233,253,0.4);\\\n    position: absolute;\\\n    z-index: 2;\\\n}\\\n.ace_dark.ace_editor.ace_autocomplete .ace_line-hover {\\\n    border: 1px solid rgba(109, 150, 13, 0.8);\\\n    background: rgba(58, 103, 78, 0.62);\\\n}\\\n.ace_completion-meta {\\\n    opacity: 0.5;\\\n    margin: 0.9em;\\\n}\\\n.ace_completion-message {\\\n    color: blue;\\\n}\\\n.ace_editor.ace_autocomplete .ace_completion-highlight{\\\n    color: #2d69c7;\\\n}\\\n.ace_dark.ace_editor.ace_autocomplete .ace_completion-highlight{\\\n    color: #93ca12;\\\n}\\\n.ace_editor.ace_autocomplete {\\\n    width: 300px;\\\n    z-index: 200000;\\\n    border: 1px lightgray solid;\\\n    position: fixed;\\\n    box-shadow: 2px 3px 5px rgba(0,0,0,.2);\\\n    line-height: 1.4;\\\n    background: #fefefe;\\\n    color: #111;\\\n}\\\n.ace_dark.ace_editor.ace_autocomplete {\\\n    border: 1px #484747 solid;\\\n    box-shadow: 2px 3px 5px rgba(0, 0, 0, 0.51);\\\n    line-height: 1.4;\\\n    background: #25282c;\\\n    color: #c1c1c1;\\\n}\", \"autocompletion.css\");\n  exports.AcePopup = AcePopup;\n  exports.$singleLineEditor = $singleLineEditor;\n});\nace.define(\"ace/autocomplete/util\", [\"require\", \"exports\", \"module\"], function (require, exports, module) {\n  \"use strict\";\n\n  exports.parForEach = function (array, fn, callback) {\n    var completed = 0;\n    var arLength = array.length;\n    if (arLength === 0) callback();\n\n    for (var i = 0; i < arLength; i++) {\n      fn(array[i], function (result, err) {\n        completed++;\n        if (completed === arLength) callback(result, err);\n      });\n    }\n  };\n\n  var ID_REGEX = /[a-zA-Z_0-9\\$\\-\\u00A2-\\u2000\\u2070-\\uFFFF]/;\n\n  exports.retrievePrecedingIdentifier = function (text, pos, regex) {\n    regex = regex || ID_REGEX;\n    var buf = [];\n\n    for (var i = pos - 1; i >= 0; i--) {\n      if (regex.test(text[i])) buf.push(text[i]);else break;\n    }\n\n    return buf.reverse().join(\"\");\n  };\n\n  exports.retrieveFollowingIdentifier = function (text, pos, regex) {\n    regex = regex || ID_REGEX;\n    var buf = [];\n\n    for (var i = pos; i < text.length; i++) {\n      if (regex.test(text[i])) buf.push(text[i]);else break;\n    }\n\n    return buf;\n  };\n\n  exports.getCompletionPrefix = function (editor) {\n    var pos = editor.getCursorPosition();\n    var line = editor.session.getLine(pos.row);\n    var prefix;\n    editor.completers.forEach(function (completer) {\n      if (completer.identifierRegexps) {\n        completer.identifierRegexps.forEach(function (identifierRegex) {\n          if (!prefix && identifierRegex) prefix = this.retrievePrecedingIdentifier(line, pos.column, identifierRegex);\n        }.bind(this));\n      }\n    }.bind(this));\n    return prefix || this.retrievePrecedingIdentifier(line, pos.column);\n  };\n});\nace.define(\"ace/snippets\", [\"require\", \"exports\", \"module\", \"ace/lib/oop\", \"ace/lib/event_emitter\", \"ace/lib/lang\", \"ace/range\", \"ace/range_list\", \"ace/keyboard/hash_handler\", \"ace/tokenizer\", \"ace/clipboard\", \"ace/lib/dom\", \"ace/editor\"], function (require, exports, module) {\n  \"use strict\";\n\n  var oop = require(\"./lib/oop\");\n\n  var EventEmitter = require(\"./lib/event_emitter\").EventEmitter;\n\n  var lang = require(\"./lib/lang\");\n\n  var Range = require(\"./range\").Range;\n\n  var RangeList = require(\"./range_list\").RangeList;\n\n  var HashHandler = require(\"./keyboard/hash_handler\").HashHandler;\n\n  var Tokenizer = require(\"./tokenizer\").Tokenizer;\n\n  var clipboard = require(\"./clipboard\");\n\n  var VARIABLES = {\n    CURRENT_WORD: function (editor) {\n      return editor.session.getTextRange(editor.session.getWordRange());\n    },\n    SELECTION: function (editor, name, indentation) {\n      var text = editor.session.getTextRange();\n      if (indentation) return text.replace(/\\n\\r?([ \\t]*\\S)/g, \"\\n\" + indentation + \"$1\");\n      return text;\n    },\n    CURRENT_LINE: function (editor) {\n      return editor.session.getLine(editor.getCursorPosition().row);\n    },\n    PREV_LINE: function (editor) {\n      return editor.session.getLine(editor.getCursorPosition().row - 1);\n    },\n    LINE_INDEX: function (editor) {\n      return editor.getCursorPosition().row;\n    },\n    LINE_NUMBER: function (editor) {\n      return editor.getCursorPosition().row + 1;\n    },\n    SOFT_TABS: function (editor) {\n      return editor.session.getUseSoftTabs() ? \"YES\" : \"NO\";\n    },\n    TAB_SIZE: function (editor) {\n      return editor.session.getTabSize();\n    },\n    CLIPBOARD: function (editor) {\n      return clipboard.getText && clipboard.getText();\n    },\n    FILENAME: function (editor) {\n      return /[^/\\\\]*$/.exec(this.FILEPATH(editor))[0];\n    },\n    FILENAME_BASE: function (editor) {\n      return /[^/\\\\]*$/.exec(this.FILEPATH(editor))[0].replace(/\\.[^.]*$/, \"\");\n    },\n    DIRECTORY: function (editor) {\n      return this.FILEPATH(editor).replace(/[^/\\\\]*$/, \"\");\n    },\n    FILEPATH: function (editor) {\n      return \"/not implemented.txt\";\n    },\n    WORKSPACE_NAME: function () {\n      return \"Unknown\";\n    },\n    FULLNAME: function () {\n      return \"Unknown\";\n    },\n    BLOCK_COMMENT_START: function (editor) {\n      var mode = editor.session.$mode || {};\n      return mode.blockComment && mode.blockComment.start || \"\";\n    },\n    BLOCK_COMMENT_END: function (editor) {\n      var mode = editor.session.$mode || {};\n      return mode.blockComment && mode.blockComment.end || \"\";\n    },\n    LINE_COMMENT: function (editor) {\n      var mode = editor.session.$mode || {};\n      return mode.lineCommentStart || \"\";\n    },\n    CURRENT_YEAR: date.bind(null, {\n      year: \"numeric\"\n    }),\n    CURRENT_YEAR_SHORT: date.bind(null, {\n      year: \"2-digit\"\n    }),\n    CURRENT_MONTH: date.bind(null, {\n      month: \"numeric\"\n    }),\n    CURRENT_MONTH_NAME: date.bind(null, {\n      month: \"long\"\n    }),\n    CURRENT_MONTH_NAME_SHORT: date.bind(null, {\n      month: \"short\"\n    }),\n    CURRENT_DATE: date.bind(null, {\n      day: \"2-digit\"\n    }),\n    CURRENT_DAY_NAME: date.bind(null, {\n      weekday: \"long\"\n    }),\n    CURRENT_DAY_NAME_SHORT: date.bind(null, {\n      weekday: \"short\"\n    }),\n    CURRENT_HOUR: date.bind(null, {\n      hour: \"2-digit\",\n      hour12: false\n    }),\n    CURRENT_MINUTE: date.bind(null, {\n      minute: \"2-digit\"\n    }),\n    CURRENT_SECOND: date.bind(null, {\n      second: \"2-digit\"\n    })\n  };\n  VARIABLES.SELECTED_TEXT = VARIABLES.SELECTION;\n\n  function date(dateFormat) {\n    var str = new Date().toLocaleString(\"en-us\", dateFormat);\n    return str.length == 1 ? \"0\" + str : str;\n  }\n\n  var SnippetManager = function () {\n    this.snippetMap = {};\n    this.snippetNameMap = {};\n  };\n\n  (function () {\n    oop.implement(this, EventEmitter);\n\n    this.getTokenizer = function () {\n      return SnippetManager.$tokenizer || this.createTokenizer();\n    };\n\n    this.createTokenizer = function () {\n      function TabstopToken(str) {\n        str = str.substr(1);\n        if (/^\\d+$/.test(str)) return [{\n          tabstopId: parseInt(str, 10)\n        }];\n        return [{\n          text: str\n        }];\n      }\n\n      function escape(ch) {\n        return \"(?:[^\\\\\\\\\" + ch + \"]|\\\\\\\\.)\";\n      }\n\n      var formatMatcher = {\n        regex: \"/(\" + escape(\"/\") + \"+)/\",\n        onMatch: function (val, state, stack) {\n          var ts = stack[0];\n          ts.fmtString = true;\n          ts.guard = val.slice(1, -1);\n          ts.flag = \"\";\n          return \"\";\n        },\n        next: \"formatString\"\n      };\n      SnippetManager.$tokenizer = new Tokenizer({\n        start: [{\n          regex: /\\\\./,\n          onMatch: function (val, state, stack) {\n            var ch = val[1];\n\n            if (ch == \"}\" && stack.length) {\n              val = ch;\n            } else if (\"`$\\\\\".indexOf(ch) != -1) {\n              val = ch;\n            }\n\n            return [val];\n          }\n        }, {\n          regex: /}/,\n          onMatch: function (val, state, stack) {\n            return [stack.length ? stack.shift() : val];\n          }\n        }, {\n          regex: /\\$(?:\\d+|\\w+)/,\n          onMatch: TabstopToken\n        }, {\n          regex: /\\$\\{[\\dA-Z_a-z]+/,\n          onMatch: function (str, state, stack) {\n            var t = TabstopToken(str.substr(1));\n            stack.unshift(t[0]);\n            return t;\n          },\n          next: \"snippetVar\"\n        }, {\n          regex: /\\n/,\n          token: \"newline\",\n          merge: false\n        }],\n        snippetVar: [{\n          regex: \"\\\\|\" + escape(\"\\\\|\") + \"*\\\\|\",\n          onMatch: function (val, state, stack) {\n            var choices = val.slice(1, -1).replace(/\\\\[,|\\\\]|,/g, function (operator) {\n              return operator.length == 2 ? operator[1] : \"\\x00\";\n            }).split(\"\\x00\");\n            stack[0].choices = choices;\n            return [choices[0]];\n          },\n          next: \"start\"\n        }, formatMatcher, {\n          regex: \"([^:}\\\\\\\\]|\\\\\\\\.)*:?\",\n          token: \"\",\n          next: \"start\"\n        }],\n        formatString: [{\n          regex: /:/,\n          onMatch: function (val, state, stack) {\n            if (stack.length && stack[0].expectElse) {\n              stack[0].expectElse = false;\n              stack[0].ifEnd = {\n                elseEnd: stack[0]\n              };\n              return [stack[0].ifEnd];\n            }\n\n            return \":\";\n          }\n        }, {\n          regex: /\\\\./,\n          onMatch: function (val, state, stack) {\n            var ch = val[1];\n            if (ch == \"}\" && stack.length) val = ch;else if (\"`$\\\\\".indexOf(ch) != -1) val = ch;else if (ch == \"n\") val = \"\\n\";else if (ch == \"t\") val = \"\\t\";else if (\"ulULE\".indexOf(ch) != -1) val = {\n              changeCase: ch,\n              local: ch > \"a\"\n            };\n            return [val];\n          }\n        }, {\n          regex: \"/\\\\w*}\",\n          onMatch: function (val, state, stack) {\n            var next = stack.shift();\n            if (next) next.flag = val.slice(1, -1);\n            this.next = next && next.tabstopId ? \"start\" : \"\";\n            return [next || val];\n          },\n          next: \"start\"\n        }, {\n          regex: /\\$(?:\\d+|\\w+)/,\n          onMatch: function (val, state, stack) {\n            return [{\n              text: val.slice(1)\n            }];\n          }\n        }, {\n          regex: /\\${\\w+/,\n          onMatch: function (val, state, stack) {\n            var token = {\n              text: val.slice(2)\n            };\n            stack.unshift(token);\n            return [token];\n          },\n          next: \"formatStringVar\"\n        }, {\n          regex: /\\n/,\n          token: \"newline\",\n          merge: false\n        }, {\n          regex: /}/,\n          onMatch: function (val, state, stack) {\n            var next = stack.shift();\n            this.next = next && next.tabstopId ? \"start\" : \"\";\n            return [next || val];\n          },\n          next: \"start\"\n        }],\n        formatStringVar: [{\n          regex: /:\\/\\w+}/,\n          onMatch: function (val, state, stack) {\n            var ts = stack[0];\n            ts.formatFunction = val.slice(2, -1);\n            return [stack.shift()];\n          },\n          next: \"formatString\"\n        }, formatMatcher, {\n          regex: /:[\\?\\-+]?/,\n          onMatch: function (val, state, stack) {\n            if (val[1] == \"+\") stack[0].ifEnd = stack[0];\n            if (val[1] == \"?\") stack[0].expectElse = true;\n          },\n          next: \"formatString\"\n        }, {\n          regex: \"([^:}\\\\\\\\]|\\\\\\\\.)*:?\",\n          token: \"\",\n          next: \"formatString\"\n        }]\n      });\n      return SnippetManager.$tokenizer;\n    };\n\n    this.tokenizeTmSnippet = function (str, startState) {\n      return this.getTokenizer().getLineTokens(str, startState).tokens.map(function (x) {\n        return x.value || x;\n      });\n    };\n\n    this.getVariableValue = function (editor, name, indentation) {\n      if (/^\\d+$/.test(name)) return (this.variables.__ || {})[name] || \"\";\n      if (/^[A-Z]\\d+$/.test(name)) return (this.variables[name[0] + \"__\"] || {})[name.substr(1)] || \"\";\n      name = name.replace(/^TM_/, \"\");\n      if (!this.variables.hasOwnProperty(name)) return \"\";\n      var value = this.variables[name];\n      if (typeof value == \"function\") value = this.variables[name](editor, name, indentation);\n      return value == null ? \"\" : value;\n    };\n\n    this.variables = VARIABLES;\n\n    this.tmStrFormat = function (str, ch, editor) {\n      if (!ch.fmt) return str;\n      var flag = ch.flag || \"\";\n      var re = ch.guard;\n      re = new RegExp(re, flag.replace(/[^gim]/g, \"\"));\n      var fmtTokens = typeof ch.fmt == \"string\" ? this.tokenizeTmSnippet(ch.fmt, \"formatString\") : ch.fmt;\n\n      var _self = this;\n\n      var formatted = str.replace(re, function () {\n        var oldArgs = _self.variables.__;\n        _self.variables.__ = [].slice.call(arguments);\n\n        var fmtParts = _self.resolveVariables(fmtTokens, editor);\n\n        var gChangeCase = \"E\";\n\n        for (var i = 0; i < fmtParts.length; i++) {\n          var ch = fmtParts[i];\n\n          if (typeof ch == \"object\") {\n            fmtParts[i] = \"\";\n\n            if (ch.changeCase && ch.local) {\n              var next = fmtParts[i + 1];\n\n              if (next && typeof next == \"string\") {\n                if (ch.changeCase == \"u\") fmtParts[i] = next[0].toUpperCase();else fmtParts[i] = next[0].toLowerCase();\n                fmtParts[i + 1] = next.substr(1);\n              }\n            } else if (ch.changeCase) {\n              gChangeCase = ch.changeCase;\n            }\n          } else if (gChangeCase == \"U\") {\n            fmtParts[i] = ch.toUpperCase();\n          } else if (gChangeCase == \"L\") {\n            fmtParts[i] = ch.toLowerCase();\n          }\n        }\n\n        _self.variables.__ = oldArgs;\n        return fmtParts.join(\"\");\n      });\n      return formatted;\n    };\n\n    this.tmFormatFunction = function (str, ch, editor) {\n      if (ch.formatFunction == \"upcase\") return str.toUpperCase();\n      if (ch.formatFunction == \"downcase\") return str.toLowerCase();\n      return str;\n    };\n\n    this.resolveVariables = function (snippet, editor) {\n      var result = [];\n      var indentation = \"\";\n      var afterNewLine = true;\n\n      for (var i = 0; i < snippet.length; i++) {\n        var ch = snippet[i];\n\n        if (typeof ch == \"string\") {\n          result.push(ch);\n\n          if (ch == \"\\n\") {\n            afterNewLine = true;\n            indentation = \"\";\n          } else if (afterNewLine) {\n            indentation = /^\\t*/.exec(ch)[0];\n            afterNewLine = /\\S/.test(ch);\n          }\n\n          continue;\n        }\n\n        if (!ch) continue;\n        afterNewLine = false;\n\n        if (ch.fmtString) {\n          var j = snippet.indexOf(ch, i + 1);\n          if (j == -1) j = snippet.length;\n          ch.fmt = snippet.slice(i + 1, j);\n          i = j;\n        }\n\n        if (ch.text) {\n          var value = this.getVariableValue(editor, ch.text, indentation) + \"\";\n          if (ch.fmtString) value = this.tmStrFormat(value, ch, editor);\n          if (ch.formatFunction) value = this.tmFormatFunction(value, ch, editor);\n\n          if (value && !ch.ifEnd) {\n            result.push(value);\n            gotoNext(ch);\n          } else if (!value && ch.ifEnd) {\n            gotoNext(ch.ifEnd);\n          }\n        } else if (ch.elseEnd) {\n          gotoNext(ch.elseEnd);\n        } else if (ch.tabstopId != null) {\n          result.push(ch);\n        } else if (ch.changeCase != null) {\n          result.push(ch);\n        }\n      }\n\n      function gotoNext(ch) {\n        var i1 = snippet.indexOf(ch, i + 1);\n        if (i1 != -1) i = i1;\n      }\n\n      return result;\n    };\n\n    this.insertSnippetForSelection = function (editor, snippetText) {\n      var cursor = editor.getCursorPosition();\n      var line = editor.session.getLine(cursor.row);\n      var tabString = editor.session.getTabString();\n      var indentString = line.match(/^\\s*/)[0];\n      if (cursor.column < indentString.length) indentString = indentString.slice(0, cursor.column);\n      snippetText = snippetText.replace(/\\r/g, \"\");\n      var tokens = this.tokenizeTmSnippet(snippetText);\n      tokens = this.resolveVariables(tokens, editor);\n      tokens = tokens.map(function (x) {\n        if (x == \"\\n\") return x + indentString;\n        if (typeof x == \"string\") return x.replace(/\\t/g, tabString);\n        return x;\n      });\n      var tabstops = [];\n      tokens.forEach(function (p, i) {\n        if (typeof p != \"object\") return;\n        var id = p.tabstopId;\n        var ts = tabstops[id];\n\n        if (!ts) {\n          ts = tabstops[id] = [];\n          ts.index = id;\n          ts.value = \"\";\n          ts.parents = {};\n        }\n\n        if (ts.indexOf(p) !== -1) return;\n        if (p.choices && !ts.choices) ts.choices = p.choices;\n        ts.push(p);\n        var i1 = tokens.indexOf(p, i + 1);\n        if (i1 === -1) return;\n        var value = tokens.slice(i + 1, i1);\n        var isNested = value.some(function (t) {\n          return typeof t === \"object\";\n        });\n\n        if (isNested && !ts.value) {\n          ts.value = value;\n        } else if (value.length && (!ts.value || typeof ts.value !== \"string\")) {\n          ts.value = value.join(\"\");\n        }\n      });\n      tabstops.forEach(function (ts) {\n        ts.length = 0;\n      });\n      var expanding = {};\n\n      function copyValue(val) {\n        var copy = [];\n\n        for (var i = 0; i < val.length; i++) {\n          var p = val[i];\n\n          if (typeof p == \"object\") {\n            if (expanding[p.tabstopId]) continue;\n            var j = val.lastIndexOf(p, i - 1);\n            p = copy[j] || {\n              tabstopId: p.tabstopId\n            };\n          }\n\n          copy[i] = p;\n        }\n\n        return copy;\n      }\n\n      for (var i = 0; i < tokens.length; i++) {\n        var p = tokens[i];\n        if (typeof p != \"object\") continue;\n        var id = p.tabstopId;\n        var ts = tabstops[id];\n        var i1 = tokens.indexOf(p, i + 1);\n\n        if (expanding[id]) {\n          if (expanding[id] === p) {\n            delete expanding[id];\n            Object.keys(expanding).forEach(function (parentId) {\n              ts.parents[parentId] = true;\n            });\n          }\n\n          continue;\n        }\n\n        expanding[id] = p;\n        var value = ts.value;\n        if (typeof value !== \"string\") value = copyValue(value);else if (p.fmt) value = this.tmStrFormat(value, p, editor);\n        tokens.splice.apply(tokens, [i + 1, Math.max(0, i1 - i)].concat(value, p));\n        if (ts.indexOf(p) === -1) ts.push(p);\n      }\n\n      var row = 0,\n          column = 0;\n      var text = \"\";\n      tokens.forEach(function (t) {\n        if (typeof t === \"string\") {\n          var lines = t.split(\"\\n\");\n\n          if (lines.length > 1) {\n            column = lines[lines.length - 1].length;\n            row += lines.length - 1;\n          } else column += t.length;\n\n          text += t;\n        } else if (t) {\n          if (!t.start) t.start = {\n            row: row,\n            column: column\n          };else t.end = {\n            row: row,\n            column: column\n          };\n        }\n      });\n      var range = editor.getSelectionRange();\n      var end = editor.session.replace(range, text);\n      var tabstopManager = new TabstopManager(editor);\n      var selectionId = editor.inVirtualSelectionMode && editor.selection.index;\n      tabstopManager.addTabstops(tabstops, range.start, end, selectionId);\n    };\n\n    this.insertSnippet = function (editor, snippetText) {\n      var self = this;\n      if (editor.inVirtualSelectionMode) return self.insertSnippetForSelection(editor, snippetText);\n      editor.forEachSelection(function () {\n        self.insertSnippetForSelection(editor, snippetText);\n      }, null, {\n        keepOrder: true\n      });\n      if (editor.tabstopManager) editor.tabstopManager.tabNext();\n    };\n\n    this.$getScope = function (editor) {\n      var scope = editor.session.$mode.$id || \"\";\n      scope = scope.split(\"/\").pop();\n\n      if (scope === \"html\" || scope === \"php\") {\n        if (scope === \"php\" && !editor.session.$mode.inlinePhp) scope = \"html\";\n        var c = editor.getCursorPosition();\n        var state = editor.session.getState(c.row);\n\n        if (typeof state === \"object\") {\n          state = state[0];\n        }\n\n        if (state.substring) {\n          if (state.substring(0, 3) == \"js-\") scope = \"javascript\";else if (state.substring(0, 4) == \"css-\") scope = \"css\";else if (state.substring(0, 4) == \"php-\") scope = \"php\";\n        }\n      }\n\n      return scope;\n    };\n\n    this.getActiveScopes = function (editor) {\n      var scope = this.$getScope(editor);\n      var scopes = [scope];\n      var snippetMap = this.snippetMap;\n\n      if (snippetMap[scope] && snippetMap[scope].includeScopes) {\n        scopes.push.apply(scopes, snippetMap[scope].includeScopes);\n      }\n\n      scopes.push(\"_\");\n      return scopes;\n    };\n\n    this.expandWithTab = function (editor, options) {\n      var self = this;\n      var result = editor.forEachSelection(function () {\n        return self.expandSnippetForSelection(editor, options);\n      }, null, {\n        keepOrder: true\n      });\n      if (result && editor.tabstopManager) editor.tabstopManager.tabNext();\n      return result;\n    };\n\n    this.expandSnippetForSelection = function (editor, options) {\n      var cursor = editor.getCursorPosition();\n      var line = editor.session.getLine(cursor.row);\n      var before = line.substring(0, cursor.column);\n      var after = line.substr(cursor.column);\n      var snippetMap = this.snippetMap;\n      var snippet;\n      this.getActiveScopes(editor).some(function (scope) {\n        var snippets = snippetMap[scope];\n        if (snippets) snippet = this.findMatchingSnippet(snippets, before, after);\n        return !!snippet;\n      }, this);\n      if (!snippet) return false;\n      if (options && options.dryRun) return true;\n      editor.session.doc.removeInLine(cursor.row, cursor.column - snippet.replaceBefore.length, cursor.column + snippet.replaceAfter.length);\n      this.variables.M__ = snippet.matchBefore;\n      this.variables.T__ = snippet.matchAfter;\n      this.insertSnippetForSelection(editor, snippet.content);\n      this.variables.M__ = this.variables.T__ = null;\n      return true;\n    };\n\n    this.findMatchingSnippet = function (snippetList, before, after) {\n      for (var i = snippetList.length; i--;) {\n        var s = snippetList[i];\n        if (s.startRe && !s.startRe.test(before)) continue;\n        if (s.endRe && !s.endRe.test(after)) continue;\n        if (!s.startRe && !s.endRe) continue;\n        s.matchBefore = s.startRe ? s.startRe.exec(before) : [\"\"];\n        s.matchAfter = s.endRe ? s.endRe.exec(after) : [\"\"];\n        s.replaceBefore = s.triggerRe ? s.triggerRe.exec(before)[0] : \"\";\n        s.replaceAfter = s.endTriggerRe ? s.endTriggerRe.exec(after)[0] : \"\";\n        return s;\n      }\n    };\n\n    this.snippetMap = {};\n    this.snippetNameMap = {};\n\n    this.register = function (snippets, scope) {\n      var snippetMap = this.snippetMap;\n      var snippetNameMap = this.snippetNameMap;\n      var self = this;\n      if (!snippets) snippets = [];\n\n      function wrapRegexp(src) {\n        if (src && !/^\\^?\\(.*\\)\\$?$|^\\\\b$/.test(src)) src = \"(?:\" + src + \")\";\n        return src || \"\";\n      }\n\n      function guardedRegexp(re, guard, opening) {\n        re = wrapRegexp(re);\n        guard = wrapRegexp(guard);\n\n        if (opening) {\n          re = guard + re;\n          if (re && re[re.length - 1] != \"$\") re = re + \"$\";\n        } else {\n          re = re + guard;\n          if (re && re[0] != \"^\") re = \"^\" + re;\n        }\n\n        return new RegExp(re);\n      }\n\n      function addSnippet(s) {\n        if (!s.scope) s.scope = scope || \"_\";\n        scope = s.scope;\n\n        if (!snippetMap[scope]) {\n          snippetMap[scope] = [];\n          snippetNameMap[scope] = {};\n        }\n\n        var map = snippetNameMap[scope];\n\n        if (s.name) {\n          var old = map[s.name];\n          if (old) self.unregister(old);\n          map[s.name] = s;\n        }\n\n        snippetMap[scope].push(s);\n        if (s.prefix) s.tabTrigger = s.prefix;\n        if (!s.content && s.body) s.content = Array.isArray(s.body) ? s.body.join(\"\\n\") : s.body;\n\n        if (s.tabTrigger && !s.trigger) {\n          if (!s.guard && /^\\w/.test(s.tabTrigger)) s.guard = \"\\\\b\";\n          s.trigger = lang.escapeRegExp(s.tabTrigger);\n        }\n\n        if (!s.trigger && !s.guard && !s.endTrigger && !s.endGuard) return;\n        s.startRe = guardedRegexp(s.trigger, s.guard, true);\n        s.triggerRe = new RegExp(s.trigger);\n        s.endRe = guardedRegexp(s.endTrigger, s.endGuard, true);\n        s.endTriggerRe = new RegExp(s.endTrigger);\n      }\n\n      if (Array.isArray(snippets)) {\n        snippets.forEach(addSnippet);\n      } else {\n        Object.keys(snippets).forEach(function (key) {\n          addSnippet(snippets[key]);\n        });\n      }\n\n      this._signal(\"registerSnippets\", {\n        scope: scope\n      });\n    };\n\n    this.unregister = function (snippets, scope) {\n      var snippetMap = this.snippetMap;\n      var snippetNameMap = this.snippetNameMap;\n\n      function removeSnippet(s) {\n        var nameMap = snippetNameMap[s.scope || scope];\n\n        if (nameMap && nameMap[s.name]) {\n          delete nameMap[s.name];\n          var map = snippetMap[s.scope || scope];\n          var i = map && map.indexOf(s);\n          if (i >= 0) map.splice(i, 1);\n        }\n      }\n\n      if (snippets.content) removeSnippet(snippets);else if (Array.isArray(snippets)) snippets.forEach(removeSnippet);\n    };\n\n    this.parseSnippetFile = function (str) {\n      str = str.replace(/\\r/g, \"\");\n      var list = [],\n          snippet = {};\n      var re = /^#.*|^({[\\s\\S]*})\\s*$|^(\\S+) (.*)$|^((?:\\n*\\t.*)+)/gm;\n      var m;\n\n      while (m = re.exec(str)) {\n        if (m[1]) {\n          try {\n            snippet = JSON.parse(m[1]);\n            list.push(snippet);\n          } catch (e) {}\n        }\n\n        if (m[4]) {\n          snippet.content = m[4].replace(/^\\t/gm, \"\");\n          list.push(snippet);\n          snippet = {};\n        } else {\n          var key = m[2],\n              val = m[3];\n\n          if (key == \"regex\") {\n            var guardRe = /\\/((?:[^\\/\\\\]|\\\\.)*)|$/g;\n            snippet.guard = guardRe.exec(val)[1];\n            snippet.trigger = guardRe.exec(val)[1];\n            snippet.endTrigger = guardRe.exec(val)[1];\n            snippet.endGuard = guardRe.exec(val)[1];\n          } else if (key == \"snippet\") {\n            snippet.tabTrigger = val.match(/^\\S*/)[0];\n            if (!snippet.name) snippet.name = val;\n          } else if (key) {\n            snippet[key] = val;\n          }\n        }\n      }\n\n      return list;\n    };\n\n    this.getSnippetByName = function (name, editor) {\n      var snippetMap = this.snippetNameMap;\n      var snippet;\n      this.getActiveScopes(editor).some(function (scope) {\n        var snippets = snippetMap[scope];\n        if (snippets) snippet = snippets[name];\n        return !!snippet;\n      }, this);\n      return snippet;\n    };\n  }).call(SnippetManager.prototype);\n\n  var TabstopManager = function (editor) {\n    if (editor.tabstopManager) return editor.tabstopManager;\n    editor.tabstopManager = this;\n    this.$onChange = this.onChange.bind(this);\n    this.$onChangeSelection = lang.delayedCall(this.onChangeSelection.bind(this)).schedule;\n    this.$onChangeSession = this.onChangeSession.bind(this);\n    this.$onAfterExec = this.onAfterExec.bind(this);\n    this.attach(editor);\n  };\n\n  (function () {\n    this.attach = function (editor) {\n      this.index = 0;\n      this.ranges = [];\n      this.tabstops = [];\n      this.$openTabstops = null;\n      this.selectedTabstop = null;\n      this.editor = editor;\n      this.editor.on(\"change\", this.$onChange);\n      this.editor.on(\"changeSelection\", this.$onChangeSelection);\n      this.editor.on(\"changeSession\", this.$onChangeSession);\n      this.editor.commands.on(\"afterExec\", this.$onAfterExec);\n      this.editor.keyBinding.addKeyboardHandler(this.keyboardHandler);\n    };\n\n    this.detach = function () {\n      this.tabstops.forEach(this.removeTabstopMarkers, this);\n      this.ranges = null;\n      this.tabstops = null;\n      this.selectedTabstop = null;\n      this.editor.removeListener(\"change\", this.$onChange);\n      this.editor.removeListener(\"changeSelection\", this.$onChangeSelection);\n      this.editor.removeListener(\"changeSession\", this.$onChangeSession);\n      this.editor.commands.removeListener(\"afterExec\", this.$onAfterExec);\n      this.editor.keyBinding.removeKeyboardHandler(this.keyboardHandler);\n      this.editor.tabstopManager = null;\n      this.editor = null;\n    };\n\n    this.onChange = function (delta) {\n      var isRemove = delta.action[0] == \"r\";\n      var selectedTabstop = this.selectedTabstop || {};\n      var parents = selectedTabstop.parents || {};\n      var tabstops = (this.tabstops || []).slice();\n\n      for (var i = 0; i < tabstops.length; i++) {\n        var ts = tabstops[i];\n        var active = ts == selectedTabstop || parents[ts.index];\n        ts.rangeList.$bias = active ? 0 : 1;\n\n        if (delta.action == \"remove\" && ts !== selectedTabstop) {\n          var parentActive = ts.parents && ts.parents[selectedTabstop.index];\n          var startIndex = ts.rangeList.pointIndex(delta.start, parentActive);\n          startIndex = startIndex < 0 ? -startIndex - 1 : startIndex + 1;\n          var endIndex = ts.rangeList.pointIndex(delta.end, parentActive);\n          endIndex = endIndex < 0 ? -endIndex - 1 : endIndex - 1;\n          var toRemove = ts.rangeList.ranges.slice(startIndex, endIndex);\n\n          for (var j = 0; j < toRemove.length; j++) this.removeRange(toRemove[j]);\n        }\n\n        ts.rangeList.$onChange(delta);\n      }\n\n      var session = this.editor.session;\n      if (!this.$inChange && isRemove && session.getLength() == 1 && !session.getValue()) this.detach();\n    };\n\n    this.updateLinkedFields = function () {\n      var ts = this.selectedTabstop;\n      if (!ts || !ts.hasLinkedRanges || !ts.firstNonLinked) return;\n      this.$inChange = true;\n      var session = this.editor.session;\n      var text = session.getTextRange(ts.firstNonLinked);\n\n      for (var i = 0; i < ts.length; i++) {\n        var range = ts[i];\n        if (!range.linked) continue;\n        var original = range.original;\n        var fmt = exports.snippetManager.tmStrFormat(text, original, this.editor);\n        session.replace(range, fmt);\n      }\n\n      this.$inChange = false;\n    };\n\n    this.onAfterExec = function (e) {\n      if (e.command && !e.command.readOnly) this.updateLinkedFields();\n    };\n\n    this.onChangeSelection = function () {\n      if (!this.editor) return;\n      var lead = this.editor.selection.lead;\n      var anchor = this.editor.selection.anchor;\n      var isEmpty = this.editor.selection.isEmpty();\n\n      for (var i = 0; i < this.ranges.length; i++) {\n        if (this.ranges[i].linked) continue;\n        var containsLead = this.ranges[i].contains(lead.row, lead.column);\n        var containsAnchor = isEmpty || this.ranges[i].contains(anchor.row, anchor.column);\n        if (containsLead && containsAnchor) return;\n      }\n\n      this.detach();\n    };\n\n    this.onChangeSession = function () {\n      this.detach();\n    };\n\n    this.tabNext = function (dir) {\n      var max = this.tabstops.length;\n      var index = this.index + (dir || 1);\n      index = Math.min(Math.max(index, 1), max);\n      if (index == max) index = 0;\n      this.selectTabstop(index);\n      if (index === 0) this.detach();\n    };\n\n    this.selectTabstop = function (index) {\n      this.$openTabstops = null;\n      var ts = this.tabstops[this.index];\n      if (ts) this.addTabstopMarkers(ts);\n      this.index = index;\n      ts = this.tabstops[this.index];\n      if (!ts || !ts.length) return;\n      this.selectedTabstop = ts;\n      var range = ts.firstNonLinked || ts;\n\n      if (!this.editor.inVirtualSelectionMode) {\n        var sel = this.editor.multiSelect;\n        sel.toSingleRange(range.clone());\n\n        for (var i = 0; i < ts.length; i++) {\n          if (ts.hasLinkedRanges && ts[i].linked) continue;\n          sel.addRange(ts[i].clone(), true);\n        }\n\n        if (sel.ranges[0]) sel.addRange(sel.ranges[0].clone());\n      } else {\n        this.editor.selection.setRange(range);\n      }\n\n      this.editor.keyBinding.addKeyboardHandler(this.keyboardHandler);\n      if (this.selectedTabstop && this.selectedTabstop.choices) this.editor.execCommand(\"startAutocomplete\", {\n        matches: this.selectedTabstop.choices\n      });\n    };\n\n    this.addTabstops = function (tabstops, start, end) {\n      var useLink = this.useLink || !this.editor.getOption(\"enableMultiselect\");\n      if (!this.$openTabstops) this.$openTabstops = [];\n\n      if (!tabstops[0]) {\n        var p = Range.fromPoints(end, end);\n        moveRelative(p.start, start);\n        moveRelative(p.end, start);\n        tabstops[0] = [p];\n        tabstops[0].index = 0;\n      }\n\n      var i = this.index;\n      var arg = [i + 1, 0];\n      var ranges = this.ranges;\n      tabstops.forEach(function (ts, index) {\n        var dest = this.$openTabstops[index] || ts;\n\n        for (var i = 0; i < ts.length; i++) {\n          var p = ts[i];\n          var range = Range.fromPoints(p.start, p.end || p.start);\n          movePoint(range.start, start);\n          movePoint(range.end, start);\n          range.original = p;\n          range.tabstop = dest;\n          ranges.push(range);\n          if (dest != ts) dest.unshift(range);else dest[i] = range;\n\n          if (p.fmtString || dest.firstNonLinked && useLink) {\n            range.linked = true;\n            dest.hasLinkedRanges = true;\n          } else if (!dest.firstNonLinked) dest.firstNonLinked = range;\n        }\n\n        if (!dest.firstNonLinked) dest.hasLinkedRanges = false;\n\n        if (dest === ts) {\n          arg.push(dest);\n          this.$openTabstops[index] = dest;\n        }\n\n        this.addTabstopMarkers(dest);\n        dest.rangeList = dest.rangeList || new RangeList();\n        dest.rangeList.$bias = 0;\n        dest.rangeList.addList(dest);\n      }, this);\n\n      if (arg.length > 2) {\n        if (this.tabstops.length) arg.push(arg.splice(2, 1)[0]);\n        this.tabstops.splice.apply(this.tabstops, arg);\n      }\n    };\n\n    this.addTabstopMarkers = function (ts) {\n      var session = this.editor.session;\n      ts.forEach(function (range) {\n        if (!range.markerId) range.markerId = session.addMarker(range, \"ace_snippet-marker\", \"text\");\n      });\n    };\n\n    this.removeTabstopMarkers = function (ts) {\n      var session = this.editor.session;\n      ts.forEach(function (range) {\n        session.removeMarker(range.markerId);\n        range.markerId = null;\n      });\n    };\n\n    this.removeRange = function (range) {\n      var i = range.tabstop.indexOf(range);\n      if (i != -1) range.tabstop.splice(i, 1);\n      i = this.ranges.indexOf(range);\n      if (i != -1) this.ranges.splice(i, 1);\n      i = range.tabstop.rangeList.ranges.indexOf(range);\n      if (i != -1) range.tabstop.splice(i, 1);\n      this.editor.session.removeMarker(range.markerId);\n\n      if (!range.tabstop.length) {\n        i = this.tabstops.indexOf(range.tabstop);\n        if (i != -1) this.tabstops.splice(i, 1);\n        if (!this.tabstops.length) this.detach();\n      }\n    };\n\n    this.keyboardHandler = new HashHandler();\n    this.keyboardHandler.bindKeys({\n      \"Tab\": function (editor) {\n        if (exports.snippetManager && exports.snippetManager.expandWithTab(editor)) return;\n        editor.tabstopManager.tabNext(1);\n        editor.renderer.scrollCursorIntoView();\n      },\n      \"Shift-Tab\": function (editor) {\n        editor.tabstopManager.tabNext(-1);\n        editor.renderer.scrollCursorIntoView();\n      },\n      \"Esc\": function (editor) {\n        editor.tabstopManager.detach();\n      }\n    });\n  }).call(TabstopManager.prototype);\n\n  var movePoint = function (point, diff) {\n    if (point.row == 0) point.column += diff.column;\n    point.row += diff.row;\n  };\n\n  var moveRelative = function (point, start) {\n    if (point.row == start.row) point.column -= start.column;\n    point.row -= start.row;\n  };\n\n  require(\"./lib/dom\").importCssString(\"\\\n.ace_snippet-marker {\\\n    -moz-box-sizing: border-box;\\\n    box-sizing: border-box;\\\n    background: rgba(194, 193, 208, 0.09);\\\n    border: 1px dotted rgba(211, 208, 235, 0.62);\\\n    position: absolute;\\\n}\");\n\n  exports.snippetManager = new SnippetManager();\n\n  var Editor = require(\"./editor\").Editor;\n\n  (function () {\n    this.insertSnippet = function (content, options) {\n      return exports.snippetManager.insertSnippet(this, content, options);\n    };\n\n    this.expandSnippet = function (options) {\n      return exports.snippetManager.expandWithTab(this, options);\n    };\n  }).call(Editor.prototype);\n});\nace.define(\"ace/autocomplete\", [\"require\", \"exports\", \"module\", \"ace/keyboard/hash_handler\", \"ace/autocomplete/popup\", \"ace/autocomplete/util\", \"ace/lib/lang\", \"ace/lib/dom\", \"ace/snippets\", \"ace/config\"], function (require, exports, module) {\n  \"use strict\";\n\n  var HashHandler = require(\"./keyboard/hash_handler\").HashHandler;\n\n  var AcePopup = require(\"./autocomplete/popup\").AcePopup;\n\n  var util = require(\"./autocomplete/util\");\n\n  var lang = require(\"./lib/lang\");\n\n  var dom = require(\"./lib/dom\");\n\n  var snippetManager = require(\"./snippets\").snippetManager;\n\n  var config = require(\"./config\");\n\n  var Autocomplete = function () {\n    this.autoInsert = false;\n    this.autoSelect = true;\n    this.exactMatch = false;\n    this.gatherCompletionsId = 0;\n    this.keyboardHandler = new HashHandler();\n    this.keyboardHandler.bindKeys(this.commands);\n    this.blurListener = this.blurListener.bind(this);\n    this.changeListener = this.changeListener.bind(this);\n    this.mousedownListener = this.mousedownListener.bind(this);\n    this.mousewheelListener = this.mousewheelListener.bind(this);\n    this.changeTimer = lang.delayedCall(function () {\n      this.updateCompletions(true);\n    }.bind(this));\n    this.tooltipTimer = lang.delayedCall(this.updateDocTooltip.bind(this), 50);\n  };\n\n  (function () {\n    this.$init = function () {\n      this.popup = new AcePopup(document.body || document.documentElement);\n      this.popup.on(\"click\", function (e) {\n        this.insertMatch();\n        e.stop();\n      }.bind(this));\n      this.popup.focus = this.editor.focus.bind(this.editor);\n      this.popup.on(\"show\", this.tooltipTimer.bind(null, null));\n      this.popup.on(\"select\", this.tooltipTimer.bind(null, null));\n      this.popup.on(\"changeHoverMarker\", this.tooltipTimer.bind(null, null));\n      return this.popup;\n    };\n\n    this.getPopup = function () {\n      return this.popup || this.$init();\n    };\n\n    this.openPopup = function (editor, prefix, keepPopupPosition) {\n      if (!this.popup) this.$init();\n      this.popup.autoSelect = this.autoSelect;\n      this.popup.setData(this.completions.filtered, this.completions.filterText);\n      editor.keyBinding.addKeyboardHandler(this.keyboardHandler);\n      var renderer = editor.renderer;\n      this.popup.setRow(this.autoSelect ? 0 : -1);\n\n      if (!keepPopupPosition) {\n        this.popup.setTheme(editor.getTheme());\n        this.popup.setFontSize(editor.getFontSize());\n        var lineHeight = renderer.layerConfig.lineHeight;\n        var pos = renderer.$cursorLayer.getPixelPosition(this.base, true);\n        pos.left -= this.popup.getTextLeftOffset();\n        var rect = editor.container.getBoundingClientRect();\n        pos.top += rect.top - renderer.layerConfig.offset;\n        pos.left += rect.left - editor.renderer.scrollLeft;\n        pos.left += renderer.gutterWidth;\n        this.popup.show(pos, lineHeight);\n      } else if (keepPopupPosition && !prefix) {\n        this.detach();\n      }\n    };\n\n    this.detach = function () {\n      this.editor.keyBinding.removeKeyboardHandler(this.keyboardHandler);\n      this.editor.off(\"changeSelection\", this.changeListener);\n      this.editor.off(\"blur\", this.blurListener);\n      this.editor.off(\"mousedown\", this.mousedownListener);\n      this.editor.off(\"mousewheel\", this.mousewheelListener);\n      this.changeTimer.cancel();\n      this.hideDocTooltip();\n      this.gatherCompletionsId += 1;\n      if (this.popup && this.popup.isOpen) this.popup.hide();\n      if (this.base) this.base.detach();\n      this.activated = false;\n      this.completions = this.base = null;\n    };\n\n    this.changeListener = function (e) {\n      var cursor = this.editor.selection.lead;\n\n      if (cursor.row != this.base.row || cursor.column < this.base.column) {\n        this.detach();\n      }\n\n      if (this.activated) this.changeTimer.schedule();else this.detach();\n    };\n\n    this.blurListener = function (e) {\n      var el = document.activeElement;\n      var text = this.editor.textInput.getElement();\n      var fromTooltip = e.relatedTarget && this.tooltipNode && this.tooltipNode.contains(e.relatedTarget);\n      var container = this.popup && this.popup.container;\n\n      if (el != text && el.parentNode != container && !fromTooltip && el != this.tooltipNode && e.relatedTarget != text) {\n        this.detach();\n      }\n    };\n\n    this.mousedownListener = function (e) {\n      this.detach();\n    };\n\n    this.mousewheelListener = function (e) {\n      this.detach();\n    };\n\n    this.goTo = function (where) {\n      this.popup.goTo(where);\n    };\n\n    this.insertMatch = function (data, options) {\n      if (!data) data = this.popup.getData(this.popup.getRow());\n      if (!data) return false;\n      this.editor.startOperation({\n        command: {\n          name: \"insertMatch\"\n        }\n      });\n\n      if (data.completer && data.completer.insertMatch) {\n        data.completer.insertMatch(this.editor, data);\n      } else {\n        if (this.completions.filterText) {\n          var ranges = this.editor.selection.getAllRanges();\n\n          for (var i = 0, range; range = ranges[i]; i++) {\n            range.start.column -= this.completions.filterText.length;\n            this.editor.session.remove(range);\n          }\n        }\n\n        if (data.snippet) snippetManager.insertSnippet(this.editor, data.snippet);else this.editor.execCommand(\"insertstring\", data.value || data);\n      }\n\n      this.detach();\n      this.editor.endOperation();\n    };\n\n    this.commands = {\n      \"Up\": function (editor) {\n        editor.completer.goTo(\"up\");\n      },\n      \"Down\": function (editor) {\n        editor.completer.goTo(\"down\");\n      },\n      \"Ctrl-Up|Ctrl-Home\": function (editor) {\n        editor.completer.goTo(\"start\");\n      },\n      \"Ctrl-Down|Ctrl-End\": function (editor) {\n        editor.completer.goTo(\"end\");\n      },\n      \"Esc\": function (editor) {\n        editor.completer.detach();\n      },\n      \"Return\": function (editor) {\n        return editor.completer.insertMatch();\n      },\n      \"Shift-Return\": function (editor) {\n        editor.completer.insertMatch(null, {\n          deleteSuffix: true\n        });\n      },\n      \"Tab\": function (editor) {\n        var result = editor.completer.insertMatch();\n        if (!result && !editor.tabstopManager) editor.completer.goTo(\"down\");else return result;\n      },\n      \"PageUp\": function (editor) {\n        editor.completer.popup.gotoPageUp();\n      },\n      \"PageDown\": function (editor) {\n        editor.completer.popup.gotoPageDown();\n      }\n    };\n\n    this.gatherCompletions = function (editor, callback) {\n      var session = editor.getSession();\n      var pos = editor.getCursorPosition();\n      var prefix = util.getCompletionPrefix(editor);\n      this.base = session.doc.createAnchor(pos.row, pos.column - prefix.length);\n      this.base.$insertRight = true;\n      var matches = [];\n      var total = editor.completers.length;\n      editor.completers.forEach(function (completer, i) {\n        completer.getCompletions(editor, session, pos, prefix, function (err, results) {\n          if (!err && results) matches = matches.concat(results);\n          callback(null, {\n            prefix: util.getCompletionPrefix(editor),\n            matches: matches,\n            finished: --total === 0\n          });\n        });\n      });\n      return true;\n    };\n\n    this.showPopup = function (editor, options) {\n      if (this.editor) this.detach();\n      this.activated = true;\n      this.editor = editor;\n\n      if (editor.completer != this) {\n        if (editor.completer) editor.completer.detach();\n        editor.completer = this;\n      }\n\n      editor.on(\"changeSelection\", this.changeListener);\n      editor.on(\"blur\", this.blurListener);\n      editor.on(\"mousedown\", this.mousedownListener);\n      editor.on(\"mousewheel\", this.mousewheelListener);\n      this.updateCompletions(false, options);\n    };\n\n    this.updateCompletions = function (keepPopupPosition, options) {\n      if (keepPopupPosition && this.base && this.completions) {\n        var pos = this.editor.getCursorPosition();\n        var prefix = this.editor.session.getTextRange({\n          start: this.base,\n          end: pos\n        });\n        if (prefix == this.completions.filterText) return;\n        this.completions.setFilter(prefix);\n        if (!this.completions.filtered.length) return this.detach();\n        if (this.completions.filtered.length == 1 && this.completions.filtered[0].value == prefix && !this.completions.filtered[0].snippet) return this.detach();\n        this.openPopup(this.editor, prefix, keepPopupPosition);\n        return;\n      }\n\n      if (options && options.matches) {\n        var pos = this.editor.getSelectionRange().start;\n        this.base = this.editor.session.doc.createAnchor(pos.row, pos.column);\n        this.base.$insertRight = true;\n        this.completions = new FilteredList(options.matches);\n        return this.openPopup(this.editor, \"\", keepPopupPosition);\n      }\n\n      var _id = this.gatherCompletionsId;\n      this.gatherCompletions(this.editor, function (err, results) {\n        var detachIfFinished = function () {\n          if (!results.finished) return;\n          return this.detach();\n        }.bind(this);\n\n        var prefix = results.prefix;\n        var matches = results && results.matches;\n        if (!matches || !matches.length) return detachIfFinished();\n        if (prefix.indexOf(results.prefix) !== 0 || _id != this.gatherCompletionsId) return;\n        this.completions = new FilteredList(matches);\n        if (this.exactMatch) this.completions.exactMatch = true;\n        this.completions.setFilter(prefix);\n        var filtered = this.completions.filtered;\n        if (!filtered.length) return detachIfFinished();\n        if (filtered.length == 1 && filtered[0].value == prefix && !filtered[0].snippet) return detachIfFinished();\n        if (this.autoInsert && filtered.length == 1 && results.finished) return this.insertMatch(filtered[0]);\n        this.openPopup(this.editor, prefix, keepPopupPosition);\n      }.bind(this));\n    };\n\n    this.cancelContextMenu = function () {\n      this.editor.$mouseHandler.cancelContextMenu();\n    };\n\n    this.updateDocTooltip = function () {\n      var popup = this.popup;\n      var all = popup.data;\n      var selected = all && (all[popup.getHoveredRow()] || all[popup.getRow()]);\n      var doc = null;\n      if (!selected || !this.editor || !this.popup.isOpen) return this.hideDocTooltip();\n      this.editor.completers.some(function (completer) {\n        if (completer.getDocTooltip) doc = completer.getDocTooltip(selected);\n        return doc;\n      });\n      if (!doc && typeof selected != \"string\") doc = selected;\n      if (typeof doc == \"string\") doc = {\n        docText: doc\n      };\n      if (!doc || !(doc.docHTML || doc.docText)) return this.hideDocTooltip();\n      this.showDocTooltip(doc);\n    };\n\n    this.showDocTooltip = function (item) {\n      if (!this.tooltipNode) {\n        this.tooltipNode = dom.createElement(\"div\");\n        this.tooltipNode.className = \"ace_tooltip ace_doc-tooltip\";\n        this.tooltipNode.style.margin = 0;\n        this.tooltipNode.style.pointerEvents = \"auto\";\n        this.tooltipNode.tabIndex = -1;\n        this.tooltipNode.onblur = this.blurListener.bind(this);\n        this.tooltipNode.onclick = this.onTooltipClick.bind(this);\n      }\n\n      var tooltipNode = this.tooltipNode;\n\n      if (item.docHTML) {\n        tooltipNode.innerHTML = item.docHTML;\n      } else if (item.docText) {\n        tooltipNode.textContent = item.docText;\n      }\n\n      if (!tooltipNode.parentNode) document.body.appendChild(tooltipNode);\n      var popup = this.popup;\n      var rect = popup.container.getBoundingClientRect();\n      tooltipNode.style.top = popup.container.style.top;\n      tooltipNode.style.bottom = popup.container.style.bottom;\n      tooltipNode.style.display = \"block\";\n\n      if (window.innerWidth - rect.right < 320) {\n        if (rect.left < 320) {\n          if (popup.isTopdown) {\n            tooltipNode.style.top = rect.bottom + \"px\";\n            tooltipNode.style.left = rect.left + \"px\";\n            tooltipNode.style.right = \"\";\n            tooltipNode.style.bottom = \"\";\n          } else {\n            tooltipNode.style.top = popup.container.offsetTop - tooltipNode.offsetHeight + \"px\";\n            tooltipNode.style.left = rect.left + \"px\";\n            tooltipNode.style.right = \"\";\n            tooltipNode.style.bottom = \"\";\n          }\n        } else {\n          tooltipNode.style.right = window.innerWidth - rect.left + \"px\";\n          tooltipNode.style.left = \"\";\n        }\n      } else {\n        tooltipNode.style.left = rect.right + 1 + \"px\";\n        tooltipNode.style.right = \"\";\n      }\n    };\n\n    this.hideDocTooltip = function () {\n      this.tooltipTimer.cancel();\n      if (!this.tooltipNode) return;\n      var el = this.tooltipNode;\n      if (!this.editor.isFocused() && document.activeElement == el) this.editor.focus();\n      this.tooltipNode = null;\n      if (el.parentNode) el.parentNode.removeChild(el);\n    };\n\n    this.onTooltipClick = function (e) {\n      var a = e.target;\n\n      while (a && a != this.tooltipNode) {\n        if (a.nodeName == \"A\" && a.href) {\n          a.rel = \"noreferrer\";\n          a.target = \"_blank\";\n          break;\n        }\n\n        a = a.parentNode;\n      }\n    };\n\n    this.destroy = function () {\n      this.detach();\n\n      if (this.popup) {\n        this.popup.destroy();\n        var el = this.popup.container;\n        if (el && el.parentNode) el.parentNode.removeChild(el);\n      }\n\n      if (this.editor && this.editor.completer == this) this.editor.completer == null;\n      this.popup = null;\n    };\n  }).call(Autocomplete.prototype);\n\n  Autocomplete.for = function (editor) {\n    if (editor.completer) {\n      return editor.completer;\n    }\n\n    if (config.get(\"sharedPopups\")) {\n      if (!Autocomplete.$shared) Autocomplete.$sharedInstance = new Autocomplete();\n      editor.completer = Autocomplete.$sharedInstance;\n    } else {\n      editor.completer = new Autocomplete();\n      editor.once(\"destroy\", function (e, editor) {\n        editor.completer.destroy();\n      });\n    }\n\n    return editor.completer;\n  };\n\n  Autocomplete.startCommand = {\n    name: \"startAutocomplete\",\n    exec: function (editor, options) {\n      var completer = Autocomplete.for(editor);\n      completer.autoInsert = false;\n      completer.autoSelect = true;\n      completer.showPopup(editor, options);\n      completer.cancelContextMenu();\n    },\n    bindKey: \"Ctrl-Space|Ctrl-Shift-Space|Alt-Space\"\n  };\n\n  var FilteredList = function (array, filterText) {\n    this.all = array;\n    this.filtered = array;\n    this.filterText = filterText || \"\";\n    this.exactMatch = false;\n  };\n\n  (function () {\n    this.setFilter = function (str) {\n      if (str.length > this.filterText && str.lastIndexOf(this.filterText, 0) === 0) var matches = this.filtered;else var matches = this.all;\n      this.filterText = str;\n      matches = this.filterCompletions(matches, this.filterText);\n      matches = matches.sort(function (a, b) {\n        return b.exactMatch - a.exactMatch || b.$score - a.$score || (a.caption || a.value).localeCompare(b.caption || b.value);\n      });\n      var prev = null;\n      matches = matches.filter(function (item) {\n        var caption = item.snippet || item.caption || item.value;\n        if (caption === prev) return false;\n        prev = caption;\n        return true;\n      });\n      this.filtered = matches;\n    };\n\n    this.filterCompletions = function (items, needle) {\n      var results = [];\n      var upper = needle.toUpperCase();\n      var lower = needle.toLowerCase();\n\n      loop: for (var i = 0, item; item = items[i]; i++) {\n        var caption = item.caption || item.value || item.snippet;\n        if (!caption) continue;\n        var lastIndex = -1;\n        var matchMask = 0;\n        var penalty = 0;\n        var index, distance;\n\n        if (this.exactMatch) {\n          if (needle !== caption.substr(0, needle.length)) continue loop;\n        } else {\n          var fullMatchIndex = caption.toLowerCase().indexOf(lower);\n\n          if (fullMatchIndex > -1) {\n            penalty = fullMatchIndex;\n          } else {\n            for (var j = 0; j < needle.length; j++) {\n              var i1 = caption.indexOf(lower[j], lastIndex + 1);\n              var i2 = caption.indexOf(upper[j], lastIndex + 1);\n              index = i1 >= 0 ? i2 < 0 || i1 < i2 ? i1 : i2 : i2;\n              if (index < 0) continue loop;\n              distance = index - lastIndex - 1;\n\n              if (distance > 0) {\n                if (lastIndex === -1) penalty += 10;\n                penalty += distance;\n                matchMask = matchMask | 1 << j;\n              }\n\n              lastIndex = index;\n            }\n          }\n        }\n\n        item.matchMask = matchMask;\n        item.exactMatch = penalty ? 0 : 1;\n        item.$score = (item.score || 0) - penalty;\n        results.push(item);\n      }\n\n      return results;\n    };\n  }).call(FilteredList.prototype);\n  exports.Autocomplete = Autocomplete;\n  exports.FilteredList = FilteredList;\n});\nace.define(\"ace/ext/menu_tools/overlay_page\", [\"require\", \"exports\", \"module\", \"ace/lib/dom\"], function (require, exports, module) {\n  'use strict';\n\n  var dom = require(\"../../lib/dom\");\n\n  var cssText = \"#ace_settingsmenu, #kbshortcutmenu {\\\nbackground-color: #F7F7F7;\\\ncolor: black;\\\nbox-shadow: -5px 4px 5px rgba(126, 126, 126, 0.55);\\\npadding: 1em 0.5em 2em 1em;\\\noverflow: auto;\\\nposition: absolute;\\\nmargin: 0;\\\nbottom: 0;\\\nright: 0;\\\ntop: 0;\\\nz-index: 9991;\\\ncursor: default;\\\n}\\\n.ace_dark #ace_settingsmenu, .ace_dark #kbshortcutmenu {\\\nbox-shadow: -20px 10px 25px rgba(126, 126, 126, 0.25);\\\nbackground-color: rgba(255, 255, 255, 0.6);\\\ncolor: black;\\\n}\\\n.ace_optionsMenuEntry:hover {\\\nbackground-color: rgba(100, 100, 100, 0.1);\\\ntransition: all 0.3s\\\n}\\\n.ace_closeButton {\\\nbackground: rgba(245, 146, 146, 0.5);\\\nborder: 1px solid #F48A8A;\\\nborder-radius: 50%;\\\npadding: 7px;\\\nposition: absolute;\\\nright: -8px;\\\ntop: -8px;\\\nz-index: 100000;\\\n}\\\n.ace_closeButton{\\\nbackground: rgba(245, 146, 146, 0.9);\\\n}\\\n.ace_optionsMenuKey {\\\ncolor: darkslateblue;\\\nfont-weight: bold;\\\n}\\\n.ace_optionsMenuCommand {\\\ncolor: darkcyan;\\\nfont-weight: normal;\\\n}\\\n.ace_optionsMenuEntry input, .ace_optionsMenuEntry button {\\\nvertical-align: middle;\\\n}\\\n.ace_optionsMenuEntry button[ace_selected_button=true] {\\\nbackground: #e7e7e7;\\\nbox-shadow: 1px 0px 2px 0px #adadad inset;\\\nborder-color: #adadad;\\\n}\\\n.ace_optionsMenuEntry button {\\\nbackground: white;\\\nborder: 1px solid lightgray;\\\nmargin: 0px;\\\n}\\\n.ace_optionsMenuEntry button:hover{\\\nbackground: #f0f0f0;\\\n}\";\n  dom.importCssString(cssText);\n\n  module.exports.overlayPage = function overlayPage(editor, contentElement, callback) {\n    var closer = document.createElement('div');\n    var ignoreFocusOut = false;\n\n    function documentEscListener(e) {\n      if (e.keyCode === 27) {\n        close();\n      }\n    }\n\n    function close() {\n      if (!closer) return;\n      document.removeEventListener('keydown', documentEscListener);\n      closer.parentNode.removeChild(closer);\n\n      if (editor) {\n        editor.focus();\n      }\n\n      closer = null;\n      callback && callback();\n    }\n\n    function setIgnoreFocusOut(ignore) {\n      ignoreFocusOut = ignore;\n\n      if (ignore) {\n        closer.style.pointerEvents = \"none\";\n        contentElement.style.pointerEvents = \"auto\";\n      }\n    }\n\n    closer.style.cssText = 'margin: 0; padding: 0; ' + 'position: fixed; top:0; bottom:0; left:0; right:0;' + 'z-index: 9990; ' + (editor ? 'background-color: rgba(0, 0, 0, 0.3);' : '');\n    closer.addEventListener('click', function (e) {\n      if (!ignoreFocusOut) {\n        close();\n      }\n    });\n    document.addEventListener('keydown', documentEscListener);\n    contentElement.addEventListener('click', function (e) {\n      e.stopPropagation();\n    });\n    closer.appendChild(contentElement);\n    document.body.appendChild(closer);\n\n    if (editor) {\n      editor.blur();\n    }\n\n    return {\n      close: close,\n      setIgnoreFocusOut: setIgnoreFocusOut\n    };\n  };\n});\nace.define(\"ace/ext/modelist\", [\"require\", \"exports\", \"module\"], function (require, exports, module) {\n  \"use strict\";\n\n  var modes = [];\n\n  function getModeForPath(path) {\n    var mode = modesByName.text;\n    var fileName = path.split(/[\\/\\\\]/).pop();\n\n    for (var i = 0; i < modes.length; i++) {\n      if (modes[i].supportsFile(fileName)) {\n        mode = modes[i];\n        break;\n      }\n    }\n\n    return mode;\n  }\n\n  var Mode = function (name, caption, extensions) {\n    this.name = name;\n    this.caption = caption;\n    this.mode = \"ace/mode/\" + name;\n    this.extensions = extensions;\n    var re;\n\n    if (/\\^/.test(extensions)) {\n      re = extensions.replace(/\\|(\\^)?/g, function (a, b) {\n        return \"$|\" + (b ? \"^\" : \"^.*\\\\.\");\n      }) + \"$\";\n    } else {\n      re = \"^.*\\\\.(\" + extensions + \")$\";\n    }\n\n    this.extRe = new RegExp(re, \"gi\");\n  };\n\n  Mode.prototype.supportsFile = function (filename) {\n    return filename.match(this.extRe);\n  };\n\n  var supportedModes = {\n    ABAP: [\"abap\"],\n    ABC: [\"abc\"],\n    ActionScript: [\"as\"],\n    ADA: [\"ada|adb\"],\n    Alda: [\"alda\"],\n    Apache_Conf: [\"^htaccess|^htgroups|^htpasswd|^conf|htaccess|htgroups|htpasswd\"],\n    Apex: [\"apex|cls|trigger|tgr\"],\n    AQL: [\"aql\"],\n    AsciiDoc: [\"asciidoc|adoc\"],\n    ASL: [\"dsl|asl\"],\n    Assembly_x86: [\"asm|a\"],\n    AutoHotKey: [\"ahk\"],\n    BatchFile: [\"bat|cmd\"],\n    C_Cpp: [\"cpp|c|cc|cxx|h|hh|hpp|ino\"],\n    C9Search: [\"c9search_results\"],\n    Cirru: [\"cirru|cr\"],\n    Clojure: [\"clj|cljs\"],\n    Cobol: [\"CBL|COB\"],\n    coffee: [\"coffee|cf|cson|^Cakefile\"],\n    ColdFusion: [\"cfm\"],\n    Crystal: [\"cr\"],\n    CSharp: [\"cs\"],\n    Csound_Document: [\"csd\"],\n    Csound_Orchestra: [\"orc\"],\n    Csound_Score: [\"sco\"],\n    CSS: [\"css\"],\n    Curly: [\"curly\"],\n    D: [\"d|di\"],\n    Dart: [\"dart\"],\n    Diff: [\"diff|patch\"],\n    Dockerfile: [\"^Dockerfile\"],\n    Dot: [\"dot\"],\n    Drools: [\"drl\"],\n    Edifact: [\"edi\"],\n    Eiffel: [\"e|ge\"],\n    EJS: [\"ejs\"],\n    Elixir: [\"ex|exs\"],\n    Elm: [\"elm\"],\n    Erlang: [\"erl|hrl\"],\n    Forth: [\"frt|fs|ldr|fth|4th\"],\n    Fortran: [\"f|f90\"],\n    FSharp: [\"fsi|fs|ml|mli|fsx|fsscript\"],\n    FSL: [\"fsl\"],\n    FTL: [\"ftl\"],\n    Gcode: [\"gcode\"],\n    Gherkin: [\"feature\"],\n    Gitignore: [\"^.gitignore\"],\n    Glsl: [\"glsl|frag|vert\"],\n    Gobstones: [\"gbs\"],\n    golang: [\"go\"],\n    GraphQLSchema: [\"gql\"],\n    Groovy: [\"groovy\"],\n    HAML: [\"haml\"],\n    Handlebars: [\"hbs|handlebars|tpl|mustache\"],\n    Haskell: [\"hs\"],\n    Haskell_Cabal: [\"cabal\"],\n    haXe: [\"hx\"],\n    Hjson: [\"hjson\"],\n    HTML: [\"html|htm|xhtml|vue|we|wpy\"],\n    HTML_Elixir: [\"eex|html.eex\"],\n    HTML_Ruby: [\"erb|rhtml|html.erb\"],\n    INI: [\"ini|conf|cfg|prefs\"],\n    Io: [\"io\"],\n    Jack: [\"jack\"],\n    Jade: [\"jade|pug\"],\n    Java: [\"java\"],\n    JavaScript: [\"js|jsm|jsx\"],\n    JSON: [\"json\"],\n    JSON5: [\"json5\"],\n    JSONiq: [\"jq\"],\n    JSP: [\"jsp\"],\n    JSSM: [\"jssm|jssm_state\"],\n    JSX: [\"jsx\"],\n    Julia: [\"jl\"],\n    Kotlin: [\"kt|kts\"],\n    LaTeX: [\"tex|latex|ltx|bib\"],\n    LESS: [\"less\"],\n    Liquid: [\"liquid\"],\n    Lisp: [\"lisp\"],\n    LiveScript: [\"ls\"],\n    LogiQL: [\"logic|lql\"],\n    LSL: [\"lsl\"],\n    Lua: [\"lua\"],\n    LuaPage: [\"lp\"],\n    Lucene: [\"lucene\"],\n    Makefile: [\"^Makefile|^GNUmakefile|^makefile|^OCamlMakefile|make\"],\n    Markdown: [\"md|markdown\"],\n    Mask: [\"mask\"],\n    MATLAB: [\"matlab\"],\n    Maze: [\"mz\"],\n    MediaWiki: [\"wiki|mediawiki\"],\n    MEL: [\"mel\"],\n    MIXAL: [\"mixal\"],\n    MUSHCode: [\"mc|mush\"],\n    MySQL: [\"mysql\"],\n    Nginx: [\"nginx|conf\"],\n    Nim: [\"nim\"],\n    Nix: [\"nix\"],\n    NSIS: [\"nsi|nsh\"],\n    Nunjucks: [\"nunjucks|nunjs|nj|njk\"],\n    ObjectiveC: [\"m|mm\"],\n    OCaml: [\"ml|mli\"],\n    Pascal: [\"pas|p\"],\n    Perl: [\"pl|pm\"],\n    Perl6: [\"p6|pl6|pm6\"],\n    pgSQL: [\"pgsql\"],\n    PHP: [\"php|inc|phtml|shtml|php3|php4|php5|phps|phpt|aw|ctp|module\"],\n    PHP_Laravel_blade: [\"blade.php\"],\n    Pig: [\"pig\"],\n    Powershell: [\"ps1\"],\n    Praat: [\"praat|praatscript|psc|proc\"],\n    Prisma: [\"prisma\"],\n    Prolog: [\"plg|prolog\"],\n    Properties: [\"properties\"],\n    Protobuf: [\"proto\"],\n    Puppet: [\"epp|pp\"],\n    Python: [\"py\"],\n    QML: [\"qml\"],\n    R: [\"r\"],\n    Razor: [\"cshtml|asp\"],\n    RDoc: [\"Rd\"],\n    Red: [\"red|reds\"],\n    RHTML: [\"Rhtml\"],\n    RST: [\"rst\"],\n    Ruby: [\"rb|ru|gemspec|rake|^Guardfile|^Rakefile|^Gemfile\"],\n    Rust: [\"rs\"],\n    SASS: [\"sass\"],\n    SCAD: [\"scad\"],\n    Scala: [\"scala|sbt\"],\n    Scheme: [\"scm|sm|rkt|oak|scheme\"],\n    SCSS: [\"scss\"],\n    SH: [\"sh|bash|^.bashrc\"],\n    SJS: [\"sjs\"],\n    Slim: [\"slim|skim\"],\n    Smarty: [\"smarty|tpl\"],\n    snippets: [\"snippets\"],\n    Soy_Template: [\"soy\"],\n    Space: [\"space\"],\n    SQL: [\"sql\"],\n    SQLServer: [\"sqlserver\"],\n    Stylus: [\"styl|stylus\"],\n    SVG: [\"svg\"],\n    Swift: [\"swift\"],\n    Tcl: [\"tcl\"],\n    Terraform: [\"tf\", \"tfvars\", \"terragrunt\"],\n    Tex: [\"tex\"],\n    Text: [\"txt\"],\n    Textile: [\"textile\"],\n    Toml: [\"toml\"],\n    TSX: [\"tsx\"],\n    Twig: [\"latte|twig|swig\"],\n    Typescript: [\"ts|typescript|str\"],\n    Vala: [\"vala\"],\n    VBScript: [\"vbs|vb\"],\n    Velocity: [\"vm\"],\n    Verilog: [\"v|vh|sv|svh\"],\n    VHDL: [\"vhd|vhdl\"],\n    Visualforce: [\"vfp|component|page\"],\n    Wollok: [\"wlk|wpgm|wtest\"],\n    XML: [\"xml|rdf|rss|wsdl|xslt|atom|mathml|mml|xul|xbl|xaml\"],\n    XQuery: [\"xq\"],\n    YAML: [\"yaml|yml\"],\n    Zeek: [\"zeek|bro\"],\n    Django: [\"html\"]\n  };\n  var nameOverrides = {\n    ObjectiveC: \"Objective-C\",\n    CSharp: \"C#\",\n    golang: \"Go\",\n    C_Cpp: \"C and C++\",\n    Csound_Document: \"Csound Document\",\n    Csound_Orchestra: \"Csound\",\n    Csound_Score: \"Csound Score\",\n    coffee: \"CoffeeScript\",\n    HTML_Ruby: \"HTML (Ruby)\",\n    HTML_Elixir: \"HTML (Elixir)\",\n    FTL: \"FreeMarker\",\n    PHP_Laravel_blade: \"PHP (Blade Template)\",\n    Perl6: \"Perl 6\",\n    AutoHotKey: \"AutoHotkey / AutoIt\"\n  };\n  var modesByName = {};\n\n  for (var name in supportedModes) {\n    var data = supportedModes[name];\n    var displayName = (nameOverrides[name] || name).replace(/_/g, \" \");\n    var filename = name.toLowerCase();\n    var mode = new Mode(filename, displayName, data[0]);\n    modesByName[filename] = mode;\n    modes.push(mode);\n  }\n\n  module.exports = {\n    getModeForPath: getModeForPath,\n    modes: modes,\n    modesByName: modesByName\n  };\n});\nace.define(\"ace/ext/prompt\", [\"require\", \"exports\", \"module\", \"ace/range\", \"ace/lib/dom\", \"ace/ext/menu_tools/get_editor_keyboard_shortcuts\", \"ace/autocomplete\", \"ace/autocomplete/popup\", \"ace/autocomplete/popup\", \"ace/undomanager\", \"ace/tokenizer\", \"ace/ext/menu_tools/overlay_page\", \"ace/ext/modelist\"], function (require, exports, module) {\n  \"use strict\";\n\n  var Range = require(\"../range\").Range;\n\n  var dom = require(\"../lib/dom\");\n\n  var shortcuts = require(\"../ext/menu_tools/get_editor_keyboard_shortcuts\");\n\n  var FilteredList = require(\"../autocomplete\").FilteredList;\n\n  var AcePopup = require('../autocomplete/popup').AcePopup;\n\n  var $singleLineEditor = require('../autocomplete/popup').$singleLineEditor;\n\n  var UndoManager = require(\"../undomanager\").UndoManager;\n\n  var Tokenizer = require(\"../tokenizer\").Tokenizer;\n\n  var overlayPage = require(\"./menu_tools/overlay_page\").overlayPage;\n\n  var modelist = require(\"./modelist\");\n\n  var openPrompt;\n\n  function prompt(editor, message, options, callback) {\n    if (typeof message == \"object\") {\n      return prompt(editor, \"\", message, options);\n    }\n\n    if (openPrompt) {\n      var lastPrompt = openPrompt;\n      editor = lastPrompt.editor;\n      lastPrompt.close();\n      if (lastPrompt.name && lastPrompt.name == options.name) return;\n    }\n\n    if (options.$type) return prompt[options.$type](editor, callback);\n    var cmdLine = $singleLineEditor();\n    cmdLine.session.setUndoManager(new UndoManager());\n    var el = dom.buildDom([\"div\", {\n      class: \"ace_prompt_container\" + (options.hasDescription ? \" input-box-with-description\" : \"\")\n    }]);\n    var overlay = overlayPage(editor, el, done);\n    el.appendChild(cmdLine.container);\n\n    if (editor) {\n      editor.cmdLine = cmdLine;\n      cmdLine.setOption(\"fontSize\", editor.getOption(\"fontSize\"));\n    }\n\n    if (message) {\n      cmdLine.setValue(message, 1);\n    }\n\n    if (options.selection) {\n      cmdLine.selection.setRange({\n        start: cmdLine.session.doc.indexToPosition(options.selection[0]),\n        end: cmdLine.session.doc.indexToPosition(options.selection[1])\n      });\n    }\n\n    if (options.getCompletions) {\n      var popup = new AcePopup();\n      popup.renderer.setStyle(\"ace_autocomplete_inline\");\n      popup.container.style.display = \"block\";\n      popup.container.style.maxWidth = \"600px\";\n      popup.container.style.width = \"100%\";\n      popup.container.style.marginTop = \"3px\";\n      popup.renderer.setScrollMargin(2, 2, 0, 0);\n      popup.autoSelect = false;\n      popup.renderer.$maxLines = 15;\n      popup.setRow(-1);\n      popup.on(\"click\", function (e) {\n        var data = popup.getData(popup.getRow());\n\n        if (!data.error) {\n          cmdLine.setValue(data.value || data.name || data);\n          accept();\n          e.stop();\n        }\n      });\n      el.appendChild(popup.container);\n      updateCompletions();\n    }\n\n    if (options.$rules) {\n      var tokenizer = new Tokenizer(options.$rules);\n      cmdLine.session.bgTokenizer.setTokenizer(tokenizer);\n    }\n\n    if (options.placeholder) {\n      cmdLine.setOption(\"placeholder\", options.placeholder);\n    }\n\n    if (options.hasDescription) {\n      var promptTextContainer = dom.buildDom([\"div\", {\n        class: \"ace_prompt_text_container\"\n      }]);\n      dom.buildDom(options.prompt || \"Press 'Enter' to confirm or 'Escape' to cancel\", promptTextContainer);\n      el.appendChild(promptTextContainer);\n    }\n\n    overlay.setIgnoreFocusOut(options.ignoreFocusOut);\n\n    function accept() {\n      var val;\n\n      if (popup && popup.getCursorPosition().row > 0) {\n        val = valueFromRecentList();\n      } else {\n        val = cmdLine.getValue();\n      }\n\n      var curData = popup ? popup.getData(popup.getRow()) : val;\n\n      if (curData && !curData.error) {\n        done();\n        options.onAccept && options.onAccept({\n          value: val,\n          item: curData\n        }, cmdLine);\n      }\n    }\n\n    var keys = {\n      \"Enter\": accept,\n      \"Esc|Shift-Esc\": function () {\n        options.onCancel && options.onCancel(cmdLine.getValue(), cmdLine);\n        done();\n      }\n    };\n\n    if (popup) {\n      Object.assign(keys, {\n        \"Up\": function (editor) {\n          popup.goTo(\"up\");\n          valueFromRecentList();\n        },\n        \"Down\": function (editor) {\n          popup.goTo(\"down\");\n          valueFromRecentList();\n        },\n        \"Ctrl-Up|Ctrl-Home\": function (editor) {\n          popup.goTo(\"start\");\n          valueFromRecentList();\n        },\n        \"Ctrl-Down|Ctrl-End\": function (editor) {\n          popup.goTo(\"end\");\n          valueFromRecentList();\n        },\n        \"Tab\": function (editor) {\n          popup.goTo(\"down\");\n          valueFromRecentList();\n        },\n        \"PageUp\": function (editor) {\n          popup.gotoPageUp();\n          valueFromRecentList();\n        },\n        \"PageDown\": function (editor) {\n          popup.gotoPageDown();\n          valueFromRecentList();\n        }\n      });\n    }\n\n    cmdLine.commands.bindKeys(keys);\n\n    function done() {\n      overlay.close();\n      callback && callback();\n      openPrompt = null;\n    }\n\n    cmdLine.on(\"input\", function () {\n      options.onInput && options.onInput();\n      updateCompletions();\n    });\n\n    function updateCompletions() {\n      if (options.getCompletions) {\n        var prefix;\n\n        if (options.getPrefix) {\n          prefix = options.getPrefix(cmdLine);\n        }\n\n        var completions = options.getCompletions(cmdLine);\n        popup.setData(completions, prefix);\n        popup.resize(true);\n      }\n    }\n\n    function valueFromRecentList() {\n      var current = popup.getData(popup.getRow());\n      if (current && !current.error) return current.value || current.caption || current;\n    }\n\n    cmdLine.resize(true);\n\n    if (popup) {\n      popup.resize(true);\n    }\n\n    cmdLine.focus();\n    openPrompt = {\n      close: done,\n      name: options.name,\n      editor: editor\n    };\n  }\n\n  prompt.gotoLine = function (editor, callback) {\n    function stringifySelection(selection) {\n      if (!Array.isArray(selection)) selection = [selection];\n      return selection.map(function (r) {\n        var cursor = r.isBackwards ? r.start : r.end;\n        var anchor = r.isBackwards ? r.end : r.start;\n        var row = anchor.row;\n        var s = row + 1 + \":\" + anchor.column;\n\n        if (anchor.row == cursor.row) {\n          if (anchor.column != cursor.column) s += \">\" + \":\" + cursor.column;\n        } else {\n          s += \">\" + (cursor.row + 1) + \":\" + cursor.column;\n        }\n\n        return s;\n      }).reverse().join(\", \");\n    }\n\n    prompt(editor, \":\" + stringifySelection(editor.selection.toJSON()), {\n      name: \"gotoLine\",\n      selection: [1, Number.MAX_VALUE],\n      onAccept: function (data) {\n        var value = data.value;\n        var _history = prompt.gotoLine._history;\n        if (!_history) prompt.gotoLine._history = _history = [];\n        if (_history.indexOf(value) != -1) _history.splice(_history.indexOf(value), 1);\n\n        _history.unshift(value);\n\n        if (_history.length > 20) _history.length = 20;\n        var pos = editor.getCursorPosition();\n        var ranges = [];\n        value.replace(/^:/, \"\").split(/,/).map(function (str) {\n          var parts = str.split(/([<>:+-]|c?\\d+)|[^c\\d<>:+-]+/).filter(Boolean);\n          var i = 0;\n\n          function readPosition() {\n            var c = parts[i++];\n            if (!c) return;\n\n            if (c[0] == \"c\") {\n              var index = parseInt(c.slice(1)) || 0;\n              return editor.session.doc.indexToPosition(index);\n            }\n\n            var row = pos.row;\n            var column = 0;\n\n            if (/\\d/.test(c)) {\n              row = parseInt(c) - 1;\n              c = parts[i++];\n            }\n\n            if (c == \":\") {\n              c = parts[i++];\n\n              if (/\\d/.test(c)) {\n                column = parseInt(c) || 0;\n              }\n            }\n\n            return {\n              row: row,\n              column: column\n            };\n          }\n\n          pos = readPosition();\n          var range = Range.fromPoints(pos, pos);\n\n          if (parts[i] == \">\") {\n            i++;\n            range.end = readPosition();\n          } else if (parts[i] == \"<\") {\n            i++;\n            range.start = readPosition();\n          }\n\n          ranges.unshift(range);\n        });\n        editor.selection.fromJSON(ranges);\n        var scrollTop = editor.renderer.scrollTop;\n        editor.renderer.scrollSelectionIntoView(editor.selection.anchor, editor.selection.cursor, 0.5);\n        editor.renderer.animateScrolling(scrollTop);\n      },\n      history: function () {\n        var undoManager = editor.session.getUndoManager();\n        if (!prompt.gotoLine._history) return [];\n        return prompt.gotoLine._history;\n      },\n      getCompletions: function (cmdLine) {\n        var value = cmdLine.getValue();\n        var m = value.replace(/^:/, \"\").split(\":\");\n        var row = Math.min(parseInt(m[0]) || 1, editor.session.getLength()) - 1;\n        var line = editor.session.getLine(row);\n        var current = value + \"  \" + line;\n        return [current].concat(this.history());\n      },\n      $rules: {\n        start: [{\n          regex: /\\d+/,\n          token: \"string\"\n        }, {\n          regex: /[:,><+\\-c]/,\n          token: \"keyword\"\n        }]\n      }\n    });\n  };\n\n  prompt.commands = function (editor, callback) {\n    function normalizeName(name) {\n      return (name || \"\").replace(/^./, function (x) {\n        return x.toUpperCase(x);\n      }).replace(/[a-z][A-Z]/g, function (x) {\n        return x[0] + \" \" + x[1].toLowerCase(x);\n      });\n    }\n\n    function getEditorCommandsByName(excludeCommands) {\n      var commandsByName = [];\n      var commandMap = {};\n      editor.keyBinding.$handlers.forEach(function (handler) {\n        var platform = handler.platform;\n        var cbn = handler.byName;\n\n        for (var i in cbn) {\n          var key;\n\n          if (cbn[i].bindKey && cbn[i].bindKey[platform] !== null) {\n            key = cbn[i].bindKey[\"win\"];\n          } else {\n            key = \"\";\n          }\n\n          var commands = cbn[i];\n          var description = commands.description || normalizeName(commands.name);\n          if (!Array.isArray(commands)) commands = [commands];\n          commands.forEach(function (command) {\n            if (typeof command != \"string\") command = command.name;\n            var needle = excludeCommands.find(function (el) {\n              return el === command;\n            });\n\n            if (!needle) {\n              if (commandMap[command]) {\n                commandMap[command].key += \"|\" + key;\n              } else {\n                commandMap[command] = {\n                  key: key,\n                  command: command,\n                  description: description\n                };\n                commandsByName.push(commandMap[command]);\n              }\n            }\n          });\n        }\n      });\n      return commandsByName;\n    }\n\n    var excludeCommandsList = [\"insertstring\", \"inserttext\", \"setIndentation\", \"paste\"];\n    var shortcutsArray = getEditorCommandsByName(excludeCommandsList);\n    shortcutsArray = shortcutsArray.map(function (item) {\n      return {\n        value: item.description,\n        meta: item.key,\n        command: item.command\n      };\n    });\n    prompt(editor, \"\", {\n      name: \"commands\",\n      selection: [0, Number.MAX_VALUE],\n      maxHistoryCount: 5,\n      onAccept: function (data) {\n        if (data.item) {\n          var commandName = data.item.command;\n          this.addToHistory(data.item);\n          editor.execCommand(commandName);\n        }\n      },\n      addToHistory: function (item) {\n        var history = this.history();\n        history.unshift(item);\n        delete item.message;\n\n        for (var i = 1; i < history.length; i++) {\n          if (history[i][\"command\"] == item.command) {\n            history.splice(i, 1);\n            break;\n          }\n        }\n\n        if (this.maxHistoryCount > 0 && history.length > this.maxHistoryCount) {\n          history.splice(history.length - 1, 1);\n        }\n\n        prompt.commands.history = history;\n      },\n      history: function () {\n        return prompt.commands.history || [];\n      },\n      getPrefix: function (cmdLine) {\n        var currentPos = cmdLine.getCursorPosition();\n        var filterValue = cmdLine.getValue();\n        return filterValue.substring(0, currentPos.column);\n      },\n      getCompletions: function (cmdLine) {\n        function getFilteredCompletions(commands, prefix) {\n          var resultCommands = JSON.parse(JSON.stringify(commands));\n          var filtered = new FilteredList(resultCommands);\n          return filtered.filterCompletions(resultCommands, prefix);\n        }\n\n        function getUniqueCommandList(commands, usedCommands) {\n          if (!usedCommands || !usedCommands.length) {\n            return commands;\n          }\n\n          var excludeCommands = [];\n          usedCommands.forEach(function (item) {\n            excludeCommands.push(item.command);\n          });\n          var resultCommands = [];\n          commands.forEach(function (item) {\n            if (excludeCommands.indexOf(item.command) === -1) {\n              resultCommands.push(item);\n            }\n          });\n          return resultCommands;\n        }\n\n        var prefix = this.getPrefix(cmdLine);\n        var recentlyUsedCommands = getFilteredCompletions(this.history(), prefix);\n        var otherCommands = getUniqueCommandList(shortcutsArray, recentlyUsedCommands);\n        otherCommands = getFilteredCompletions(otherCommands, prefix);\n\n        if (recentlyUsedCommands.length && otherCommands.length) {\n          recentlyUsedCommands[0][\"message\"] = \" Recently used\";\n          otherCommands[0][\"message\"] = \" Other commands\";\n        }\n\n        var completions = recentlyUsedCommands.concat(otherCommands);\n        return completions.length > 0 ? completions : [{\n          value: \"No matching commands\",\n          error: 1\n        }];\n      }\n    });\n  };\n\n  prompt.modes = function (editor, callback) {\n    var modesArray = modelist.modes;\n    modesArray = modesArray.map(function (item) {\n      return {\n        value: item.caption,\n        mode: item.name\n      };\n    });\n    prompt(editor, \"\", {\n      name: \"modes\",\n      selection: [0, Number.MAX_VALUE],\n      onAccept: function (data) {\n        if (data.item) {\n          var modeName = \"ace/mode/\" + data.item.mode;\n          editor.session.setMode(modeName);\n        }\n      },\n      getPrefix: function (cmdLine) {\n        var currentPos = cmdLine.getCursorPosition();\n        var filterValue = cmdLine.getValue();\n        return filterValue.substring(0, currentPos.column);\n      },\n      getCompletions: function (cmdLine) {\n        function getFilteredCompletions(modes, prefix) {\n          var resultCommands = JSON.parse(JSON.stringify(modes));\n          var filtered = new FilteredList(resultCommands);\n          return filtered.filterCompletions(resultCommands, prefix);\n        }\n\n        var prefix = this.getPrefix(cmdLine);\n        var completions = getFilteredCompletions(modesArray, prefix);\n        return completions.length > 0 ? completions : [{\n          \"caption\": \"No mode matching\",\n          \"value\": \"No mode matching\",\n          \"error\": 1\n        }];\n      }\n    });\n  };\n\n  dom.importCssString(\".ace_prompt_container {\\\n    max-width: 600px;\\\n    width: 100%;\\\n    margin: 20px auto;\\\n    padding: 3px;\\\n    background: white;\\\n    border-radius: 2px;\\\n    box-shadow: 0px 2px 3px 0px #555;\\\n}\");\n  exports.prompt = prompt;\n});\n\n(function () {\n  ace.require([\"ace/ext/prompt\"], function (m) {\n    if (typeof module == \"object\" && typeof exports == \"object\" && module) {\n      module.exports = m;\n    }\n  });\n})();","map":{"version":3,"sources":["/home/magoo/projects/keyrier-json/node_modules/ace-builds/src-noconflict/ext-prompt.js"],"names":["ace","define","require","exports","module","keys","getEditorKeybordShortcuts","editor","KEY_MODS","keybindings","commandMap","keyBinding","$handlers","forEach","handler","ckb","commandKeyBinding","i","key","replace","x","toUpperCase","commands","Array","isArray","command","name","push","Renderer","VirtualRenderer","Editor","Range","event","lang","dom","$singleLineEditor","el","renderer","$maxLines","setHighlightActiveLine","setShowPrintMargin","setShowGutter","setHighlightGutterLine","$mouseHandler","$focusTimeout","$highlightTagPending","AcePopup","parentNode","createElement","popup","appendChild","style","display","content","cursor","setStyle","setOption","noop","focus","$isFocused","$cursorLayer","restartTimer","element","opacity","$keepTextAreaAtCursor","session","highlight","$searchHighlight","clazz","on","e","pos","getDocumentPosition","selection","moveToPosition","selectionMarker","start","row","end","stop","lastMouseEvent","hoverMarker","Infinity","id","addMarker","setSelectOnHover","val","removeMarker","y","scrollTop","setRow","setHoverMarker","$pos","getRow","t","$textLayer","selected","childNodes","config","firstRow","selectedNode","removeCssClass","addCssClass","hideHoverMarker","suppressRedraw","_emit","getHoveredRow","addListener","container","doc","getLength","data","length","getLine","value","bgTokenizer","$tokenizeRow","tokens","caption","addToken","className","type","lower","toLowerCase","filterText","lastIndex","lastI","matchMask","sub","slice","index","indexOf","meta","message","$updateOnChange","$computeWidth","screenWidth","isOpen","isTopdown","autoSelect","setData","list","setValue","stringRepeat","getData","line","Math","max","min","clearSelection","moveCursorTo","_signal","lead","scrollCursorIntoView","hide","show","lineHeight","topdownOnly","screenHeight","window","innerHeight","innerWidth","maxH","top","$borderSize","allowTopdown","$maxPixelHeight","bottom","left","offsetWidth","goTo","where","getTextLeftOffset","$padding","$imageSize","importCssString","parForEach","array","fn","callback","completed","arLength","result","err","ID_REGEX","retrievePrecedingIdentifier","text","regex","buf","test","reverse","join","retrieveFollowingIdentifier","getCompletionPrefix","getCursorPosition","prefix","completers","completer","identifierRegexps","identifierRegex","column","bind","oop","EventEmitter","RangeList","HashHandler","Tokenizer","clipboard","VARIABLES","CURRENT_WORD","getTextRange","getWordRange","SELECTION","indentation","CURRENT_LINE","PREV_LINE","LINE_INDEX","LINE_NUMBER","SOFT_TABS","getUseSoftTabs","TAB_SIZE","getTabSize","CLIPBOARD","getText","FILENAME","exec","FILEPATH","FILENAME_BASE","DIRECTORY","WORKSPACE_NAME","FULLNAME","BLOCK_COMMENT_START","mode","$mode","blockComment","BLOCK_COMMENT_END","LINE_COMMENT","lineCommentStart","CURRENT_YEAR","date","year","CURRENT_YEAR_SHORT","CURRENT_MONTH","month","CURRENT_MONTH_NAME","CURRENT_MONTH_NAME_SHORT","CURRENT_DATE","day","CURRENT_DAY_NAME","weekday","CURRENT_DAY_NAME_SHORT","CURRENT_HOUR","hour","hour12","CURRENT_MINUTE","minute","CURRENT_SECOND","second","SELECTED_TEXT","dateFormat","str","Date","toLocaleString","SnippetManager","snippetMap","snippetNameMap","implement","getTokenizer","$tokenizer","createTokenizer","TabstopToken","substr","tabstopId","parseInt","escape","ch","formatMatcher","onMatch","state","stack","ts","fmtString","guard","flag","next","shift","unshift","token","merge","snippetVar","choices","operator","split","formatString","expectElse","ifEnd","elseEnd","changeCase","local","formatStringVar","formatFunction","tokenizeTmSnippet","startState","getLineTokens","map","getVariableValue","variables","__","hasOwnProperty","tmStrFormat","fmt","re","RegExp","fmtTokens","_self","formatted","oldArgs","call","arguments","fmtParts","resolveVariables","gChangeCase","tmFormatFunction","snippet","afterNewLine","j","gotoNext","i1","insertSnippetForSelection","snippetText","tabString","getTabString","indentString","match","tabstops","p","parents","isNested","some","expanding","copyValue","copy","lastIndexOf","Object","parentId","splice","apply","concat","lines","range","getSelectionRange","tabstopManager","TabstopManager","selectionId","inVirtualSelectionMode","addTabstops","insertSnippet","self","forEachSelection","keepOrder","tabNext","$getScope","scope","$id","pop","inlinePhp","c","getState","substring","getActiveScopes","scopes","includeScopes","expandWithTab","options","expandSnippetForSelection","before","after","snippets","findMatchingSnippet","dryRun","removeInLine","replaceBefore","replaceAfter","M__","matchBefore","T__","matchAfter","snippetList","s","startRe","endRe","triggerRe","endTriggerRe","register","wrapRegexp","src","guardedRegexp","opening","addSnippet","old","unregister","tabTrigger","body","trigger","escapeRegExp","endTrigger","endGuard","removeSnippet","nameMap","parseSnippetFile","m","JSON","parse","guardRe","getSnippetByName","prototype","$onChange","onChange","$onChangeSelection","delayedCall","onChangeSelection","schedule","$onChangeSession","onChangeSession","$onAfterExec","onAfterExec","attach","ranges","$openTabstops","selectedTabstop","addKeyboardHandler","keyboardHandler","detach","removeTabstopMarkers","removeListener","removeKeyboardHandler","delta","isRemove","action","active","rangeList","$bias","parentActive","startIndex","pointIndex","endIndex","toRemove","removeRange","$inChange","getValue","updateLinkedFields","hasLinkedRanges","firstNonLinked","linked","original","snippetManager","readOnly","anchor","isEmpty","containsLead","contains","containsAnchor","dir","selectTabstop","addTabstopMarkers","sel","multiSelect","toSingleRange","clone","addRange","setRange","execCommand","matches","useLink","getOption","fromPoints","moveRelative","arg","dest","movePoint","tabstop","addList","markerId","bindKeys","point","diff","expandSnippet","util","Autocomplete","autoInsert","exactMatch","gatherCompletionsId","blurListener","changeListener","mousedownListener","mousewheelListener","changeTimer","updateCompletions","tooltipTimer","updateDocTooltip","$init","document","documentElement","insertMatch","getPopup","openPopup","keepPopupPosition","completions","filtered","setTheme","getTheme","setFontSize","getFontSize","layerConfig","getPixelPosition","base","rect","getBoundingClientRect","offset","scrollLeft","gutterWidth","off","cancel","hideDocTooltip","activated","activeElement","textInput","getElement","fromTooltip","relatedTarget","tooltipNode","startOperation","getAllRanges","remove","endOperation","deleteSuffix","gotoPageUp","gotoPageDown","gatherCompletions","getSession","createAnchor","$insertRight","total","getCompletions","results","finished","showPopup","setFilter","FilteredList","_id","detachIfFinished","cancelContextMenu","all","getDocTooltip","docText","docHTML","showDocTooltip","item","margin","pointerEvents","tabIndex","onblur","onclick","onTooltipClick","innerHTML","textContent","right","offsetTop","offsetHeight","isFocused","removeChild","a","target","nodeName","href","rel","destroy","for","get","$shared","$sharedInstance","once","startCommand","bindKey","filterCompletions","sort","b","$score","localeCompare","prev","filter","items","needle","upper","loop","penalty","distance","fullMatchIndex","i2","score","cssText","overlayPage","contentElement","closer","ignoreFocusOut","documentEscListener","keyCode","close","removeEventListener","setIgnoreFocusOut","ignore","addEventListener","stopPropagation","blur","modes","getModeForPath","path","modesByName","fileName","supportsFile","Mode","extensions","extRe","filename","supportedModes","ABAP","ABC","ActionScript","ADA","Alda","Apache_Conf","Apex","AQL","AsciiDoc","ASL","Assembly_x86","AutoHotKey","BatchFile","C_Cpp","C9Search","Cirru","Clojure","Cobol","coffee","ColdFusion","Crystal","CSharp","Csound_Document","Csound_Orchestra","Csound_Score","CSS","Curly","D","Dart","Diff","Dockerfile","Dot","Drools","Edifact","Eiffel","EJS","Elixir","Elm","Erlang","Forth","Fortran","FSharp","FSL","FTL","Gcode","Gherkin","Gitignore","Glsl","Gobstones","golang","GraphQLSchema","Groovy","HAML","Handlebars","Haskell","Haskell_Cabal","haXe","Hjson","HTML","HTML_Elixir","HTML_Ruby","INI","Io","Jack","Jade","Java","JavaScript","JSON5","JSONiq","JSP","JSSM","JSX","Julia","Kotlin","LaTeX","LESS","Liquid","Lisp","LiveScript","LogiQL","LSL","Lua","LuaPage","Lucene","Makefile","Markdown","Mask","MATLAB","Maze","MediaWiki","MEL","MIXAL","MUSHCode","MySQL","Nginx","Nim","Nix","NSIS","Nunjucks","ObjectiveC","OCaml","Pascal","Perl","Perl6","pgSQL","PHP","PHP_Laravel_blade","Pig","Powershell","Praat","Prisma","Prolog","Properties","Protobuf","Puppet","Python","QML","R","Razor","RDoc","Red","RHTML","RST","Ruby","Rust","SASS","SCAD","Scala","Scheme","SCSS","SH","SJS","Slim","Smarty","Soy_Template","Space","SQL","SQLServer","Stylus","SVG","Swift","Tcl","Terraform","Tex","Text","Textile","Toml","TSX","Twig","Typescript","Vala","VBScript","Velocity","Verilog","VHDL","Visualforce","Wollok","XML","XQuery","YAML","Zeek","Django","nameOverrides","displayName","shortcuts","UndoManager","modelist","openPrompt","prompt","lastPrompt","$type","cmdLine","setUndoManager","buildDom","class","hasDescription","overlay","done","indexToPosition","maxWidth","width","marginTop","setScrollMargin","error","accept","$rules","tokenizer","setTokenizer","placeholder","promptTextContainer","valueFromRecentList","curData","onAccept","onCancel","assign","onInput","getPrefix","resize","current","gotoLine","stringifySelection","r","isBackwards","toJSON","Number","MAX_VALUE","_history","parts","Boolean","readPosition","fromJSON","scrollSelectionIntoView","animateScrolling","history","undoManager","getUndoManager","normalizeName","getEditorCommandsByName","excludeCommands","commandsByName","platform","cbn","byName","description","find","excludeCommandsList","shortcutsArray","maxHistoryCount","commandName","addToHistory","currentPos","filterValue","getFilteredCompletions","resultCommands","stringify","getUniqueCommandList","usedCommands","recentlyUsedCommands","otherCommands","modesArray","modeName","setMode"],"mappings":"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","sourcesContent":["ace.define(\"ace/ext/menu_tools/get_editor_keyboard_shortcuts\",[\"require\",\"exports\",\"module\",\"ace/lib/keys\"], function(require, exports, module) {\n\"use strict\";\nvar keys = require(\"../../lib/keys\");\nmodule.exports.getEditorKeybordShortcuts = function(editor) {\n    var KEY_MODS = keys.KEY_MODS;\n    var keybindings = [];\n    var commandMap = {};\n    editor.keyBinding.$handlers.forEach(function(handler) {\n        var ckb = handler.commandKeyBinding;\n        for (var i in ckb) {\n            var key = i.replace(/(^|-)\\w/g, function(x) { return x.toUpperCase(); });\n            var commands = ckb[i];\n            if (!Array.isArray(commands))\n                commands = [commands];\n            commands.forEach(function(command) {\n                if (typeof command != \"string\")\n                    command  = command.name;\n                if (commandMap[command]) {\n                    commandMap[command].key += \"|\" + key;\n                } else {\n                    commandMap[command] = {key: key, command: command};\n                    keybindings.push(commandMap[command]);\n                }         \n            });\n        }\n    });\n    return keybindings;\n};\n\n});\n\nace.define(\"ace/autocomplete/popup\",[\"require\",\"exports\",\"module\",\"ace/virtual_renderer\",\"ace/editor\",\"ace/range\",\"ace/lib/event\",\"ace/lib/lang\",\"ace/lib/dom\"], function(require, exports, module) {\n\"use strict\";\n\nvar Renderer = require(\"../virtual_renderer\").VirtualRenderer;\nvar Editor = require(\"../editor\").Editor;\nvar Range = require(\"../range\").Range;\nvar event = require(\"../lib/event\");\nvar lang = require(\"../lib/lang\");\nvar dom = require(\"../lib/dom\");\n\nvar $singleLineEditor = function(el) {\n    var renderer = new Renderer(el);\n\n    renderer.$maxLines = 4;\n\n    var editor = new Editor(renderer);\n\n    editor.setHighlightActiveLine(false);\n    editor.setShowPrintMargin(false);\n    editor.renderer.setShowGutter(false);\n    editor.renderer.setHighlightGutterLine(false);\n\n    editor.$mouseHandler.$focusTimeout = 0;\n    editor.$highlightTagPending = true;\n\n    return editor;\n};\n\nvar AcePopup = function(parentNode) {\n    var el = dom.createElement(\"div\");\n    var popup = new $singleLineEditor(el);\n\n    if (parentNode)\n        parentNode.appendChild(el);\n    el.style.display = \"none\";\n    popup.renderer.content.style.cursor = \"default\";\n    popup.renderer.setStyle(\"ace_autocomplete\");\n\n    popup.setOption(\"displayIndentGuides\", false);\n    popup.setOption(\"dragDelay\", 150);\n\n    var noop = function(){};\n\n    popup.focus = noop;\n    popup.$isFocused = true;\n\n    popup.renderer.$cursorLayer.restartTimer = noop;\n    popup.renderer.$cursorLayer.element.style.opacity = 0;\n\n    popup.renderer.$maxLines = 8;\n    popup.renderer.$keepTextAreaAtCursor = false;\n\n    popup.setHighlightActiveLine(false);\n    popup.session.highlight(\"\");\n    popup.session.$searchHighlight.clazz = \"ace_highlight-marker\";\n\n    popup.on(\"mousedown\", function(e) {\n        var pos = e.getDocumentPosition();\n        popup.selection.moveToPosition(pos);\n        selectionMarker.start.row = selectionMarker.end.row = pos.row;\n        e.stop();\n    });\n\n    var lastMouseEvent;\n    var hoverMarker = new Range(-1,0,-1,Infinity);\n    var selectionMarker = new Range(-1,0,-1,Infinity);\n    selectionMarker.id = popup.session.addMarker(selectionMarker, \"ace_active-line\", \"fullLine\");\n    popup.setSelectOnHover = function(val) {\n        if (!val) {\n            hoverMarker.id = popup.session.addMarker(hoverMarker, \"ace_line-hover\", \"fullLine\");\n        } else if (hoverMarker.id) {\n            popup.session.removeMarker(hoverMarker.id);\n            hoverMarker.id = null;\n        }\n    };\n    popup.setSelectOnHover(false);\n    popup.on(\"mousemove\", function(e) {\n        if (!lastMouseEvent) {\n            lastMouseEvent = e;\n            return;\n        }\n        if (lastMouseEvent.x == e.x && lastMouseEvent.y == e.y) {\n            return;\n        }\n        lastMouseEvent = e;\n        lastMouseEvent.scrollTop = popup.renderer.scrollTop;\n        var row = lastMouseEvent.getDocumentPosition().row;\n        if (hoverMarker.start.row != row) {\n            if (!hoverMarker.id)\n                popup.setRow(row);\n            setHoverMarker(row);\n        }\n    });\n    popup.renderer.on(\"beforeRender\", function() {\n        if (lastMouseEvent && hoverMarker.start.row != -1) {\n            lastMouseEvent.$pos = null;\n            var row = lastMouseEvent.getDocumentPosition().row;\n            if (!hoverMarker.id)\n                popup.setRow(row);\n            setHoverMarker(row, true);\n        }\n    });\n    popup.renderer.on(\"afterRender\", function() {\n        var row = popup.getRow();\n        var t = popup.renderer.$textLayer;\n        var selected = t.element.childNodes[row - t.config.firstRow];\n        if (selected !== t.selectedNode && t.selectedNode)\n            dom.removeCssClass(t.selectedNode, \"ace_selected\");\n        t.selectedNode = selected;\n        if (selected)\n            dom.addCssClass(selected, \"ace_selected\");\n    });\n    var hideHoverMarker = function() { setHoverMarker(-1); };\n    var setHoverMarker = function(row, suppressRedraw) {\n        if (row !== hoverMarker.start.row) {\n            hoverMarker.start.row = hoverMarker.end.row = row;\n            if (!suppressRedraw)\n                popup.session._emit(\"changeBackMarker\");\n            popup._emit(\"changeHoverMarker\");\n        }\n    };\n    popup.getHoveredRow = function() {\n        return hoverMarker.start.row;\n    };\n\n    event.addListener(popup.container, \"mouseout\", hideHoverMarker);\n    popup.on(\"hide\", hideHoverMarker);\n    popup.on(\"changeSelection\", hideHoverMarker);\n\n    popup.session.doc.getLength = function() {\n        return popup.data.length;\n    };\n    popup.session.doc.getLine = function(i) {\n        var data = popup.data[i];\n        if (typeof data == \"string\")\n            return data;\n        return (data && data.value) || \"\";\n    };\n\n    var bgTokenizer = popup.session.bgTokenizer;\n    bgTokenizer.$tokenizeRow = function(row) {\n        var data = popup.data[row];\n        var tokens = [];\n        if (!data)\n            return tokens;\n        if (typeof data == \"string\")\n            data = {value: data};\n        var caption = data.caption || data.value || data.name;\n\n        function addToken(value, className) {\n            value && tokens.push({\n                type: (data.className || \"\") + (className || \"\"), \n                value: value\n            });\n        }\n        \n        var lower = caption.toLowerCase();\n        var filterText = (popup.filterText || \"\").toLowerCase();\n        var lastIndex = 0;\n        var lastI = 0;\n        for (var i = 0; i <= filterText.length; i++) {\n            if (i != lastI && (data.matchMask & (1 << i) || i == filterText.length)) {\n                var sub = filterText.slice(lastI, i);\n                lastI = i;\n                var index = lower.indexOf(sub, lastIndex);\n                if (index == -1) continue;\n                addToken(caption.slice(lastIndex, index), \"\");\n                lastIndex = index + sub.length;\n                addToken(caption.slice(index, lastIndex), \"completion-highlight\");\n            }\n        }\n        addToken(caption.slice(lastIndex, caption.length), \"\");\n        \n        if (data.meta)\n            tokens.push({type: \"completion-meta\", value: data.meta});\n        if (data.message)\n            tokens.push({type: \"completion-message\", value: data.message});\n\n        return tokens;\n    };\n    bgTokenizer.$updateOnChange = noop;\n    bgTokenizer.start = noop;\n\n    popup.session.$computeWidth = function() {\n        return this.screenWidth = 0;\n    };\n    popup.isOpen = false;\n    popup.isTopdown = false;\n    popup.autoSelect = true;\n    popup.filterText = \"\";\n\n    popup.data = [];\n    popup.setData = function(list, filterText) {\n        popup.filterText = filterText || \"\";\n        popup.setValue(lang.stringRepeat(\"\\n\", list.length), -1);\n        popup.data = list || [];\n        popup.setRow(0);\n    };\n    popup.getData = function(row) {\n        return popup.data[row];\n    };\n\n    popup.getRow = function() {\n        return selectionMarker.start.row;\n    };\n    popup.setRow = function(line) {\n        line = Math.max(this.autoSelect ? 0 : -1, Math.min(this.data.length, line));\n        if (selectionMarker.start.row != line) {\n            popup.selection.clearSelection();\n            selectionMarker.start.row = selectionMarker.end.row = line || 0;\n            popup.session._emit(\"changeBackMarker\");\n            popup.moveCursorTo(line || 0, 0);\n            if (popup.isOpen)\n                popup._signal(\"select\");\n        }\n    };\n\n    popup.on(\"changeSelection\", function() {\n        if (popup.isOpen)\n            popup.setRow(popup.selection.lead.row);\n        popup.renderer.scrollCursorIntoView();\n    });\n\n    popup.hide = function() {\n        this.container.style.display = \"none\";\n        this._signal(\"hide\");\n        popup.isOpen = false;\n    };\n    popup.show = function(pos, lineHeight, topdownOnly) {\n        var el = this.container;\n        var screenHeight = window.innerHeight;\n        var screenWidth = window.innerWidth;\n        var renderer = this.renderer;\n        var maxH = renderer.$maxLines * lineHeight * 1.4;\n        var top = pos.top + this.$borderSize;\n        var allowTopdown = top > screenHeight / 2 && !topdownOnly;\n        if (allowTopdown && top + lineHeight + maxH > screenHeight) {\n            renderer.$maxPixelHeight = top - 2 * this.$borderSize;\n            el.style.top = \"\";\n            el.style.bottom = screenHeight - top + \"px\";\n            popup.isTopdown = false;\n        } else {\n            top += lineHeight;\n            renderer.$maxPixelHeight = screenHeight - top - 0.2 * lineHeight;\n            el.style.top = top + \"px\";\n            el.style.bottom = \"\";\n            popup.isTopdown = true;\n        }\n\n        el.style.display = \"\";\n\n        var left = pos.left;\n        if (left + el.offsetWidth > screenWidth)\n            left = screenWidth - el.offsetWidth;\n\n        el.style.left = left + \"px\";\n\n        this._signal(\"show\");\n        lastMouseEvent = null;\n        popup.isOpen = true;\n    };\n\n    popup.goTo = function(where) {\n        var row = this.getRow();\n        var max = this.session.getLength() - 1;\n\n        switch(where) {\n            case \"up\": row = row <= 0 ? max : row - 1; break;\n            case \"down\": row = row >= max ? -1 : row + 1; break;\n            case \"start\": row = 0; break;\n            case \"end\": row = max; break;\n        }\n\n        this.setRow(row);\n    };\n\n\n    popup.getTextLeftOffset = function() {\n        return this.$borderSize + this.renderer.$padding + this.$imageSize;\n    };\n\n    popup.$imageSize = 0;\n    popup.$borderSize = 1;\n\n    return popup;\n};\n\ndom.importCssString(\"\\\n.ace_editor.ace_autocomplete .ace_marker-layer .ace_active-line {\\\n    background-color: #CAD6FA;\\\n    z-index: 1;\\\n}\\\n.ace_dark.ace_editor.ace_autocomplete .ace_marker-layer .ace_active-line {\\\n    background-color: #3a674e;\\\n}\\\n.ace_editor.ace_autocomplete .ace_line-hover {\\\n    border: 1px solid #abbffe;\\\n    margin-top: -1px;\\\n    background: rgba(233,233,253,0.4);\\\n    position: absolute;\\\n    z-index: 2;\\\n}\\\n.ace_dark.ace_editor.ace_autocomplete .ace_line-hover {\\\n    border: 1px solid rgba(109, 150, 13, 0.8);\\\n    background: rgba(58, 103, 78, 0.62);\\\n}\\\n.ace_completion-meta {\\\n    opacity: 0.5;\\\n    margin: 0.9em;\\\n}\\\n.ace_completion-message {\\\n    color: blue;\\\n}\\\n.ace_editor.ace_autocomplete .ace_completion-highlight{\\\n    color: #2d69c7;\\\n}\\\n.ace_dark.ace_editor.ace_autocomplete .ace_completion-highlight{\\\n    color: #93ca12;\\\n}\\\n.ace_editor.ace_autocomplete {\\\n    width: 300px;\\\n    z-index: 200000;\\\n    border: 1px lightgray solid;\\\n    position: fixed;\\\n    box-shadow: 2px 3px 5px rgba(0,0,0,.2);\\\n    line-height: 1.4;\\\n    background: #fefefe;\\\n    color: #111;\\\n}\\\n.ace_dark.ace_editor.ace_autocomplete {\\\n    border: 1px #484747 solid;\\\n    box-shadow: 2px 3px 5px rgba(0, 0, 0, 0.51);\\\n    line-height: 1.4;\\\n    background: #25282c;\\\n    color: #c1c1c1;\\\n}\", \"autocompletion.css\");\n\nexports.AcePopup = AcePopup;\nexports.$singleLineEditor = $singleLineEditor;\n});\n\nace.define(\"ace/autocomplete/util\",[\"require\",\"exports\",\"module\"], function(require, exports, module) {\n\"use strict\";\n\nexports.parForEach = function(array, fn, callback) {\n    var completed = 0;\n    var arLength = array.length;\n    if (arLength === 0)\n        callback();\n    for (var i = 0; i < arLength; i++) {\n        fn(array[i], function(result, err) {\n            completed++;\n            if (completed === arLength)\n                callback(result, err);\n        });\n    }\n};\n\nvar ID_REGEX = /[a-zA-Z_0-9\\$\\-\\u00A2-\\u2000\\u2070-\\uFFFF]/;\n\nexports.retrievePrecedingIdentifier = function(text, pos, regex) {\n    regex = regex || ID_REGEX;\n    var buf = [];\n    for (var i = pos-1; i >= 0; i--) {\n        if (regex.test(text[i]))\n            buf.push(text[i]);\n        else\n            break;\n    }\n    return buf.reverse().join(\"\");\n};\n\nexports.retrieveFollowingIdentifier = function(text, pos, regex) {\n    regex = regex || ID_REGEX;\n    var buf = [];\n    for (var i = pos; i < text.length; i++) {\n        if (regex.test(text[i]))\n            buf.push(text[i]);\n        else\n            break;\n    }\n    return buf;\n};\n\nexports.getCompletionPrefix = function (editor) {\n    var pos = editor.getCursorPosition();\n    var line = editor.session.getLine(pos.row);\n    var prefix;\n    editor.completers.forEach(function(completer) {\n        if (completer.identifierRegexps) {\n            completer.identifierRegexps.forEach(function(identifierRegex) {\n                if (!prefix && identifierRegex)\n                    prefix = this.retrievePrecedingIdentifier(line, pos.column, identifierRegex);\n            }.bind(this));\n        }\n    }.bind(this));\n    return prefix || this.retrievePrecedingIdentifier(line, pos.column);\n};\n\n});\n\nace.define(\"ace/snippets\",[\"require\",\"exports\",\"module\",\"ace/lib/oop\",\"ace/lib/event_emitter\",\"ace/lib/lang\",\"ace/range\",\"ace/range_list\",\"ace/keyboard/hash_handler\",\"ace/tokenizer\",\"ace/clipboard\",\"ace/lib/dom\",\"ace/editor\"], function(require, exports, module) {\n\"use strict\";\nvar oop = require(\"./lib/oop\");\nvar EventEmitter = require(\"./lib/event_emitter\").EventEmitter;\nvar lang = require(\"./lib/lang\");\nvar Range = require(\"./range\").Range;\nvar RangeList = require(\"./range_list\").RangeList;\nvar HashHandler = require(\"./keyboard/hash_handler\").HashHandler;\nvar Tokenizer = require(\"./tokenizer\").Tokenizer;\nvar clipboard = require(\"./clipboard\");\n\nvar VARIABLES = {\n    CURRENT_WORD: function(editor) {\n        return editor.session.getTextRange(editor.session.getWordRange());\n    },\n    SELECTION: function(editor, name, indentation) {\n        var text = editor.session.getTextRange();\n        if (indentation)\n            return text.replace(/\\n\\r?([ \\t]*\\S)/g, \"\\n\" + indentation + \"$1\");\n        return text;\n    },\n    CURRENT_LINE: function(editor) {\n        return editor.session.getLine(editor.getCursorPosition().row);\n    },\n    PREV_LINE: function(editor) {\n        return editor.session.getLine(editor.getCursorPosition().row - 1);\n    },\n    LINE_INDEX: function(editor) {\n        return editor.getCursorPosition().row;\n    },\n    LINE_NUMBER: function(editor) {\n        return editor.getCursorPosition().row + 1;\n    },\n    SOFT_TABS: function(editor) {\n        return editor.session.getUseSoftTabs() ? \"YES\" : \"NO\";\n    },\n    TAB_SIZE: function(editor) {\n        return editor.session.getTabSize();\n    },\n    CLIPBOARD: function(editor) {\n        return clipboard.getText && clipboard.getText();\n    },\n    FILENAME: function(editor) {\n        return /[^/\\\\]*$/.exec(this.FILEPATH(editor))[0];\n    },\n    FILENAME_BASE: function(editor) {\n        return /[^/\\\\]*$/.exec(this.FILEPATH(editor))[0].replace(/\\.[^.]*$/, \"\");\n    },\n    DIRECTORY: function(editor) {\n        return this.FILEPATH(editor).replace(/[^/\\\\]*$/, \"\");\n    },\n    FILEPATH: function(editor) { return \"/not implemented.txt\"; },\n    WORKSPACE_NAME: function() { return \"Unknown\"; },\n    FULLNAME: function() { return \"Unknown\"; },\n    BLOCK_COMMENT_START: function(editor) {\n        var mode = editor.session.$mode || {};\n        return mode.blockComment && mode.blockComment.start || \"\";\n    },\n    BLOCK_COMMENT_END: function(editor) {\n        var mode = editor.session.$mode || {};\n        return mode.blockComment && mode.blockComment.end || \"\";\n    },\n    LINE_COMMENT: function(editor) {\n        var mode = editor.session.$mode || {};\n        return mode.lineCommentStart || \"\";\n    },\n    CURRENT_YEAR: date.bind(null, {year: \"numeric\"}),\n    CURRENT_YEAR_SHORT: date.bind(null, {year: \"2-digit\"}),\n    CURRENT_MONTH: date.bind(null, {month: \"numeric\"}),\n    CURRENT_MONTH_NAME: date.bind(null, {month: \"long\"}),\n    CURRENT_MONTH_NAME_SHORT: date.bind(null, {month: \"short\"}),\n    CURRENT_DATE: date.bind(null, {day: \"2-digit\"}),\n    CURRENT_DAY_NAME: date.bind(null, {weekday: \"long\"}),\n    CURRENT_DAY_NAME_SHORT: date.bind(null, {weekday: \"short\"}),\n    CURRENT_HOUR: date.bind(null, {hour: \"2-digit\", hour12: false}),\n    CURRENT_MINUTE: date.bind(null, {minute: \"2-digit\"}),\n    CURRENT_SECOND: date.bind(null, {second: \"2-digit\"})\n};\n\nVARIABLES.SELECTED_TEXT = VARIABLES.SELECTION;\n\nfunction date(dateFormat) {\n    var str = new Date().toLocaleString(\"en-us\", dateFormat);\n    return str.length == 1 ? \"0\" + str : str;\n}\n\nvar SnippetManager = function() {\n    this.snippetMap = {};\n    this.snippetNameMap = {};\n};\n\n(function() {\n    oop.implement(this, EventEmitter);\n    \n    this.getTokenizer = function() {\n        return SnippetManager.$tokenizer || this.createTokenizer();\n    };\n    \n    this.createTokenizer = function() {\n        function TabstopToken(str) {\n            str = str.substr(1);\n            if (/^\\d+$/.test(str))\n                return [{tabstopId: parseInt(str, 10)}];\n            return [{text: str}];\n        }\n        function escape(ch) {\n            return \"(?:[^\\\\\\\\\" + ch + \"]|\\\\\\\\.)\";\n        }\n        var formatMatcher = {\n            regex: \"/(\" + escape(\"/\") + \"+)/\", \n            onMatch: function(val, state, stack) {\n                var ts = stack[0];\n                ts.fmtString = true;\n                ts.guard = val.slice(1, -1);\n                ts.flag = \"\";\n                return \"\";\n            },\n            next: \"formatString\"\n        };\n        \n        SnippetManager.$tokenizer = new Tokenizer({\n            start: [\n                {regex: /\\\\./, onMatch: function(val, state, stack) {\n                    var ch = val[1];\n                    if (ch == \"}\" && stack.length) {\n                        val = ch;\n                    } else if (\"`$\\\\\".indexOf(ch) != -1) {\n                        val = ch;\n                    }\n                    return [val];\n                }},\n                {regex: /}/, onMatch: function(val, state, stack) {\n                    return [stack.length ? stack.shift() : val];\n                }},\n                {regex: /\\$(?:\\d+|\\w+)/, onMatch: TabstopToken},\n                {regex: /\\$\\{[\\dA-Z_a-z]+/, onMatch: function(str, state, stack) {\n                    var t = TabstopToken(str.substr(1));\n                    stack.unshift(t[0]);\n                    return t;\n                }, next: \"snippetVar\"},\n                {regex: /\\n/, token: \"newline\", merge: false}\n            ],\n            snippetVar: [\n                {regex: \"\\\\|\" + escape(\"\\\\|\") + \"*\\\\|\", onMatch: function(val, state, stack) {\n                    var choices = val.slice(1, -1).replace(/\\\\[,|\\\\]|,/g, function(operator) {\n                        return operator.length == 2 ? operator[1] : \"\\x00\";\n                    }).split(\"\\x00\");\n                    stack[0].choices = choices;\n                    return [choices[0]];\n                }, next: \"start\"},\n                formatMatcher,\n                {regex: \"([^:}\\\\\\\\]|\\\\\\\\.)*:?\", token: \"\", next: \"start\"}\n            ],\n            formatString: [\n                {regex: /:/, onMatch: function(val, state, stack) {\n                    if (stack.length && stack[0].expectElse) {\n                        stack[0].expectElse = false;\n                        stack[0].ifEnd = {elseEnd: stack[0]};\n                        return [stack[0].ifEnd];\n                    }\n                    return \":\";\n                }},\n                {regex: /\\\\./, onMatch: function(val, state, stack) {\n                    var ch = val[1];\n                    if (ch == \"}\" && stack.length)\n                        val = ch;\n                    else if (\"`$\\\\\".indexOf(ch) != -1)\n                        val = ch;\n                    else if (ch == \"n\")\n                        val = \"\\n\";\n                    else if (ch == \"t\")\n                        val = \"\\t\";\n                    else if (\"ulULE\".indexOf(ch) != -1)\n                        val = {changeCase: ch, local: ch > \"a\"};\n                    return [val];\n                }},\n                {regex: \"/\\\\w*}\", onMatch: function(val, state, stack) {\n                    var next = stack.shift();\n                    if (next)\n                        next.flag = val.slice(1, -1);\n                    this.next = next && next.tabstopId ? \"start\" : \"\";\n                    return [next || val];\n                }, next: \"start\"},\n                {regex: /\\$(?:\\d+|\\w+)/, onMatch: function(val, state, stack) {\n                    return [{text: val.slice(1)}];\n                }},\n                {regex: /\\${\\w+/, onMatch: function(val, state, stack) {\n                    var token = {text: val.slice(2)};\n                    stack.unshift(token);\n                    return [token];\n                }, next: \"formatStringVar\"},\n                {regex: /\\n/, token: \"newline\", merge: false},\n                {regex: /}/, onMatch: function(val, state, stack) {\n                    var next = stack.shift();\n                    this.next = next && next.tabstopId ? \"start\" : \"\";\n                    return [next || val];\n                }, next: \"start\"}\n            ],\n            formatStringVar: [\n                {regex: /:\\/\\w+}/, onMatch: function(val, state, stack) {\n                    var ts = stack[0];\n                    ts.formatFunction = val.slice(2, -1);\n                    return [stack.shift()];\n                }, next: \"formatString\"},\n                formatMatcher,\n                {regex: /:[\\?\\-+]?/, onMatch: function(val, state, stack) {\n                    if (val[1] == \"+\")\n                        stack[0].ifEnd = stack[0];\n                    if (val[1] == \"?\")\n                        stack[0].expectElse = true;\n                }, next: \"formatString\"},\n                {regex: \"([^:}\\\\\\\\]|\\\\\\\\.)*:?\", token: \"\", next: \"formatString\"}\n            ]\n        });\n        return SnippetManager.$tokenizer;\n    };\n\n    this.tokenizeTmSnippet = function(str, startState) {\n        return this.getTokenizer().getLineTokens(str, startState).tokens.map(function(x) {\n            return x.value || x;\n        });\n    };\n    \n    this.getVariableValue = function(editor, name, indentation) {\n        if (/^\\d+$/.test(name))\n            return (this.variables.__ || {})[name] || \"\";\n        if (/^[A-Z]\\d+$/.test(name))\n            return (this.variables[name[0] + \"__\"] || {})[name.substr(1)] || \"\";\n        \n        name = name.replace(/^TM_/, \"\");\n        if (!this.variables.hasOwnProperty(name))\n            return \"\";\n        var value = this.variables[name];\n        if (typeof value == \"function\")\n            value = this.variables[name](editor, name, indentation);\n        return value == null ? \"\" : value;\n    };\n    \n    this.variables = VARIABLES;\n    this.tmStrFormat = function(str, ch, editor) {\n        if (!ch.fmt) return str;\n        var flag = ch.flag || \"\";\n        var re = ch.guard;\n        re = new RegExp(re, flag.replace(/[^gim]/g, \"\"));\n        var fmtTokens = typeof ch.fmt == \"string\" ? this.tokenizeTmSnippet(ch.fmt, \"formatString\") : ch.fmt;\n        var _self = this;\n        var formatted = str.replace(re, function() {\n            var oldArgs = _self.variables.__;\n            _self.variables.__ = [].slice.call(arguments);\n            var fmtParts = _self.resolveVariables(fmtTokens, editor);\n            var gChangeCase = \"E\";\n            for (var i  = 0; i < fmtParts.length; i++) {\n                var ch = fmtParts[i];\n                if (typeof ch == \"object\") {\n                    fmtParts[i] = \"\";\n                    if (ch.changeCase && ch.local) {\n                        var next = fmtParts[i + 1];\n                        if (next && typeof next == \"string\") {\n                            if (ch.changeCase == \"u\")\n                                fmtParts[i] = next[0].toUpperCase();\n                            else\n                                fmtParts[i] = next[0].toLowerCase();\n                            fmtParts[i + 1] = next.substr(1);\n                        }\n                    } else if (ch.changeCase) {\n                        gChangeCase = ch.changeCase;\n                    }\n                } else if (gChangeCase == \"U\") {\n                    fmtParts[i] = ch.toUpperCase();\n                } else if (gChangeCase == \"L\") {\n                    fmtParts[i] = ch.toLowerCase();\n                }\n            }\n            _self.variables.__ = oldArgs;\n            return fmtParts.join(\"\");\n        });\n        return formatted;\n    };\n    \n    this.tmFormatFunction = function(str, ch, editor) {\n        if (ch.formatFunction == \"upcase\")\n            return str.toUpperCase();\n        if (ch.formatFunction == \"downcase\")\n            return str.toLowerCase();\n        return str;\n    };\n\n    this.resolveVariables = function(snippet, editor) {\n        var result = [];\n        var indentation = \"\";\n        var afterNewLine = true;\n        for (var i = 0; i < snippet.length; i++) {\n            var ch = snippet[i];\n            if (typeof ch == \"string\") {\n                result.push(ch);\n                if (ch == \"\\n\") {\n                    afterNewLine = true;\n                    indentation = \"\";\n                }\n                else if (afterNewLine) {\n                    indentation = /^\\t*/.exec(ch)[0];\n                    afterNewLine = /\\S/.test(ch);\n                }\n                continue;\n            }\n            if (!ch)  continue;\n            afterNewLine = false;\n            \n            if (ch.fmtString) {\n                var j = snippet.indexOf(ch, i + 1);\n                if (j == -1) j = snippet.length;\n                ch.fmt = snippet.slice(i + 1, j);\n                i = j;\n            }\n            \n            if (ch.text) {\n                var value = this.getVariableValue(editor, ch.text, indentation) + \"\";\n                if (ch.fmtString)\n                    value = this.tmStrFormat(value, ch, editor);\n                if (ch.formatFunction)\n                    value = this.tmFormatFunction(value, ch, editor);\n                \n                if (value && !ch.ifEnd) {\n                    result.push(value);\n                    gotoNext(ch);\n                } else if (!value && ch.ifEnd) {\n                    gotoNext(ch.ifEnd);\n                }\n            } else if (ch.elseEnd) {\n                gotoNext(ch.elseEnd);\n            } else if (ch.tabstopId != null) {\n                result.push(ch);\n            } else if (ch.changeCase != null) {\n                result.push(ch);\n            }\n        }\n        function gotoNext(ch) {\n            var i1 = snippet.indexOf(ch, i + 1);\n            if (i1 != -1)\n                i = i1;\n        }\n        return result;\n    };\n\n    this.insertSnippetForSelection = function(editor, snippetText) {\n        var cursor = editor.getCursorPosition();\n        var line = editor.session.getLine(cursor.row);\n        var tabString = editor.session.getTabString();\n        var indentString = line.match(/^\\s*/)[0];\n        \n        if (cursor.column < indentString.length)\n            indentString = indentString.slice(0, cursor.column);\n\n        snippetText = snippetText.replace(/\\r/g, \"\");\n        var tokens = this.tokenizeTmSnippet(snippetText);\n        tokens = this.resolveVariables(tokens, editor);\n        tokens = tokens.map(function(x) {\n            if (x == \"\\n\")\n                return x + indentString;\n            if (typeof x == \"string\")\n                return x.replace(/\\t/g, tabString);\n            return x;\n        });\n        var tabstops = [];\n        tokens.forEach(function(p, i) {\n            if (typeof p != \"object\")\n                return;\n            var id = p.tabstopId;\n            var ts = tabstops[id];\n            if (!ts) {\n                ts = tabstops[id] = [];\n                ts.index = id;\n                ts.value = \"\";\n                ts.parents = {};\n            }\n            if (ts.indexOf(p) !== -1)\n                return;\n            if (p.choices && !ts.choices)\n                ts.choices = p.choices;\n            ts.push(p);\n            var i1 = tokens.indexOf(p, i + 1);\n            if (i1 === -1)\n                return;\n\n            var value = tokens.slice(i + 1, i1);\n            var isNested = value.some(function(t) {return typeof t === \"object\";});\n            if (isNested && !ts.value) {\n                ts.value = value;\n            } else if (value.length && (!ts.value || typeof ts.value !== \"string\")) {\n                ts.value = value.join(\"\");\n            }\n        });\n        tabstops.forEach(function(ts) {ts.length = 0;});\n        var expanding = {};\n        function copyValue(val) {\n            var copy = [];\n            for (var i = 0; i < val.length; i++) {\n                var p = val[i];\n                if (typeof p == \"object\") {\n                    if (expanding[p.tabstopId])\n                        continue;\n                    var j = val.lastIndexOf(p, i - 1);\n                    p = copy[j] || {tabstopId: p.tabstopId};\n                }\n                copy[i] = p;\n            }\n            return copy;\n        }\n        for (var i = 0; i < tokens.length; i++) {\n            var p = tokens[i];\n            if (typeof p != \"object\")\n                continue;\n            var id = p.tabstopId;\n            var ts = tabstops[id];\n            var i1 = tokens.indexOf(p, i + 1);\n            if (expanding[id]) {\n                if (expanding[id] === p) {\n                    delete expanding[id];\n                    Object.keys(expanding).forEach(function(parentId) {\n                        ts.parents[parentId] = true;\n                    });\n                }\n                continue;\n            }\n            expanding[id] = p;\n            var value = ts.value;\n            if (typeof value !== \"string\")\n                value = copyValue(value);\n            else if (p.fmt)\n                value = this.tmStrFormat(value, p, editor);\n            tokens.splice.apply(tokens, [i + 1, Math.max(0, i1 - i)].concat(value, p));\n\n            if (ts.indexOf(p) === -1)\n                ts.push(p);\n        }\n        var row = 0, column = 0;\n        var text = \"\";\n        tokens.forEach(function(t) {\n            if (typeof t === \"string\") {\n                var lines = t.split(\"\\n\");\n                if (lines.length > 1){\n                    column = lines[lines.length - 1].length;\n                    row += lines.length - 1;\n                } else\n                    column += t.length;\n                text += t;\n            } else if (t) {\n                if (!t.start)\n                    t.start = {row: row, column: column};\n                else\n                    t.end = {row: row, column: column};\n            }\n        });\n        var range = editor.getSelectionRange();\n        var end = editor.session.replace(range, text);\n\n        var tabstopManager = new TabstopManager(editor);\n        var selectionId = editor.inVirtualSelectionMode && editor.selection.index;\n        tabstopManager.addTabstops(tabstops, range.start, end, selectionId);\n    };\n    \n    this.insertSnippet = function(editor, snippetText) {\n        var self = this;\n        if (editor.inVirtualSelectionMode)\n            return self.insertSnippetForSelection(editor, snippetText);\n        \n        editor.forEachSelection(function() {\n            self.insertSnippetForSelection(editor, snippetText);\n        }, null, {keepOrder: true});\n        \n        if (editor.tabstopManager)\n            editor.tabstopManager.tabNext();\n    };\n\n    this.$getScope = function(editor) {\n        var scope = editor.session.$mode.$id || \"\";\n        scope = scope.split(\"/\").pop();\n        if (scope === \"html\" || scope === \"php\") {\n            if (scope === \"php\" && !editor.session.$mode.inlinePhp) \n                scope = \"html\";\n            var c = editor.getCursorPosition();\n            var state = editor.session.getState(c.row);\n            if (typeof state === \"object\") {\n                state = state[0];\n            }\n            if (state.substring) {\n                if (state.substring(0, 3) == \"js-\")\n                    scope = \"javascript\";\n                else if (state.substring(0, 4) == \"css-\")\n                    scope = \"css\";\n                else if (state.substring(0, 4) == \"php-\")\n                    scope = \"php\";\n            }\n        }\n        \n        return scope;\n    };\n\n    this.getActiveScopes = function(editor) {\n        var scope = this.$getScope(editor);\n        var scopes = [scope];\n        var snippetMap = this.snippetMap;\n        if (snippetMap[scope] && snippetMap[scope].includeScopes) {\n            scopes.push.apply(scopes, snippetMap[scope].includeScopes);\n        }\n        scopes.push(\"_\");\n        return scopes;\n    };\n\n    this.expandWithTab = function(editor, options) {\n        var self = this;\n        var result = editor.forEachSelection(function() {\n            return self.expandSnippetForSelection(editor, options);\n        }, null, {keepOrder: true});\n        if (result && editor.tabstopManager)\n            editor.tabstopManager.tabNext();\n        return result;\n    };\n    \n    this.expandSnippetForSelection = function(editor, options) {\n        var cursor = editor.getCursorPosition();\n        var line = editor.session.getLine(cursor.row);\n        var before = line.substring(0, cursor.column);\n        var after = line.substr(cursor.column);\n\n        var snippetMap = this.snippetMap;\n        var snippet;\n        this.getActiveScopes(editor).some(function(scope) {\n            var snippets = snippetMap[scope];\n            if (snippets)\n                snippet = this.findMatchingSnippet(snippets, before, after);\n            return !!snippet;\n        }, this);\n        if (!snippet)\n            return false;\n        if (options && options.dryRun)\n            return true;\n        editor.session.doc.removeInLine(cursor.row,\n            cursor.column - snippet.replaceBefore.length,\n            cursor.column + snippet.replaceAfter.length\n        );\n\n        this.variables.M__ = snippet.matchBefore;\n        this.variables.T__ = snippet.matchAfter;\n        this.insertSnippetForSelection(editor, snippet.content);\n\n        this.variables.M__ = this.variables.T__ = null;\n        return true;\n    };\n\n    this.findMatchingSnippet = function(snippetList, before, after) {\n        for (var i = snippetList.length; i--;) {\n            var s = snippetList[i];\n            if (s.startRe && !s.startRe.test(before))\n                continue;\n            if (s.endRe && !s.endRe.test(after))\n                continue;\n            if (!s.startRe && !s.endRe)\n                continue;\n\n            s.matchBefore = s.startRe ? s.startRe.exec(before) : [\"\"];\n            s.matchAfter = s.endRe ? s.endRe.exec(after) : [\"\"];\n            s.replaceBefore = s.triggerRe ? s.triggerRe.exec(before)[0] : \"\";\n            s.replaceAfter = s.endTriggerRe ? s.endTriggerRe.exec(after)[0] : \"\";\n            return s;\n        }\n    };\n\n    this.snippetMap = {};\n    this.snippetNameMap = {};\n    this.register = function(snippets, scope) {\n        var snippetMap = this.snippetMap;\n        var snippetNameMap = this.snippetNameMap;\n        var self = this;\n        \n        if (!snippets) \n            snippets = [];\n        \n        function wrapRegexp(src) {\n            if (src && !/^\\^?\\(.*\\)\\$?$|^\\\\b$/.test(src))\n                src = \"(?:\" + src + \")\";\n\n            return src || \"\";\n        }\n        function guardedRegexp(re, guard, opening) {\n            re = wrapRegexp(re);\n            guard = wrapRegexp(guard);\n            if (opening) {\n                re = guard + re;\n                if (re && re[re.length - 1] != \"$\")\n                    re = re + \"$\";\n            } else {\n                re = re + guard;\n                if (re && re[0] != \"^\")\n                    re = \"^\" + re;\n            }\n            return new RegExp(re);\n        }\n\n        function addSnippet(s) {\n            if (!s.scope)\n                s.scope = scope || \"_\";\n            scope = s.scope;\n            if (!snippetMap[scope]) {\n                snippetMap[scope] = [];\n                snippetNameMap[scope] = {};\n            }\n\n            var map = snippetNameMap[scope];\n            if (s.name) {\n                var old = map[s.name];\n                if (old)\n                    self.unregister(old);\n                map[s.name] = s;\n            }\n            snippetMap[scope].push(s);\n\n            if (s.prefix)\n                s.tabTrigger = s.prefix;\n\n            if (!s.content && s.body)\n                s.content = Array.isArray(s.body) ? s.body.join(\"\\n\") : s.body;\n\n            if (s.tabTrigger && !s.trigger) {\n                if (!s.guard && /^\\w/.test(s.tabTrigger))\n                    s.guard = \"\\\\b\";\n                s.trigger = lang.escapeRegExp(s.tabTrigger);\n            }\n            \n            if (!s.trigger && !s.guard && !s.endTrigger && !s.endGuard)\n                return;\n            \n            s.startRe = guardedRegexp(s.trigger, s.guard, true);\n            s.triggerRe = new RegExp(s.trigger);\n\n            s.endRe = guardedRegexp(s.endTrigger, s.endGuard, true);\n            s.endTriggerRe = new RegExp(s.endTrigger);\n        }\n\n        if (Array.isArray(snippets)) {\n            snippets.forEach(addSnippet);\n        } else {\n            Object.keys(snippets).forEach(function(key) {\n                addSnippet(snippets[key]);\n            });\n        }\n        \n        this._signal(\"registerSnippets\", {scope: scope});\n    };\n    this.unregister = function(snippets, scope) {\n        var snippetMap = this.snippetMap;\n        var snippetNameMap = this.snippetNameMap;\n\n        function removeSnippet(s) {\n            var nameMap = snippetNameMap[s.scope||scope];\n            if (nameMap && nameMap[s.name]) {\n                delete nameMap[s.name];\n                var map = snippetMap[s.scope||scope];\n                var i = map && map.indexOf(s);\n                if (i >= 0)\n                    map.splice(i, 1);\n            }\n        }\n        if (snippets.content)\n            removeSnippet(snippets);\n        else if (Array.isArray(snippets))\n            snippets.forEach(removeSnippet);\n    };\n    this.parseSnippetFile = function(str) {\n        str = str.replace(/\\r/g, \"\");\n        var list = [], snippet = {};\n        var re = /^#.*|^({[\\s\\S]*})\\s*$|^(\\S+) (.*)$|^((?:\\n*\\t.*)+)/gm;\n        var m;\n        while (m = re.exec(str)) {\n            if (m[1]) {\n                try {\n                    snippet = JSON.parse(m[1]);\n                    list.push(snippet);\n                } catch (e) {}\n            } if (m[4]) {\n                snippet.content = m[4].replace(/^\\t/gm, \"\");\n                list.push(snippet);\n                snippet = {};\n            } else {\n                var key = m[2], val = m[3];\n                if (key == \"regex\") {\n                    var guardRe = /\\/((?:[^\\/\\\\]|\\\\.)*)|$/g;\n                    snippet.guard = guardRe.exec(val)[1];\n                    snippet.trigger = guardRe.exec(val)[1];\n                    snippet.endTrigger = guardRe.exec(val)[1];\n                    snippet.endGuard = guardRe.exec(val)[1];\n                } else if (key == \"snippet\") {\n                    snippet.tabTrigger = val.match(/^\\S*/)[0];\n                    if (!snippet.name)\n                        snippet.name = val;\n                } else if (key) {\n                    snippet[key] = val;\n                }\n            }\n        }\n        return list;\n    };\n    this.getSnippetByName = function(name, editor) {\n        var snippetMap = this.snippetNameMap;\n        var snippet;\n        this.getActiveScopes(editor).some(function(scope) {\n            var snippets = snippetMap[scope];\n            if (snippets)\n                snippet = snippets[name];\n            return !!snippet;\n        }, this);\n        return snippet;\n    };\n\n}).call(SnippetManager.prototype);\n\n\nvar TabstopManager = function(editor) {\n    if (editor.tabstopManager)\n        return editor.tabstopManager;\n    editor.tabstopManager = this;\n    this.$onChange = this.onChange.bind(this);\n    this.$onChangeSelection = lang.delayedCall(this.onChangeSelection.bind(this)).schedule;\n    this.$onChangeSession = this.onChangeSession.bind(this);\n    this.$onAfterExec = this.onAfterExec.bind(this);\n    this.attach(editor);\n};\n(function() {\n    this.attach = function(editor) {\n        this.index = 0;\n        this.ranges = [];\n        this.tabstops = [];\n        this.$openTabstops = null;\n        this.selectedTabstop = null;\n\n        this.editor = editor;\n        this.editor.on(\"change\", this.$onChange);\n        this.editor.on(\"changeSelection\", this.$onChangeSelection);\n        this.editor.on(\"changeSession\", this.$onChangeSession);\n        this.editor.commands.on(\"afterExec\", this.$onAfterExec);\n        this.editor.keyBinding.addKeyboardHandler(this.keyboardHandler);\n    };\n    this.detach = function() {\n        this.tabstops.forEach(this.removeTabstopMarkers, this);\n        this.ranges = null;\n        this.tabstops = null;\n        this.selectedTabstop = null;\n        this.editor.removeListener(\"change\", this.$onChange);\n        this.editor.removeListener(\"changeSelection\", this.$onChangeSelection);\n        this.editor.removeListener(\"changeSession\", this.$onChangeSession);\n        this.editor.commands.removeListener(\"afterExec\", this.$onAfterExec);\n        this.editor.keyBinding.removeKeyboardHandler(this.keyboardHandler);\n        this.editor.tabstopManager = null;\n        this.editor = null;\n    };\n\n    this.onChange = function(delta) {\n        var isRemove = delta.action[0] == \"r\";\n        var selectedTabstop = this.selectedTabstop || {};\n        var parents = selectedTabstop.parents || {};\n        var tabstops = (this.tabstops || []).slice();\n        for (var i = 0; i < tabstops.length; i++) {\n            var ts = tabstops[i];\n            var active = ts == selectedTabstop || parents[ts.index];\n            ts.rangeList.$bias = active ? 0 : 1;\n            \n            if (delta.action == \"remove\" && ts !== selectedTabstop) {\n                var parentActive = ts.parents && ts.parents[selectedTabstop.index];\n                var startIndex = ts.rangeList.pointIndex(delta.start, parentActive);\n                startIndex = startIndex < 0 ? -startIndex - 1 : startIndex + 1;\n                var endIndex = ts.rangeList.pointIndex(delta.end, parentActive);\n                endIndex = endIndex < 0 ? -endIndex - 1 : endIndex - 1;\n                var toRemove = ts.rangeList.ranges.slice(startIndex, endIndex);\n                for (var j = 0; j < toRemove.length; j++)\n                    this.removeRange(toRemove[j]);\n            }\n            ts.rangeList.$onChange(delta);\n        }\n        var session = this.editor.session;\n        if (!this.$inChange && isRemove && session.getLength() == 1 && !session.getValue())\n            this.detach();\n    };\n    this.updateLinkedFields = function() {\n        var ts = this.selectedTabstop;\n        if (!ts || !ts.hasLinkedRanges || !ts.firstNonLinked)\n            return;\n        this.$inChange = true;\n        var session = this.editor.session;\n        var text = session.getTextRange(ts.firstNonLinked);\n        for (var i = 0; i < ts.length; i++) {\n            var range = ts[i];\n            if (!range.linked)\n                continue;\n            var original = range.original;\n            var fmt = exports.snippetManager.tmStrFormat(text, original, this.editor);\n            session.replace(range, fmt);\n        }\n        this.$inChange = false;\n    };\n    this.onAfterExec = function(e) {\n        if (e.command && !e.command.readOnly)\n            this.updateLinkedFields();\n    };\n    this.onChangeSelection = function() {\n        if (!this.editor)\n            return;\n        var lead = this.editor.selection.lead;\n        var anchor = this.editor.selection.anchor;\n        var isEmpty = this.editor.selection.isEmpty();\n        for (var i = 0; i < this.ranges.length; i++) {\n            if (this.ranges[i].linked)\n                continue;\n            var containsLead = this.ranges[i].contains(lead.row, lead.column);\n            var containsAnchor = isEmpty || this.ranges[i].contains(anchor.row, anchor.column);\n            if (containsLead && containsAnchor)\n                return;\n        }\n        this.detach();\n    };\n    this.onChangeSession = function() {\n        this.detach();\n    };\n    this.tabNext = function(dir) {\n        var max = this.tabstops.length;\n        var index = this.index + (dir || 1);\n        index = Math.min(Math.max(index, 1), max);\n        if (index == max)\n            index = 0;\n        this.selectTabstop(index);\n        if (index === 0)\n            this.detach();\n    };\n    this.selectTabstop = function(index) {\n        this.$openTabstops = null;\n        var ts = this.tabstops[this.index];\n        if (ts)\n            this.addTabstopMarkers(ts);\n        this.index = index;\n        ts = this.tabstops[this.index];\n        if (!ts || !ts.length)\n            return;\n        \n        this.selectedTabstop = ts;\n        var range = ts.firstNonLinked || ts;\n        if (!this.editor.inVirtualSelectionMode) {\n            var sel = this.editor.multiSelect;\n            sel.toSingleRange(range.clone());\n            for (var i = 0; i < ts.length; i++) {\n                if (ts.hasLinkedRanges && ts[i].linked)\n                    continue;\n                sel.addRange(ts[i].clone(), true);\n            }\n            if (sel.ranges[0])\n                sel.addRange(sel.ranges[0].clone());\n        } else {\n            this.editor.selection.setRange(range);\n        }\n        \n        this.editor.keyBinding.addKeyboardHandler(this.keyboardHandler);\n        if (this.selectedTabstop && this.selectedTabstop.choices)\n            this.editor.execCommand(\"startAutocomplete\", {matches: this.selectedTabstop.choices});\n    };\n    this.addTabstops = function(tabstops, start, end) {\n        var useLink = this.useLink || !this.editor.getOption(\"enableMultiselect\");\n        \n        if (!this.$openTabstops)\n            this.$openTabstops = [];\n        if (!tabstops[0]) {\n            var p = Range.fromPoints(end, end);\n            moveRelative(p.start, start);\n            moveRelative(p.end, start);\n            tabstops[0] = [p];\n            tabstops[0].index = 0;\n        }\n\n        var i = this.index;\n        var arg = [i + 1, 0];\n        var ranges = this.ranges;\n        tabstops.forEach(function(ts, index) {\n            var dest = this.$openTabstops[index] || ts;\n            \n            for (var i = 0; i < ts.length; i++) {\n                var p = ts[i];\n                var range = Range.fromPoints(p.start, p.end || p.start);\n                movePoint(range.start, start);\n                movePoint(range.end, start);\n                range.original = p;\n                range.tabstop = dest;\n                ranges.push(range);\n                if (dest != ts)\n                    dest.unshift(range);\n                else\n                    dest[i] = range;\n                if (p.fmtString || (dest.firstNonLinked && useLink)) {\n                    range.linked = true;\n                    dest.hasLinkedRanges = true;\n                } else if (!dest.firstNonLinked)\n                    dest.firstNonLinked = range;\n            }\n            if (!dest.firstNonLinked)\n                dest.hasLinkedRanges = false;\n            if (dest === ts) {\n                arg.push(dest);\n                this.$openTabstops[index] = dest;\n            }\n            this.addTabstopMarkers(dest);\n            dest.rangeList = dest.rangeList || new RangeList();\n            dest.rangeList.$bias = 0;\n            dest.rangeList.addList(dest);\n        }, this);\n        \n        if (arg.length > 2) {\n            if (this.tabstops.length)\n                arg.push(arg.splice(2, 1)[0]);\n            this.tabstops.splice.apply(this.tabstops, arg);\n        }\n    };\n\n    this.addTabstopMarkers = function(ts) {\n        var session = this.editor.session;\n        ts.forEach(function(range) {\n            if  (!range.markerId)\n                range.markerId = session.addMarker(range, \"ace_snippet-marker\", \"text\");\n        });\n    };\n    this.removeTabstopMarkers = function(ts) {\n        var session = this.editor.session;\n        ts.forEach(function(range) {\n            session.removeMarker(range.markerId);\n            range.markerId = null;\n        });\n    };\n    this.removeRange = function(range) {\n        var i = range.tabstop.indexOf(range);\n        if (i != -1) range.tabstop.splice(i, 1);\n        i = this.ranges.indexOf(range);\n        if (i != -1) this.ranges.splice(i, 1);\n        i = range.tabstop.rangeList.ranges.indexOf(range);\n        if (i != -1) range.tabstop.splice(i, 1);\n        this.editor.session.removeMarker(range.markerId);\n        if (!range.tabstop.length) {\n            i = this.tabstops.indexOf(range.tabstop);\n            if (i != -1)\n                this.tabstops.splice(i, 1);\n            if (!this.tabstops.length)\n                this.detach();\n        }\n    };\n\n    this.keyboardHandler = new HashHandler();\n    this.keyboardHandler.bindKeys({\n        \"Tab\": function(editor) {\n            if (exports.snippetManager && exports.snippetManager.expandWithTab(editor))\n                return;\n            editor.tabstopManager.tabNext(1);\n            editor.renderer.scrollCursorIntoView();\n        },\n        \"Shift-Tab\": function(editor) {\n            editor.tabstopManager.tabNext(-1);\n            editor.renderer.scrollCursorIntoView();\n        },\n        \"Esc\": function(editor) {\n            editor.tabstopManager.detach();\n        }\n    });\n}).call(TabstopManager.prototype);\n\n\n\nvar movePoint = function(point, diff) {\n    if (point.row == 0)\n        point.column += diff.column;\n    point.row += diff.row;\n};\n\nvar moveRelative = function(point, start) {\n    if (point.row == start.row)\n        point.column -= start.column;\n    point.row -= start.row;\n};\n\n\nrequire(\"./lib/dom\").importCssString(\"\\\n.ace_snippet-marker {\\\n    -moz-box-sizing: border-box;\\\n    box-sizing: border-box;\\\n    background: rgba(194, 193, 208, 0.09);\\\n    border: 1px dotted rgba(211, 208, 235, 0.62);\\\n    position: absolute;\\\n}\");\n\nexports.snippetManager = new SnippetManager();\n\n\nvar Editor = require(\"./editor\").Editor;\n(function() {\n    this.insertSnippet = function(content, options) {\n        return exports.snippetManager.insertSnippet(this, content, options);\n    };\n    this.expandSnippet = function(options) {\n        return exports.snippetManager.expandWithTab(this, options);\n    };\n}).call(Editor.prototype);\n\n});\n\nace.define(\"ace/autocomplete\",[\"require\",\"exports\",\"module\",\"ace/keyboard/hash_handler\",\"ace/autocomplete/popup\",\"ace/autocomplete/util\",\"ace/lib/lang\",\"ace/lib/dom\",\"ace/snippets\",\"ace/config\"], function(require, exports, module) {\n\"use strict\";\n\nvar HashHandler = require(\"./keyboard/hash_handler\").HashHandler;\nvar AcePopup = require(\"./autocomplete/popup\").AcePopup;\nvar util = require(\"./autocomplete/util\");\nvar lang = require(\"./lib/lang\");\nvar dom = require(\"./lib/dom\");\nvar snippetManager = require(\"./snippets\").snippetManager;\nvar config = require(\"./config\");\n\nvar Autocomplete = function() {\n    this.autoInsert = false;\n    this.autoSelect = true;\n    this.exactMatch = false;\n    this.gatherCompletionsId = 0;\n    this.keyboardHandler = new HashHandler();\n    this.keyboardHandler.bindKeys(this.commands);\n\n    this.blurListener = this.blurListener.bind(this);\n    this.changeListener = this.changeListener.bind(this);\n    this.mousedownListener = this.mousedownListener.bind(this);\n    this.mousewheelListener = this.mousewheelListener.bind(this);\n\n    this.changeTimer = lang.delayedCall(function() {\n        this.updateCompletions(true);\n    }.bind(this));\n\n    this.tooltipTimer = lang.delayedCall(this.updateDocTooltip.bind(this), 50);\n};\n\n(function() {\n\n    this.$init = function() {\n        this.popup = new AcePopup(document.body || document.documentElement);\n        this.popup.on(\"click\", function(e) {\n            this.insertMatch();\n            e.stop();\n        }.bind(this));\n        this.popup.focus = this.editor.focus.bind(this.editor);\n        this.popup.on(\"show\", this.tooltipTimer.bind(null, null));\n        this.popup.on(\"select\", this.tooltipTimer.bind(null, null));\n        this.popup.on(\"changeHoverMarker\", this.tooltipTimer.bind(null, null));\n        return this.popup;\n    };\n\n    this.getPopup = function() {\n        return this.popup || this.$init();\n    };\n\n    this.openPopup = function(editor, prefix, keepPopupPosition) {\n        if (!this.popup)\n            this.$init();\n\n        this.popup.autoSelect = this.autoSelect;\n\n        this.popup.setData(this.completions.filtered, this.completions.filterText);\n\n        editor.keyBinding.addKeyboardHandler(this.keyboardHandler);\n        \n        var renderer = editor.renderer;\n        this.popup.setRow(this.autoSelect ? 0 : -1);\n        if (!keepPopupPosition) {\n            this.popup.setTheme(editor.getTheme());\n            this.popup.setFontSize(editor.getFontSize());\n\n            var lineHeight = renderer.layerConfig.lineHeight;\n\n            var pos = renderer.$cursorLayer.getPixelPosition(this.base, true);\n            pos.left -= this.popup.getTextLeftOffset();\n\n            var rect = editor.container.getBoundingClientRect();\n            pos.top += rect.top - renderer.layerConfig.offset;\n            pos.left += rect.left - editor.renderer.scrollLeft;\n            pos.left += renderer.gutterWidth;\n\n            this.popup.show(pos, lineHeight);\n        } else if (keepPopupPosition && !prefix) {\n            this.detach();\n        }\n    };\n\n    this.detach = function() {\n        this.editor.keyBinding.removeKeyboardHandler(this.keyboardHandler);\n        this.editor.off(\"changeSelection\", this.changeListener);\n        this.editor.off(\"blur\", this.blurListener);\n        this.editor.off(\"mousedown\", this.mousedownListener);\n        this.editor.off(\"mousewheel\", this.mousewheelListener);\n        this.changeTimer.cancel();\n        this.hideDocTooltip();\n\n        this.gatherCompletionsId += 1;\n        if (this.popup && this.popup.isOpen)\n            this.popup.hide();\n\n        if (this.base)\n            this.base.detach();\n        this.activated = false;\n        this.completions = this.base = null;\n    };\n\n    this.changeListener = function(e) {\n        var cursor = this.editor.selection.lead;\n        if (cursor.row != this.base.row || cursor.column < this.base.column) {\n            this.detach();\n        }\n        if (this.activated)\n            this.changeTimer.schedule();\n        else\n            this.detach();\n    };\n\n    this.blurListener = function(e) {\n        var el = document.activeElement;\n        var text = this.editor.textInput.getElement();\n        var fromTooltip = e.relatedTarget && this.tooltipNode && this.tooltipNode.contains(e.relatedTarget);\n        var container = this.popup && this.popup.container;\n        if (el != text && el.parentNode != container && !fromTooltip\n            && el != this.tooltipNode && e.relatedTarget != text\n        ) {\n            this.detach();\n        }\n    };\n\n    this.mousedownListener = function(e) {\n        this.detach();\n    };\n\n    this.mousewheelListener = function(e) {\n        this.detach();\n    };\n\n    this.goTo = function(where) {\n        this.popup.goTo(where);\n    };\n\n    this.insertMatch = function(data, options) {\n        if (!data)\n            data = this.popup.getData(this.popup.getRow());\n        if (!data)\n            return false;\n\n        this.editor.startOperation({command: {name: \"insertMatch\"}});\n        if (data.completer && data.completer.insertMatch) {\n            data.completer.insertMatch(this.editor, data);\n        } else {\n            if (this.completions.filterText) {\n                var ranges = this.editor.selection.getAllRanges();\n                for (var i = 0, range; range = ranges[i]; i++) {\n                    range.start.column -= this.completions.filterText.length;\n                    this.editor.session.remove(range);\n                }\n            }\n            if (data.snippet)\n                snippetManager.insertSnippet(this.editor, data.snippet);\n            else\n                this.editor.execCommand(\"insertstring\", data.value || data);\n        }\n        this.detach();\n        this.editor.endOperation();\n    };\n\n\n    this.commands = {\n        \"Up\": function(editor) { editor.completer.goTo(\"up\"); },\n        \"Down\": function(editor) { editor.completer.goTo(\"down\"); },\n        \"Ctrl-Up|Ctrl-Home\": function(editor) { editor.completer.goTo(\"start\"); },\n        \"Ctrl-Down|Ctrl-End\": function(editor) { editor.completer.goTo(\"end\"); },\n\n        \"Esc\": function(editor) { editor.completer.detach(); },\n        \"Return\": function(editor) { return editor.completer.insertMatch(); },\n        \"Shift-Return\": function(editor) { editor.completer.insertMatch(null, {deleteSuffix: true}); },\n        \"Tab\": function(editor) {\n            var result = editor.completer.insertMatch();\n            if (!result && !editor.tabstopManager)\n                editor.completer.goTo(\"down\");\n            else\n                return result;\n        },\n\n        \"PageUp\": function(editor) { editor.completer.popup.gotoPageUp(); },\n        \"PageDown\": function(editor) { editor.completer.popup.gotoPageDown(); }\n    };\n\n    this.gatherCompletions = function(editor, callback) {\n        var session = editor.getSession();\n        var pos = editor.getCursorPosition();\n\n        var prefix = util.getCompletionPrefix(editor);\n\n        this.base = session.doc.createAnchor(pos.row, pos.column - prefix.length);\n        this.base.$insertRight = true;\n\n        var matches = [];\n        var total = editor.completers.length;\n        editor.completers.forEach(function(completer, i) {\n            completer.getCompletions(editor, session, pos, prefix, function(err, results) {\n                if (!err && results)\n                    matches = matches.concat(results);\n                callback(null, {\n                    prefix: util.getCompletionPrefix(editor),\n                    matches: matches,\n                    finished: (--total === 0)\n                });\n            });\n        });\n        return true;\n    };\n\n    this.showPopup = function(editor, options) {\n        if (this.editor)\n            this.detach();\n\n        this.activated = true;\n\n        this.editor = editor;\n        if (editor.completer != this) {\n            if (editor.completer)\n                editor.completer.detach();\n            editor.completer = this;\n        }\n\n        editor.on(\"changeSelection\", this.changeListener);\n        editor.on(\"blur\", this.blurListener);\n        editor.on(\"mousedown\", this.mousedownListener);\n        editor.on(\"mousewheel\", this.mousewheelListener);\n\n        this.updateCompletions(false, options);\n    };\n\n    this.updateCompletions = function(keepPopupPosition, options) {\n        if (keepPopupPosition && this.base && this.completions) {\n            var pos = this.editor.getCursorPosition();\n            var prefix = this.editor.session.getTextRange({start: this.base, end: pos});\n            if (prefix == this.completions.filterText)\n                return;\n            this.completions.setFilter(prefix);\n            if (!this.completions.filtered.length)\n                return this.detach();\n            if (this.completions.filtered.length == 1\n            && this.completions.filtered[0].value == prefix\n            && !this.completions.filtered[0].snippet)\n                return this.detach();\n            this.openPopup(this.editor, prefix, keepPopupPosition);\n            return;\n        }\n        \n        if (options && options.matches) {\n            var pos = this.editor.getSelectionRange().start;\n            this.base = this.editor.session.doc.createAnchor(pos.row, pos.column);\n            this.base.$insertRight = true;\n            this.completions = new FilteredList(options.matches);\n            return this.openPopup(this.editor, \"\", keepPopupPosition);\n        }\n        var _id = this.gatherCompletionsId;\n        this.gatherCompletions(this.editor, function(err, results) {\n            var detachIfFinished = function() {\n                if (!results.finished) return;\n                return this.detach();\n            }.bind(this);\n\n            var prefix = results.prefix;\n            var matches = results && results.matches;\n\n            if (!matches || !matches.length)\n                return detachIfFinished();\n            if (prefix.indexOf(results.prefix) !== 0 || _id != this.gatherCompletionsId)\n                return;\n\n            this.completions = new FilteredList(matches);\n\n            if (this.exactMatch)\n                this.completions.exactMatch = true;\n\n            this.completions.setFilter(prefix);\n            var filtered = this.completions.filtered;\n            if (!filtered.length)\n                return detachIfFinished();\n            if (filtered.length == 1 && filtered[0].value == prefix && !filtered[0].snippet)\n                return detachIfFinished();\n            if (this.autoInsert && filtered.length == 1 && results.finished)\n                return this.insertMatch(filtered[0]);\n\n            this.openPopup(this.editor, prefix, keepPopupPosition);\n        }.bind(this));\n    };\n\n    this.cancelContextMenu = function() {\n        this.editor.$mouseHandler.cancelContextMenu();\n    };\n\n    this.updateDocTooltip = function() {\n        var popup = this.popup;\n        var all = popup.data;\n        var selected = all && (all[popup.getHoveredRow()] || all[popup.getRow()]);\n        var doc = null;\n        if (!selected || !this.editor || !this.popup.isOpen)\n            return this.hideDocTooltip();\n        this.editor.completers.some(function(completer) {\n            if (completer.getDocTooltip)\n                doc = completer.getDocTooltip(selected);\n            return doc;\n        });\n        if (!doc && typeof selected != \"string\")\n            doc = selected;\n\n        if (typeof doc == \"string\")\n            doc = {docText: doc};\n        if (!doc || !(doc.docHTML || doc.docText))\n            return this.hideDocTooltip();\n        this.showDocTooltip(doc);\n    };\n\n    this.showDocTooltip = function(item) {\n        if (!this.tooltipNode) {\n            this.tooltipNode = dom.createElement(\"div\");\n            this.tooltipNode.className = \"ace_tooltip ace_doc-tooltip\";\n            this.tooltipNode.style.margin = 0;\n            this.tooltipNode.style.pointerEvents = \"auto\";\n            this.tooltipNode.tabIndex = -1;\n            this.tooltipNode.onblur = this.blurListener.bind(this);\n            this.tooltipNode.onclick = this.onTooltipClick.bind(this);\n        }\n\n        var tooltipNode = this.tooltipNode;\n        if (item.docHTML) {\n            tooltipNode.innerHTML = item.docHTML;\n        } else if (item.docText) {\n            tooltipNode.textContent = item.docText;\n        }\n\n        if (!tooltipNode.parentNode)\n            document.body.appendChild(tooltipNode);\n        var popup = this.popup;\n        var rect = popup.container.getBoundingClientRect();\n        tooltipNode.style.top = popup.container.style.top;\n        tooltipNode.style.bottom = popup.container.style.bottom;\n\n        tooltipNode.style.display = \"block\";\n        if (window.innerWidth - rect.right < 320) {\n            if (rect.left < 320) {\n                if(popup.isTopdown) {\n                    tooltipNode.style.top = rect.bottom + \"px\";\n                    tooltipNode.style.left = rect.left + \"px\";\n                    tooltipNode.style.right = \"\";\n                    tooltipNode.style.bottom = \"\";\n                } else {\n                    tooltipNode.style.top = popup.container.offsetTop - tooltipNode.offsetHeight + \"px\";\n                    tooltipNode.style.left = rect.left + \"px\";\n                    tooltipNode.style.right = \"\";\n                    tooltipNode.style.bottom = \"\";\n                }\n            } else {\n                tooltipNode.style.right = window.innerWidth - rect.left + \"px\";\n                tooltipNode.style.left = \"\";\n            }\n        } else {\n            tooltipNode.style.left = (rect.right + 1) + \"px\";\n            tooltipNode.style.right = \"\";\n        }\n    };\n\n    this.hideDocTooltip = function() {\n        this.tooltipTimer.cancel();\n        if (!this.tooltipNode) return;\n        var el = this.tooltipNode;\n        if (!this.editor.isFocused() && document.activeElement == el)\n            this.editor.focus();\n        this.tooltipNode = null;\n        if (el.parentNode)\n            el.parentNode.removeChild(el);\n    };\n    \n    this.onTooltipClick = function(e) {\n        var a = e.target;\n        while (a && a != this.tooltipNode) {\n            if (a.nodeName == \"A\" && a.href) {\n                a.rel = \"noreferrer\";\n                a.target = \"_blank\";\n                break;\n            }\n            a = a.parentNode;\n        }\n    };\n\n    this.destroy = function() {\n        this.detach();\n        if (this.popup) {\n            this.popup.destroy();\n            var el = this.popup.container;\n            if (el && el.parentNode)\n                el.parentNode.removeChild(el);\n        }\n        if (this.editor && this.editor.completer == this)\n            this.editor.completer == null;\n        this.popup = null;\n    };\n\n}).call(Autocomplete.prototype);\n\n\nAutocomplete.for = function(editor) {\n    if (editor.completer) {\n        return editor.completer;\n    }\n    if (config.get(\"sharedPopups\")) {\n        if (!Autocomplete.$shared)\n            Autocomplete.$sharedInstance = new Autocomplete();\n        editor.completer = Autocomplete.$sharedInstance;\n    } else {\n        editor.completer = new Autocomplete();\n        editor.once(\"destroy\", function(e, editor) {\n            editor.completer.destroy();\n        });\n    }\n    return editor.completer;\n};\n\nAutocomplete.startCommand = {\n    name: \"startAutocomplete\",\n    exec: function(editor, options) {\n        var completer = Autocomplete.for(editor);\n        completer.autoInsert = false;\n        completer.autoSelect = true;\n        completer.showPopup(editor, options);\n        completer.cancelContextMenu();\n    },\n    bindKey: \"Ctrl-Space|Ctrl-Shift-Space|Alt-Space\"\n};\n\nvar FilteredList = function(array, filterText) {\n    this.all = array;\n    this.filtered = array;\n    this.filterText = filterText || \"\";\n    this.exactMatch = false;\n};\n(function(){\n    this.setFilter = function(str) {\n        if (str.length > this.filterText && str.lastIndexOf(this.filterText, 0) === 0)\n            var matches = this.filtered;\n        else\n            var matches = this.all;\n\n        this.filterText = str;\n        matches = this.filterCompletions(matches, this.filterText);\n        matches = matches.sort(function(a, b) {\n            return b.exactMatch - a.exactMatch || b.$score - a.$score \n                || (a.caption || a.value).localeCompare(b.caption || b.value);\n        });\n        var prev = null;\n        matches = matches.filter(function(item){\n            var caption = item.snippet || item.caption || item.value;\n            if (caption === prev) return false;\n            prev = caption;\n            return true;\n        });\n\n        this.filtered = matches;\n    };\n    this.filterCompletions = function(items, needle) {\n        var results = [];\n        var upper = needle.toUpperCase();\n        var lower = needle.toLowerCase();\n        loop: for (var i = 0, item; item = items[i]; i++) {\n            var caption = item.caption || item.value || item.snippet;\n            if (!caption) continue;\n            var lastIndex = -1;\n            var matchMask = 0;\n            var penalty = 0;\n            var index, distance;\n\n            if (this.exactMatch) {\n                if (needle !== caption.substr(0, needle.length))\n                    continue loop;\n            } else {\n                var fullMatchIndex = caption.toLowerCase().indexOf(lower);\n                if (fullMatchIndex > -1) {\n                    penalty = fullMatchIndex;\n                } else {\n                    for (var j = 0; j < needle.length; j++) {\n                        var i1 = caption.indexOf(lower[j], lastIndex + 1);\n                        var i2 = caption.indexOf(upper[j], lastIndex + 1);\n                        index = (i1 >= 0) ? ((i2 < 0 || i1 < i2) ? i1 : i2) : i2;\n                        if (index < 0)\n                            continue loop;\n                        distance = index - lastIndex - 1;\n                        if (distance > 0) {\n                            if (lastIndex === -1)\n                                penalty += 10;\n                            penalty += distance;\n                            matchMask = matchMask | (1 << j);\n                        }\n                        lastIndex = index;\n                    }\n                }\n            }\n            item.matchMask = matchMask;\n            item.exactMatch = penalty ? 0 : 1;\n            item.$score = (item.score || 0) - penalty;\n            results.push(item);\n        }\n        return results;\n    };\n}).call(FilteredList.prototype);\n\nexports.Autocomplete = Autocomplete;\nexports.FilteredList = FilteredList;\n\n});\n\nace.define(\"ace/ext/menu_tools/overlay_page\",[\"require\",\"exports\",\"module\",\"ace/lib/dom\"], function(require, exports, module) {\n'use strict';\nvar dom = require(\"../../lib/dom\");\nvar cssText = \"#ace_settingsmenu, #kbshortcutmenu {\\\nbackground-color: #F7F7F7;\\\ncolor: black;\\\nbox-shadow: -5px 4px 5px rgba(126, 126, 126, 0.55);\\\npadding: 1em 0.5em 2em 1em;\\\noverflow: auto;\\\nposition: absolute;\\\nmargin: 0;\\\nbottom: 0;\\\nright: 0;\\\ntop: 0;\\\nz-index: 9991;\\\ncursor: default;\\\n}\\\n.ace_dark #ace_settingsmenu, .ace_dark #kbshortcutmenu {\\\nbox-shadow: -20px 10px 25px rgba(126, 126, 126, 0.25);\\\nbackground-color: rgba(255, 255, 255, 0.6);\\\ncolor: black;\\\n}\\\n.ace_optionsMenuEntry:hover {\\\nbackground-color: rgba(100, 100, 100, 0.1);\\\ntransition: all 0.3s\\\n}\\\n.ace_closeButton {\\\nbackground: rgba(245, 146, 146, 0.5);\\\nborder: 1px solid #F48A8A;\\\nborder-radius: 50%;\\\npadding: 7px;\\\nposition: absolute;\\\nright: -8px;\\\ntop: -8px;\\\nz-index: 100000;\\\n}\\\n.ace_closeButton{\\\nbackground: rgba(245, 146, 146, 0.9);\\\n}\\\n.ace_optionsMenuKey {\\\ncolor: darkslateblue;\\\nfont-weight: bold;\\\n}\\\n.ace_optionsMenuCommand {\\\ncolor: darkcyan;\\\nfont-weight: normal;\\\n}\\\n.ace_optionsMenuEntry input, .ace_optionsMenuEntry button {\\\nvertical-align: middle;\\\n}\\\n.ace_optionsMenuEntry button[ace_selected_button=true] {\\\nbackground: #e7e7e7;\\\nbox-shadow: 1px 0px 2px 0px #adadad inset;\\\nborder-color: #adadad;\\\n}\\\n.ace_optionsMenuEntry button {\\\nbackground: white;\\\nborder: 1px solid lightgray;\\\nmargin: 0px;\\\n}\\\n.ace_optionsMenuEntry button:hover{\\\nbackground: #f0f0f0;\\\n}\";\ndom.importCssString(cssText);\n\nmodule.exports.overlayPage = function overlayPage(editor, contentElement, callback) {\n    var closer = document.createElement('div');\n    var ignoreFocusOut = false;\n\n    function documentEscListener(e) {\n        if (e.keyCode === 27) {\n            close();\n        }\n    }\n\n    function close() {\n        if (!closer) return;\n        document.removeEventListener('keydown', documentEscListener);\n        closer.parentNode.removeChild(closer);\n        if (editor) {\n            editor.focus();\n        }\n        closer = null;\n        callback && callback();\n    }\n    function setIgnoreFocusOut(ignore) {\n        ignoreFocusOut = ignore;\n        if (ignore) {\n            closer.style.pointerEvents = \"none\";\n            contentElement.style.pointerEvents = \"auto\";\n        }\n    }\n\n    closer.style.cssText = 'margin: 0; padding: 0; ' +\n        'position: fixed; top:0; bottom:0; left:0; right:0;' +\n        'z-index: 9990; ' +\n        (editor ? 'background-color: rgba(0, 0, 0, 0.3);' : '');\n    closer.addEventListener('click', function(e) {\n        if (!ignoreFocusOut) {\n            close();\n        }\n    });\n    document.addEventListener('keydown', documentEscListener);\n\n    contentElement.addEventListener('click', function (e) {\n        e.stopPropagation();\n    });\n\n    closer.appendChild(contentElement);\n    document.body.appendChild(closer);\n    if (editor) {\n        editor.blur();\n    }\n    return {\n        close: close,\n        setIgnoreFocusOut: setIgnoreFocusOut\n    };\n};\n\n});\n\nace.define(\"ace/ext/modelist\",[\"require\",\"exports\",\"module\"], function(require, exports, module) {\n\"use strict\";\n\nvar modes = [];\nfunction getModeForPath(path) {\n    var mode = modesByName.text;\n    var fileName = path.split(/[\\/\\\\]/).pop();\n    for (var i = 0; i < modes.length; i++) {\n        if (modes[i].supportsFile(fileName)) {\n            mode = modes[i];\n            break;\n        }\n    }\n    return mode;\n}\n\nvar Mode = function(name, caption, extensions) {\n    this.name = name;\n    this.caption = caption;\n    this.mode = \"ace/mode/\" + name;\n    this.extensions = extensions;\n    var re;\n    if (/\\^/.test(extensions)) {\n        re = extensions.replace(/\\|(\\^)?/g, function(a, b){\n            return \"$|\" + (b ? \"^\" : \"^.*\\\\.\");\n        }) + \"$\";\n    } else {\n        re = \"^.*\\\\.(\" + extensions + \")$\";\n    }\n\n    this.extRe = new RegExp(re, \"gi\");\n};\n\nMode.prototype.supportsFile = function(filename) {\n    return filename.match(this.extRe);\n};\nvar supportedModes = {\n    ABAP:        [\"abap\"],\n    ABC:         [\"abc\"],\n    ActionScript:[\"as\"],\n    ADA:         [\"ada|adb\"],\n    Alda:        [\"alda\"],\n    Apache_Conf: [\"^htaccess|^htgroups|^htpasswd|^conf|htaccess|htgroups|htpasswd\"],\n    Apex:        [\"apex|cls|trigger|tgr\"],\n    AQL:         [\"aql\"],\n    AsciiDoc:    [\"asciidoc|adoc\"],\n    ASL:         [\"dsl|asl\"],\n    Assembly_x86:[\"asm|a\"],\n    AutoHotKey:  [\"ahk\"],\n    BatchFile:   [\"bat|cmd\"],\n    C_Cpp:       [\"cpp|c|cc|cxx|h|hh|hpp|ino\"],\n    C9Search:    [\"c9search_results\"],\n    Cirru:       [\"cirru|cr\"],\n    Clojure:     [\"clj|cljs\"],\n    Cobol:       [\"CBL|COB\"],\n    coffee:      [\"coffee|cf|cson|^Cakefile\"],\n    ColdFusion:  [\"cfm\"],\n    Crystal:     [\"cr\"],\n    CSharp:      [\"cs\"],\n    Csound_Document: [\"csd\"],\n    Csound_Orchestra: [\"orc\"],\n    Csound_Score: [\"sco\"],\n    CSS:         [\"css\"],\n    Curly:       [\"curly\"],\n    D:           [\"d|di\"],\n    Dart:        [\"dart\"],\n    Diff:        [\"diff|patch\"],\n    Dockerfile:  [\"^Dockerfile\"],\n    Dot:         [\"dot\"],\n    Drools:      [\"drl\"],\n    Edifact:     [\"edi\"],\n    Eiffel:      [\"e|ge\"],\n    EJS:         [\"ejs\"],\n    Elixir:      [\"ex|exs\"],\n    Elm:         [\"elm\"],\n    Erlang:      [\"erl|hrl\"],\n    Forth:       [\"frt|fs|ldr|fth|4th\"],\n    Fortran:     [\"f|f90\"],\n    FSharp:      [\"fsi|fs|ml|mli|fsx|fsscript\"],\n    FSL:         [\"fsl\"],\n    FTL:         [\"ftl\"],\n    Gcode:       [\"gcode\"],\n    Gherkin:     [\"feature\"],\n    Gitignore:   [\"^.gitignore\"],\n    Glsl:        [\"glsl|frag|vert\"],\n    Gobstones:   [\"gbs\"],\n    golang:      [\"go\"],\n    GraphQLSchema: [\"gql\"],\n    Groovy:      [\"groovy\"],\n    HAML:        [\"haml\"],\n    Handlebars:  [\"hbs|handlebars|tpl|mustache\"],\n    Haskell:     [\"hs\"],\n    Haskell_Cabal: [\"cabal\"],\n    haXe:        [\"hx\"],\n    Hjson:       [\"hjson\"],\n    HTML:        [\"html|htm|xhtml|vue|we|wpy\"],\n    HTML_Elixir: [\"eex|html.eex\"],\n    HTML_Ruby:   [\"erb|rhtml|html.erb\"],\n    INI:         [\"ini|conf|cfg|prefs\"],\n    Io:          [\"io\"],\n    Jack:        [\"jack\"],\n    Jade:        [\"jade|pug\"],\n    Java:        [\"java\"],\n    JavaScript:  [\"js|jsm|jsx\"],\n    JSON:        [\"json\"],\n    JSON5:       [\"json5\"],\n    JSONiq:      [\"jq\"],\n    JSP:         [\"jsp\"],\n    JSSM:        [\"jssm|jssm_state\"],\n    JSX:         [\"jsx\"],\n    Julia:       [\"jl\"],\n    Kotlin:      [\"kt|kts\"],\n    LaTeX:       [\"tex|latex|ltx|bib\"],\n    LESS:        [\"less\"],\n    Liquid:      [\"liquid\"],\n    Lisp:        [\"lisp\"],\n    LiveScript:  [\"ls\"],\n    LogiQL:      [\"logic|lql\"],\n    LSL:         [\"lsl\"],\n    Lua:         [\"lua\"],\n    LuaPage:     [\"lp\"],\n    Lucene:      [\"lucene\"],\n    Makefile:    [\"^Makefile|^GNUmakefile|^makefile|^OCamlMakefile|make\"],\n    Markdown:    [\"md|markdown\"],\n    Mask:        [\"mask\"],\n    MATLAB:      [\"matlab\"],\n    Maze:        [\"mz\"],\n    MediaWiki:   [\"wiki|mediawiki\"],\n    MEL:         [\"mel\"],\n    MIXAL:       [\"mixal\"],\n    MUSHCode:    [\"mc|mush\"],\n    MySQL:       [\"mysql\"],\n    Nginx:       [\"nginx|conf\"],\n    Nim:         [\"nim\"],\n    Nix:         [\"nix\"],\n    NSIS:        [\"nsi|nsh\"],\n    Nunjucks:    [\"nunjucks|nunjs|nj|njk\"],\n    ObjectiveC:  [\"m|mm\"],\n    OCaml:       [\"ml|mli\"],\n    Pascal:      [\"pas|p\"],\n    Perl:        [\"pl|pm\"],\n    Perl6:       [\"p6|pl6|pm6\"],\n    pgSQL:       [\"pgsql\"],\n    PHP:         [\"php|inc|phtml|shtml|php3|php4|php5|phps|phpt|aw|ctp|module\"],\n    PHP_Laravel_blade: [\"blade.php\"],\n    Pig:         [\"pig\"],\n    Powershell:  [\"ps1\"],\n    Praat:       [\"praat|praatscript|psc|proc\"],\n    Prisma:      [\"prisma\"],\n    Prolog:      [\"plg|prolog\"],\n    Properties:  [\"properties\"],\n    Protobuf:    [\"proto\"],\n    Puppet:      [\"epp|pp\"],\n    Python:      [\"py\"],\n    QML:         [\"qml\"],\n    R:           [\"r\"],\n    Razor:       [\"cshtml|asp\"],\n    RDoc:        [\"Rd\"],\n    Red:         [\"red|reds\"],\n    RHTML:       [\"Rhtml\"],\n    RST:         [\"rst\"],\n    Ruby:        [\"rb|ru|gemspec|rake|^Guardfile|^Rakefile|^Gemfile\"],\n    Rust:        [\"rs\"],\n    SASS:        [\"sass\"],\n    SCAD:        [\"scad\"],\n    Scala:       [\"scala|sbt\"],\n    Scheme:      [\"scm|sm|rkt|oak|scheme\"],\n    SCSS:        [\"scss\"],\n    SH:          [\"sh|bash|^.bashrc\"],\n    SJS:         [\"sjs\"],\n    Slim:        [\"slim|skim\"],\n    Smarty:      [\"smarty|tpl\"],\n    snippets:    [\"snippets\"],\n    Soy_Template:[\"soy\"],\n    Space:       [\"space\"],\n    SQL:         [\"sql\"],\n    SQLServer:   [\"sqlserver\"],\n    Stylus:      [\"styl|stylus\"],\n    SVG:         [\"svg\"],\n    Swift:       [\"swift\"],\n    Tcl:         [\"tcl\"],\n    Terraform:   [\"tf\", \"tfvars\", \"terragrunt\"],\n    Tex:         [\"tex\"],\n    Text:        [\"txt\"],\n    Textile:     [\"textile\"],\n    Toml:        [\"toml\"],\n    TSX:         [\"tsx\"],\n    Twig:        [\"latte|twig|swig\"],\n    Typescript:  [\"ts|typescript|str\"],\n    Vala:        [\"vala\"],\n    VBScript:    [\"vbs|vb\"],\n    Velocity:    [\"vm\"],\n    Verilog:     [\"v|vh|sv|svh\"],\n    VHDL:        [\"vhd|vhdl\"],\n    Visualforce: [\"vfp|component|page\"],\n    Wollok:      [\"wlk|wpgm|wtest\"],\n    XML:         [\"xml|rdf|rss|wsdl|xslt|atom|mathml|mml|xul|xbl|xaml\"],\n    XQuery:      [\"xq\"],\n    YAML:        [\"yaml|yml\"],\n    Zeek:        [\"zeek|bro\"],\n    Django:      [\"html\"]\n};\n\nvar nameOverrides = {\n    ObjectiveC: \"Objective-C\",\n    CSharp: \"C#\",\n    golang: \"Go\",\n    C_Cpp: \"C and C++\",\n    Csound_Document: \"Csound Document\",\n    Csound_Orchestra: \"Csound\",\n    Csound_Score: \"Csound Score\",\n    coffee: \"CoffeeScript\",\n    HTML_Ruby: \"HTML (Ruby)\",\n    HTML_Elixir: \"HTML (Elixir)\",\n    FTL: \"FreeMarker\",\n    PHP_Laravel_blade: \"PHP (Blade Template)\",\n    Perl6: \"Perl 6\",\n    AutoHotKey: \"AutoHotkey / AutoIt\"\n};\nvar modesByName = {};\nfor (var name in supportedModes) {\n    var data = supportedModes[name];\n    var displayName = (nameOverrides[name] || name).replace(/_/g, \" \");\n    var filename = name.toLowerCase();\n    var mode = new Mode(filename, displayName, data[0]);\n    modesByName[filename] = mode;\n    modes.push(mode);\n}\n\nmodule.exports = {\n    getModeForPath: getModeForPath,\n    modes: modes,\n    modesByName: modesByName\n};\n\n});\n\nace.define(\"ace/ext/prompt\",[\"require\",\"exports\",\"module\",\"ace/range\",\"ace/lib/dom\",\"ace/ext/menu_tools/get_editor_keyboard_shortcuts\",\"ace/autocomplete\",\"ace/autocomplete/popup\",\"ace/autocomplete/popup\",\"ace/undomanager\",\"ace/tokenizer\",\"ace/ext/menu_tools/overlay_page\",\"ace/ext/modelist\"], function(require, exports, module) {\n\"use strict\";\n\nvar Range = require(\"../range\").Range;\nvar dom = require(\"../lib/dom\");\nvar shortcuts = require(\"../ext/menu_tools/get_editor_keyboard_shortcuts\");\nvar FilteredList= require(\"../autocomplete\").FilteredList;\nvar AcePopup = require('../autocomplete/popup').AcePopup;\nvar $singleLineEditor = require('../autocomplete/popup').$singleLineEditor;\nvar UndoManager = require(\"../undomanager\").UndoManager;\nvar Tokenizer = require(\"../tokenizer\").Tokenizer;\nvar overlayPage = require(\"./menu_tools/overlay_page\").overlayPage;\nvar modelist = require(\"./modelist\");\nvar openPrompt;\n\nfunction prompt(editor, message, options, callback) {\n    if (typeof message == \"object\") {\n        return prompt(editor, \"\", message, options);\n    }\n    if (openPrompt) {\n        var lastPrompt = openPrompt;\n        editor = lastPrompt.editor;\n        lastPrompt.close();\n        if (lastPrompt.name && lastPrompt.name == options.name)\n            return;\n    }\n    if (options.$type)\n       return prompt[options.$type](editor, callback);\n\n    var cmdLine = $singleLineEditor();\n    cmdLine.session.setUndoManager(new UndoManager());\n\n    var el = dom.buildDom([\"div\", {class: \"ace_prompt_container\" + (options.hasDescription ? \" input-box-with-description\" : \"\")}]);\n    var overlay = overlayPage(editor, el, done);\n    el.appendChild(cmdLine.container);\n\n    if (editor) {\n        editor.cmdLine = cmdLine;\n        cmdLine.setOption(\"fontSize\", editor.getOption(\"fontSize\"));\n    }\n    if (message) {\n        cmdLine.setValue(message, 1);\n    }\n    if (options.selection) {\n        cmdLine.selection.setRange({\n            start: cmdLine.session.doc.indexToPosition(options.selection[0]),\n            end: cmdLine.session.doc.indexToPosition(options.selection[1])\n        });\n    }\n\n    if (options.getCompletions) {\n        var popup = new AcePopup();\n        popup.renderer.setStyle(\"ace_autocomplete_inline\");\n        popup.container.style.display = \"block\";\n        popup.container.style.maxWidth = \"600px\";\n        popup.container.style.width = \"100%\";\n        popup.container.style.marginTop = \"3px\";\n        popup.renderer.setScrollMargin(2, 2, 0, 0);\n        popup.autoSelect = false;\n        popup.renderer.$maxLines = 15;\n        popup.setRow(-1);\n        popup.on(\"click\", function(e) {\n            var data = popup.getData(popup.getRow());\n            if (!data.error) {\n                cmdLine.setValue(data.value || data.name || data);\n                accept();\n                e.stop();\n            }\n        });\n        el.appendChild(popup.container);\n        updateCompletions();\n    }\n\n    if (options.$rules) {\n        var tokenizer = new Tokenizer(options.$rules);\n        cmdLine.session.bgTokenizer.setTokenizer(tokenizer);\n    }\n\n    if (options.placeholder) {\n        cmdLine.setOption(\"placeholder\", options.placeholder);\n    }\n\n    if (options.hasDescription) {\n        var promptTextContainer = dom.buildDom([\"div\", {class: \"ace_prompt_text_container\"}]);\n        dom.buildDom(options.prompt || \"Press 'Enter' to confirm or 'Escape' to cancel\", promptTextContainer);\n        el.appendChild(promptTextContainer);\n    }\n\n    overlay.setIgnoreFocusOut(options.ignoreFocusOut);\n\n    function accept() {\n        var val;\n        if (popup && popup.getCursorPosition().row > 0) {\n            val = valueFromRecentList();\n        } else {\n            val = cmdLine.getValue();\n        }\n        var curData = popup ? popup.getData(popup.getRow()) : val;\n        if (curData && !curData.error) {\n            done();\n            options.onAccept && options.onAccept({\n                value: val,\n                item: curData\n            }, cmdLine);\n        }\n    }\n\n    var keys = {\n        \"Enter\": accept,\n        \"Esc|Shift-Esc\": function() {\n            options.onCancel && options.onCancel(cmdLine.getValue(), cmdLine);\n            done();\n        }\n    };\n\n    if (popup) {\n        Object.assign(keys, {\n            \"Up\": function(editor) { popup.goTo(\"up\"); valueFromRecentList();},\n            \"Down\": function(editor) { popup.goTo(\"down\"); valueFromRecentList();},\n            \"Ctrl-Up|Ctrl-Home\": function(editor) { popup.goTo(\"start\"); valueFromRecentList();},\n            \"Ctrl-Down|Ctrl-End\": function(editor) { popup.goTo(\"end\"); valueFromRecentList();},\n            \"Tab\": function(editor) {\n                popup.goTo(\"down\"); valueFromRecentList();\n            },\n            \"PageUp\": function(editor) { popup.gotoPageUp(); valueFromRecentList();},\n            \"PageDown\": function(editor) { popup.gotoPageDown(); valueFromRecentList();}\n        });\n    }\n\n    cmdLine.commands.bindKeys(keys);\n\n    function done() {\n        overlay.close();\n        callback && callback();\n        openPrompt = null;\n    }\n\n    cmdLine.on(\"input\", function() {\n        options.onInput && options.onInput();\n        updateCompletions();\n    });\n\n    function updateCompletions() {\n        if (options.getCompletions) {\n            var prefix;\n            if (options.getPrefix) {\n                prefix = options.getPrefix(cmdLine);\n            }\n\n            var completions = options.getCompletions(cmdLine);\n            popup.setData(completions, prefix);\n            popup.resize(true);\n        }\n    }\n\n    function valueFromRecentList() {\n        var current = popup.getData(popup.getRow());\n        if (current && !current.error)\n            return current.value || current.caption || current;\n    }\n\n    cmdLine.resize(true);\n    if (popup) {\n        popup.resize(true);\n    }\n    cmdLine.focus();\n\n    openPrompt = {\n        close: done,\n        name: options.name,\n        editor: editor\n    };\n}\n\nprompt.gotoLine = function(editor, callback) {\n    function stringifySelection(selection) {\n        if (!Array.isArray(selection))\n            selection = [selection];\n        return selection.map(function(r) {\n            var cursor = r.isBackwards ? r.start: r.end;\n            var anchor = r.isBackwards ? r.end: r.start;\n            var row = anchor.row;\n            var s = (row + 1) + \":\" + anchor.column;\n\n            if (anchor.row == cursor.row) {\n                if (anchor.column != cursor.column)\n                    s += \">\" + \":\" + cursor.column;\n            } else {\n                s += \">\" + (cursor.row + 1) + \":\" + cursor.column;\n            }\n            return s;\n        }).reverse().join(\", \");\n    }\n\n    prompt(editor, \":\" + stringifySelection(editor.selection.toJSON()), {\n        name: \"gotoLine\",\n        selection: [1, Number.MAX_VALUE],\n        onAccept: function(data) {\n            var value = data.value;\n            var _history = prompt.gotoLine._history;\n            if (!_history)\n                prompt.gotoLine._history = _history = [];\n            if (_history.indexOf(value) != -1)\n                _history.splice(_history.indexOf(value), 1);\n            _history.unshift(value);\n            if (_history.length > 20) _history.length = 20;\n            \n            \n            var pos = editor.getCursorPosition();\n            var ranges = [];\n            value.replace(/^:/, \"\").split(/,/).map(function(str) {\n                var parts = str.split(/([<>:+-]|c?\\d+)|[^c\\d<>:+-]+/).filter(Boolean);\n                var i = 0;\n                function readPosition() {\n                    var c = parts[i++];\n                    if (!c) return;\n                    if (c[0] == \"c\") {\n                        var index = parseInt(c.slice(1)) || 0;\n                        return editor.session.doc.indexToPosition(index);\n                    }\n                    var row = pos.row;\n                    var column = 0;\n                    if (/\\d/.test(c)) {\n                        row = parseInt(c) - 1;\n                        c = parts[i++];\n                    }\n                    if (c == \":\") {\n                        c = parts[i++];\n                        if (/\\d/.test(c)) {\n                            column = parseInt(c) || 0;\n                        }\n                    }\n                    return {row: row, column: column};\n                }\n                pos = readPosition();\n                var range = Range.fromPoints(pos, pos);\n                if (parts[i] == \">\") {\n                    i++;\n                    range.end = readPosition();\n                }\n                else if (parts[i] == \"<\") {\n                    i++;\n                    range.start = readPosition();\n                }\n                ranges.unshift(range);\n            });\n            editor.selection.fromJSON(ranges);\n            var scrollTop = editor.renderer.scrollTop;\n            editor.renderer.scrollSelectionIntoView(\n                editor.selection.anchor, \n                editor.selection.cursor, \n                0.5\n            );\n            editor.renderer.animateScrolling(scrollTop);\n        },\n        history: function() {\n            var undoManager = editor.session.getUndoManager();\n            if (!prompt.gotoLine._history)\n                return [];\n            return prompt.gotoLine._history;\n\n        },\n        getCompletions: function(cmdLine) {\n            var value = cmdLine.getValue();\n            var m = value.replace(/^:/, \"\").split(\":\");\n            var row = Math.min(parseInt(m[0]) || 1, editor.session.getLength()) - 1;\n            var line = editor.session.getLine(row);\n            var current = value + \"  \" + line;\n            return [current].concat(this.history());\n        },\n        $rules: {\n            start: [{\n                regex: /\\d+/,\n                token: \"string\"\n            }, {\n                regex: /[:,><+\\-c]/,\n                token: \"keyword\"\n            }]\n        }\n    });\n};\n\nprompt.commands = function(editor, callback) {\n    function normalizeName(name) {\n        return (name || \"\").replace(/^./, function(x) {\n            return x.toUpperCase(x);\n        }).replace(/[a-z][A-Z]/g, function(x) {\n            return x[0] + \" \" + x[1].toLowerCase(x);\n        });\n    }\n    function getEditorCommandsByName(excludeCommands) {\n        var commandsByName = [];\n        var commandMap = {};\n        editor.keyBinding.$handlers.forEach(function(handler) {\n            var platform = handler.platform;\n            var cbn = handler.byName;\n            for (var i in cbn) {\n                var key;\n                if (cbn[i].bindKey && cbn[i].bindKey[platform] !== null) {\n                    key = cbn[i].bindKey[\"win\"];\n                } else {\n                    key = \"\";\n                }\n\n                var commands = cbn[i];\n                var description = commands.description || normalizeName(commands.name);\n                if (!Array.isArray(commands))\n                    commands = [commands];\n                commands.forEach(function(command) {\n                    if (typeof command != \"string\")\n                        command = command.name;\n                    var needle = excludeCommands.find(function(el) {\n                        return el === command;\n                    });\n                    if (!needle) {\n                        if (commandMap[command]) {\n                            commandMap[command].key += \"|\" + key;\n                        } else {\n                            commandMap[command] = {key: key, command: command, description: description};\n                            commandsByName.push(commandMap[command]);\n                        }\n                    }\n                });\n            }\n        });\n        return commandsByName;\n    }\n    var excludeCommandsList = [\"insertstring\", \"inserttext\", \"setIndentation\", \"paste\"];\n    var shortcutsArray = getEditorCommandsByName(excludeCommandsList);\n    shortcutsArray = shortcutsArray.map(function(item) {\n        return {value: item.description, meta: item.key, command: item.command};\n    });\n    prompt(editor, \"\",  {\n        name: \"commands\",\n        selection: [0, Number.MAX_VALUE],\n        maxHistoryCount: 5,\n        onAccept: function(data) {\n            if (data.item) {\n                var commandName = data.item.command;\n                this.addToHistory(data.item);\n\n                editor.execCommand(commandName);\n            }\n        },\n        addToHistory: function(item) {\n            var history = this.history();\n            history.unshift(item);\n            delete item.message;\n            for (var i = 1; i < history.length; i++) {\n                if (history[i][\"command\"] == item.command ) {\n                    history.splice(i, 1);\n                    break;\n                }\n            }\n            if (this.maxHistoryCount > 0 && history.length > this.maxHistoryCount) {\n                history.splice(history.length - 1, 1);\n            }\n            prompt.commands.history = history;\n        },\n        history: function() {\n            return prompt.commands.history || [];\n        },\n        getPrefix: function(cmdLine) {\n            var currentPos = cmdLine.getCursorPosition();\n            var filterValue = cmdLine.getValue();\n            return filterValue.substring(0, currentPos.column);\n        },\n        getCompletions: function(cmdLine) {\n            function getFilteredCompletions(commands, prefix) {\n                var resultCommands = JSON.parse(JSON.stringify(commands));\n\n                var filtered = new FilteredList(resultCommands);\n                return filtered.filterCompletions(resultCommands, prefix);\n            }\n\n            function getUniqueCommandList(commands, usedCommands) {\n                if (!usedCommands || !usedCommands.length) {\n                    return commands;\n                }\n                var excludeCommands = [];\n                usedCommands.forEach(function(item) {\n                    excludeCommands.push(item.command);\n                });\n\n                var resultCommands = [];\n\n                commands.forEach(function(item) {\n                    if (excludeCommands.indexOf(item.command) === -1) {\n                        resultCommands.push(item);\n                    }\n                });\n\n                return resultCommands;\n            }\n\n            var prefix = this.getPrefix(cmdLine);\n            var recentlyUsedCommands = getFilteredCompletions(this.history(), prefix);\n            var otherCommands = getUniqueCommandList(shortcutsArray, recentlyUsedCommands);\n            otherCommands = getFilteredCompletions(otherCommands, prefix);\n\n            if (recentlyUsedCommands.length && otherCommands.length) {\n                recentlyUsedCommands[0][\"message\"] = \" Recently used\";\n                otherCommands[0][\"message\"] = \" Other commands\";\n            }\n\n            var completions = recentlyUsedCommands.concat(otherCommands);\n            return completions.length > 0 ? completions : [{\n                value: \"No matching commands\",\n                error: 1\n            }];\n        }\n    });\n};\n\nprompt.modes = function(editor, callback) {\n    var modesArray = modelist.modes;\n    modesArray = modesArray.map(function(item) {\n        return {value: item.caption, mode: item.name};\n    });\n    prompt(editor, \"\",  {\n        name: \"modes\",\n        selection: [0, Number.MAX_VALUE],\n        onAccept: function(data) {\n            if (data.item) {\n                var modeName = \"ace/mode/\" + data.item.mode;\n                editor.session.setMode(modeName);\n            }\n        },\n        getPrefix: function(cmdLine) {\n            var currentPos = cmdLine.getCursorPosition();\n            var filterValue = cmdLine.getValue();\n            return filterValue.substring(0, currentPos.column);\n        },\n        getCompletions: function(cmdLine) {\n            function getFilteredCompletions(modes, prefix) {\n                var resultCommands = JSON.parse(JSON.stringify(modes));\n\n                var filtered = new FilteredList(resultCommands);\n                return filtered.filterCompletions(resultCommands, prefix);\n            }\n\n            var prefix = this.getPrefix(cmdLine);\n            var completions = getFilteredCompletions(modesArray, prefix);\n            return completions.length > 0 ? completions : [{\n                \"caption\": \"No mode matching\",\n                \"value\": \"No mode matching\",\n                \"error\": 1\n            }];\n        }\n    });\n};\n\ndom.importCssString(\".ace_prompt_container {\\\n    max-width: 600px;\\\n    width: 100%;\\\n    margin: 20px auto;\\\n    padding: 3px;\\\n    background: white;\\\n    border-radius: 2px;\\\n    box-shadow: 0px 2px 3px 0px #555;\\\n}\");\n\n\nexports.prompt = prompt;\n\n});                (function() {\n                    ace.require([\"ace/ext/prompt\"], function(m) {\n                        if (typeof module == \"object\" && typeof exports == \"object\" && module) {\n                            module.exports = m;\n                        }\n                    });\n                })();\n            "]},"metadata":{},"sourceType":"script"}